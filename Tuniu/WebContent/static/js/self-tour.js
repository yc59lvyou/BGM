!function(e){function t(i){if(n[i])return n[i].exports;var a=n[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e['default']}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=467)}([,function(e,t,n){"use strict";function i(e){for(var t=Object.keys(e),n={},i=0;i<t.length;i++){var a=t[i];"function"==typeof e[a]&&(n[a]=e[a])}var o=Object.keys(n);return function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],i=!1,a=Object.assign({},e),r=0;r<o.length;r++){var s=o[r],c=n[s],l=e[s],d=c(l,t);a[s]=d,i=i||d!==l}return i?a:e}}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=!1,r={},s={},c=!1,l=function(){return r},d={getState:function(e){return e?r[e]:r},subscribe:function(e,t){if(t&&!t.startsWith("change:")&&(t="change:"+t),"function"!=typeof e)throw new Error("Expected listener to be a function.");s[t=t||"all"]=s[t]||[],~s[t].indexOf(e)||s[t].push(e)},unsubscribe:function(e,t){var n;if("function"!=typeof e)throw new Error("Expected listener to be a function.");s[t=t||"all"]&&(n=s[t].indexOf(e))&&s[t].splice(n,1)},dispatch:function(e){var t,n;if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(c)throw new Error("Reducers may not dispatch actions.");try{c=!0,t=l(r,e)}finally{c=!1}if(t&&t!==r){var i=!1,a={};if(n=r,r=t,Object.keys(r).forEach(function(e){if(n[e]!==r[e]){var t=s["change:"+e];a[e]=r[e],i=i||!0,t&&t.forEach(function(e){e()})}}),i){var o=s.all;o&&o.forEach(function(t){t({type:e.type,data:a})})}}return e},addRedecuer:function(e){switch(void 0===e?"undefined":a(e)){case"function":l=e;break;case"object":l=i(e);break;default:throw new Error("Expected reducer to be a function.")}}};t.createStore=function(e,t){return o||(o=!0,d.addRedecuer(e)),t&&(r=Object.assign({},t)),d},t.getStore=function(){if(o)return d;throw new Error("store hasn't been created!")},t.combineReducer=i},,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.layer=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n(109);var a,o,r={getPath:function(){var e=document.scripts,t=e[e.length-1],n=t.src;if(!t.getAttribute("merge"))return n.substring(0,n.lastIndexOf("/")+1)}(),enter:function(e){13===e.keyCode&&e.preventDefault()},config:{},end:{},btn:["&#x786E;&#x5B9A;","&#x53D6;&#x6D88;"],type:["dialog","page","iframe","loading","tips"]},s={v:"2.4",ie6:!!window.ActiveXObject&&!window.XMLHttpRequest,index:0,path:r.getPath,config:function(e,t){var n=0;return e=e||{},s.cache=r.config=a.extend(r.config,e),s.path=r.config.path||s.path,"string"==typeof e.extend&&(e.extend=[e.extend]),s.use("skin/layer.css",e.extend&&e.extend.length>0?function i(){var a=e.extend;s.use(a[a[n]?n:n-1],n<a.length?(++n,i):t)}():t),this},use:function(e,t,n){var i=a("head")[0],e=e.replace(/\s/g,""),o=/\.css$/.test(e),r=document.createElement(o?"link":"script"),c="layui_layer_"+e.replace(/\.|\//g,"");if(s.path)return o&&(r.rel="stylesheet"),r[o?"href":"src"]=/^http:\/\//.test(e)?e:s.path+e,r.id=c,a("#"+c)[0]||i.appendChild(r),function e(){(o?1989===parseInt(a("#"+c).css("width")):s[n||c])?function(){t&&t();try{o||i.removeChild(r)}catch(e){}}():setTimeout(e,100)}(),this},ready:function(e,t){var n="function"==typeof e;return n&&(t=e),s.config(a.extend(r.config,n?{}:{path:e}),t),this},alert:function(e,t,n){var i="function"==typeof t;return i&&(n=t),s.open(a.extend({content:e,yes:n},i?{}:t))},confirm:function(e,t,n,i){var o="function"==typeof t;return o&&(i=n,n=t),s.open(a.extend({content:e,btn:r.btn,yes:n,btn2:i},o?{}:t))},msg:function(e,t,n){var i="function"==typeof t,o=r.config.skin,c=(o?o+" "+o+"-msg":"")||"layui-layer-msg",d=l.anim.length-1;return i&&(n=t),s.open(a.extend({content:e,time:3e3,shade:!1,skin:c,title:!1,closeBtn:!1,btn:!1,end:n},i&&!r.config.skin?{skin:c+" layui-layer-hui",shift:d}:((-1===(t=t||{}).icon||void 0===t.icon&&!r.config.skin)&&(t.skin=c+" "+(t.skin||"layui-layer-hui")),t)))},load:function(e,t){return s.open(a.extend({type:3,icon:e||0,shade:.01},t))},tips:function(e,t,n){return s.open(a.extend({type:4,content:[e,t],closeBtn:!1,time:3e3,shade:!1,fix:!1,maxWidth:210},n))}},c=function(e){this.index=++s.index,this.config=a.extend({},this.config,r.config,e),this.creat()};c.pt=c.prototype;var l=["layui-layer",".layui-layer-title",".layui-layer-main",".layui-layer-dialog","layui-layer-iframe","layui-layer-content","layui-layer-btn","layui-layer-close"];l.anim=["layer-anim","layer-anim-01","layer-anim-02","layer-anim-03","layer-anim-04","layer-anim-05","layer-anim-06"],c.pt.config={type:0,shade:.3,fix:!0,move:l[1],title:"&#x4FE1;&#x606F;",offset:"auto",area:"auto",closeBtn:1,time:0,zIndex:19891014,maxWidth:360,shift:0,icon:-1,scrollbar:!0,tips:2},c.pt.vessel=function(e,t){var n=this.index,a=this.config,o=a.zIndex+n,s="object"===i(a.title),c=a.maxmin&&(1===a.type||2===a.type),d=a.title?'<div class="layui-layer-title" style="'+(s?a.title[1]:"")+'">'+(s?a.title[0]:a.title)+"</div>":"";return a.zIndex=o,t([a.shade?'<div class="layui-layer-shade" id="layui-layer-shade'+n+'" times="'+n+'" style="z-index:'+(o-1)+"; background-color:"+(a.shade[1]||"#000")+"; opacity:"+(a.shade[0]||a.shade)+"; filter:alpha(opacity="+(100*a.shade[0]||100*a.shade)+');"></div>':"",'<div class="'+l[0]+" layui-layer-"+r.type[a.type]+(0!=a.type&&2!=a.type||a.shade?"":" layui-layer-border")+" "+(a.skin||"")+'" id="'+l[0]+n+'" type="'+r.type[a.type]+'" times="'+n+'" showtime="'+a.time+'" conType="'+(e?"object":"string")+'" style="z-index: '+o+"; width:"+a.area[0]+";height:"+a.area[1]+(a.fix?"":";position:absolute;")+'">'+(e&&2!=a.type?"":d)+'<div id="'+(a.id||"")+'" class="layui-layer-content'+(0==a.type&&-1!==a.icon?" layui-layer-padding":"")+(3==a.type?" layui-layer-loading"+a.icon:"")+'">'+(0==a.type&&-1!==a.icon?'<i class="layui-layer-ico layui-layer-ico'+a.icon+'"></i>':"")+(2==a.type||4==a.type||1==a.type&&e?"":a.content||"")+'</div><span class="layui-layer-setwin">'+function(){var e=c?'<a class="layui-layer-min" href="javascript:;"><cite></cite></a><a class="layui-layer-ico layui-layer-max" href="javascript:;"></a>':"";return a.closeBtn&&(e+='<a class="layui-layer-ico '+l[7]+" "+l[7]+(a.title?a.closeBtn:4==a.type?"1":"2")+'" href="javascript:;"></a>'),e}()+"</span>"+(a.btn?function(){var e="";"string"==typeof a.btn&&(a.btn=[a.btn]);for(var t=0,n=a.btn.length;t<n;t++)e+='<a class="'+l[6]+t+'">'+a.btn[t]+"</a>";return'<div class="'+l[6]+'">'+e+"</div>"}():"")+"</div>"],d),this},c.pt.creat=function(){var e=this,t=e.config,n=e.index,c="object"===(void 0===(d=t.content)?"undefined":i(d));if(!a("#"+t.id)[0]){switch("string"==typeof t.area&&(t.area="auto"===t.area?["",""]:[t.area,""]),t.type){case 0:t.btn="btn"in t?t.btn:r.btn[0],s.closeAll("dialog");break;case 2:var d=t.content=c?t.content:[t.content||"http://layer.layui.com","auto"];t.content='<iframe scrolling="'+(t.content[1]||"auto")+'" allowtransparency="true" id="'+l[4]+n+'" name="'+l[4]+n+'" onload="this.className=\'\';" class="layui-layer-load" frameborder="0" src="'+t.content[0]+'"></iframe>';break;case 3:t.title=!1,t.closeBtn=!1,-1===t.icon&&t.icon,s.closeAll("loading");break;case 4:c||(t.content=[t.content,"body"]),t.follow=t.content[1],t.content=a("<div />").append(t.content[0],'<i class="layui-layer-TipsG"></i>')[0],t.title=!1,t.tips="object"===i(t.tips)?t.tips:[t.tips,!0],t.tipsMore||s.closeAll("tips")}e.vessel(c,function(i,o){a("body").append(i[0]),c?2==t.type||4==t.type?function(){var e=a(i[1]);e.find(".layui-layer-content").append(t.content),a("body").append(e)}():d.parents("."+l[0])[0]||(d.show().addClass("layui-layer-wrap").wrap(i[1]),a("#"+l[0]+n).find("."+l[5]).before(o)):a("body").append(i[1]),e.layero=a("#"+l[0]+n),t.scrollbar||l.html.css("overflow","hidden").attr("layer-full",n)}).auto(n),2==t.type&&s.ie6&&e.layero.find("iframe").attr("src",d[0]),a(document).off("keydown",r.enter).on("keydown",r.enter),e.layero.on("keydown",function(e){a(document).off("keydown",r.enter)}),4==t.type?e.tips():e.offset(),t.fix&&o.on("resize",function(){e.offset(),(/^\d+%$/.test(t.area[0])||/^\d+%$/.test(t.area[1]))&&e.auto(n),4==t.type&&e.tips()}),t.time<=0||setTimeout(function(){s.close(e.index)},t.time),e.move().callback(),l.anim[t.shift]&&e.layero.addClass(l.anim[t.shift])}},c.pt.auto=function(e){function t(e){(e=i.find(e)).height(r[1]-s-c-2*(0|parseFloat(e.css("padding"))))}var n=this.config,i=a("#"+l[0]+e);""===n.area[0]&&n.maxWidth>0&&(/MSIE 7/.test(navigator.userAgent)&&n.btn&&i.width(i.innerWidth()),i.outerWidth()>n.maxWidth&&i.width(n.maxWidth));var r=[i.innerWidth(),i.innerHeight()],s=i.find(l[1]).outerHeight()||0,c=i.find("."+l[6]).outerHeight()||0;switch(n.type){case 2:t("iframe");break;default:""===n.area[1]?n.fix&&r[1]>=o.height()&&(r[1]=o.height(),t("."+l[5])):t("."+l[5])}return this},c.pt.offset=function(){var e=this,t=e.config,n=e.layero,a=[n.outerWidth(),n.outerHeight()],r="object"===i(t.offset);e.offsetTop=(o.height()-a[1])/2,e.offsetLeft=(o.width()-a[0])/2,r?(e.offsetTop=t.offset[0],e.offsetLeft=t.offset[1]||e.offsetLeft):"auto"!==t.offset&&(e.offsetTop=t.offset,"rb"===t.offset&&(e.offsetTop=o.height()-a[1],e.offsetLeft=o.width()-a[0])),t.fix||(e.offsetTop=/%$/.test(e.offsetTop)?o.height()*parseFloat(e.offsetTop)/100:parseFloat(e.offsetTop),e.offsetLeft=/%$/.test(e.offsetLeft)?o.width()*parseFloat(e.offsetLeft)/100:parseFloat(e.offsetLeft),e.offsetTop+=o.scrollTop(),e.offsetLeft+=o.scrollLeft()),n.css({top:e.offsetTop,left:e.offsetLeft})},c.pt.tips=function(){var e=this.config,t=this.layero,n=[t.outerWidth(),t.outerHeight()],i=a(e.follow);i[0]||(i=a("body"));var r={width:i.outerWidth(),height:i.outerHeight(),top:i.offset().top,left:i.offset().left},s=t.find(".layui-layer-TipsG"),c=e.tips[0];e.tips[1]||s.remove();var d=e.tipsOffset,u=e.arrowOffset||[0,0],f=10,h=10;d&&("number"==typeof d?f=d:d&&d.length&&(f=void 0===d[0]?f:d[0],h=void 0===d[1]?h:d[1])),r.autoLeft=function(){!0!==e.disableAutoLeft&&r.left+n[0]-o.width()>0?(r.tipLeft=r.left+r.width-n[0],s.css({right:12,left:"auto"})):r.tipLeft=r.left+h},r.where=[function(){r.autoLeft(),r.tipTop=r.top-n[1]-f,s.removeClass("layui-layer-TipsB").addClass("layui-layer-TipsT").css("border-right-color",e.tips[1])},function(){r.tipLeft=r.left+r.width+h,r.tipTop=r.top,s.removeClass("layui-layer-TipsL").addClass("layui-layer-TipsR").css("border-bottom-color",e.tips[1])},function(){r.autoLeft(),r.tipTop=r.top+r.height+f,s.removeClass("layui-layer-TipsT").addClass("layui-layer-TipsB").css({"border-right-color":e.tips[1],left:r.left+r.width/2-r.tipLeft+u[0]})},function(){r.tipLeft=r.left-n[0]-h,r.tipTop=r.top,s.removeClass("layui-layer-TipsR").addClass("layui-layer-TipsL").css("border-bottom-color",e.tips[1])}],r.where[c-1](),t.find("."+l[5]).css({"background-color":e.tips[1],"padding-right":e.closeBtn?"30px":""}),t.css({left:r.tipLeft-(e.fix?o.scrollLeft():0),top:r.tipTop-(e.fix?o.scrollTop():0)})},c.pt.move=function(){var e=this.config,t={setY:0,moveLayer:function(){var e=t.layero,n=parseInt(e.css("margin-left")),i=parseInt(t.move.css("left"));0===n||(i-=n),"fixed"!==e.css("position")&&(i-=e.parent().offset().left,t.setY=0),e.css({left:i,top:parseInt(t.move.css("top"))-t.setY})}},n=this.layero.find(e.move);return e.move&&n.attr("move","ok"),n.css({cursor:e.move?"move":"auto"}),a(e.move).on("mousedown",function(n){if(n.preventDefault(),"ok"===a(this).attr("move")){t.ismove=!0,t.layero=a(this).parents("."+l[0]);var i=t.layero.offset().left,r=t.layero.offset().top,s=t.layero.outerWidth()-6,c=t.layero.outerHeight()-6;a("#layui-layer-moves")[0]||a("body").append('<div id="layui-layer-moves" class="layui-layer-moves" style="left:'+i+"px; top:"+r+"px; width:"+s+"px; height:"+c+'px; z-index:2147483584"></div>'),t.move=a("#layui-layer-moves"),e.moveType&&t.move.css({visibility:"hidden"}),t.moveX=n.pageX-t.move.position().left,t.moveY=n.pageY-t.move.position().top,"fixed"!==t.layero.css("position")||(t.setY=o.scrollTop())}}),a(document).mousemove(function(n){if(t.ismove){var i=n.pageX-t.moveX,a=n.pageY-t.moveY;if(n.preventDefault(),!e.moveOut){t.setY=o.scrollTop();var r=o.width()-t.move.outerWidth(),s=t.setY;i<0&&(i=0),i>r&&(i=r),a<s&&(a=s),a>o.height()-t.move.outerHeight()+t.setY&&(a=o.height()-t.move.outerHeight()+t.setY)}t.move.css({left:i,top:a}),e.moveType&&t.moveLayer(),i=a=r=s=null}}).mouseup(function(){try{t.ismove&&(t.moveLayer(),t.move.remove(),e.moveEnd&&e.moveEnd()),t.ismove=!1}catch(e){t.ismove=!1}}),this},c.pt.callback=function(){var e=this,t=e.layero,n=e.config;e.openLayer(),n.success&&(2==n.type?t.find("iframe").on("load",function(){n.success(t,e.index)}):n.success(t,e.index)),s.ie6&&e.IE6(t),t.find("."+l[6]).children("a").on("click",function(){var i=a(this).index();if(0===i)n.yes?n.yes(e.index,t):n.btn1?n.btn1(e.index,t):s.close(e.index);else{!1===(n["btn"+(i+1)]&&n["btn"+(i+1)](e.index,t))||s.close(e.index)}}),t.find("."+l[7]).on("click",function(){!1===(n.cancel&&n.cancel(e.index,t))||s.close(e.index)}),n.shadeClose&&a("#layui-layer-shade"+e.index).on("click",function(){s.close(e.index)}),t.find(".layui-layer-min").on("click",function(){!1===(n.min&&n.min(t))||s.min(e.index,n)}),t.find(".layui-layer-max").on("click",function(){a(this).hasClass("layui-layer-maxmin")?(s.restore(e.index),n.restore&&n.restore(t)):(s.full(e.index,n),setTimeout(function(){n.full&&n.full(t)},100))}),n.end&&(r.end[e.index]=n.end)},r.reselect=function(){a.each(a("select"),function(e,t){var n=a(this);n.parents("."+l[0])[0]||1==n.attr("layer")&&a("."+l[0]).length<1&&n.removeAttr("layer").show(),n=null})},c.pt.IE6=function(e){function t(){e.css({top:i+(n.config.fix?o.scrollTop():0)})}var n=this,i=e.offset().top;t(),o.scroll(t),a("select").each(function(e,t){var n=a(this);n.parents("."+l[0])[0]||"none"===n.css("display")||n.attr({layer:"1"}).hide(),n=null})},c.pt.openLayer=function(){s.zIndex=this.config.zIndex,s.setTop=function(e){return s.zIndex=parseInt(e[0].style.zIndex),e.on("mousedown",function(){s.zIndex++,e.css("z-index",s.zIndex+1)}),s.zIndex}},r.record=function(e){var t=[e.width(),e.height(),e.position().top,e.position().left+parseFloat(e.css("margin-left"))];e.find(".layui-layer-max").addClass("layui-layer-maxmin"),e.attr({area:t})},r.rescollbar=function(e){l.html.attr("layer-full")==e&&(l.html[0].style.removeProperty?l.html[0].style.removeProperty("overflow"):l.html[0].style.removeAttribute("overflow"),l.html.removeAttr("layer-full"))},window.layer=s,s.getChildFrame=function(e,t){return t=t||a("."+l[4]).attr("times"),a("#"+l[0]+t).find("iframe").contents().find(e)},s.getFrameIndex=function(e){return a("#"+e).parents("."+l[4]).attr("times")},s.iframeAuto=function(e){if(e){var t=s.getChildFrame("html",e).outerHeight(),n=a("#"+l[0]+e),i=n.find(l[1]).outerHeight()||0,o=n.find("."+l[6]).outerHeight()||0;n.css({height:t+i+o}),n.find("iframe").css({height:t})}},s.iframeSrc=function(e,t){a("#"+l[0]+e).find("iframe").attr("src",t)},s.style=function(e,t){var n=a("#"+l[0]+e),i=n.attr("type"),o=n.find(l[1]).outerHeight()||0,s=n.find("."+l[6]).outerHeight()||0;i!==r.type[1]&&i!==r.type[2]||(n.css(t),i===r.type[2]&&n.find("iframe").css({height:parseFloat(t.height)-o-s}))},s.min=function(e,t){var n=a("#"+l[0]+e),i=n.find(l[1]).outerHeight()||0;r.record(n),s.style(e,{width:180,height:i,overflow:"hidden"}),n.find(".layui-layer-min").hide(),"page"===n.attr("type")&&n.find(l[4]).hide(),r.rescollbar(e)},s.restore=function(e){var t=a("#"+l[0]+e),n=t.attr("area").split(",");t.attr("type");s.style(e,{width:parseFloat(n[0]),height:parseFloat(n[1]),top:parseFloat(n[2]),left:parseFloat(n[3]),overflow:"visible"}),t.find(".layui-layer-max").removeClass("layui-layer-maxmin"),t.find(".layui-layer-min").show(),"page"===t.attr("type")&&t.find(l[4]).show(),r.rescollbar(e)},s.full=function(e){var t,n=a("#"+l[0]+e);r.record(n),l.html.attr("layer-full")||l.html.css("overflow","hidden").attr("layer-full",e),clearTimeout(t),t=setTimeout(function(){var t="fixed"===n.css("position");s.style(e,{top:t?0:o.scrollTop(),left:t?0:o.scrollLeft(),width:o.width(),height:o.height()}),n.find(".layui-layer-min").hide()},100)},s.title=function(e,t){a("#"+l[0]+(t||s.index)).find(l[1]).html(e)},s.close=function(e){var t=a("#"+l[0]+e),n=t.attr("type");if(t[0]){if(n===r.type[1]&&"object"===t.attr("conType")){t.children(":not(."+l[5]+")").remove();for(var i=0;i<2;i++)t.find(".layui-layer-wrap").unwrap().hide()}else{if(n===r.type[2])try{var o=a("#"+l[4]+e)[0];o.contentWindow.document.write(""),o.contentWindow.close(),t.find("."+l[5])[0].removeChild(o)}catch(e){}t[0].innerHTML="",t.remove()}a("#layui-layer-moves, #layui-layer-shade"+e).remove(),s.ie6&&r.reselect(),r.rescollbar(e),a(document).off("keydown",r.enter),"function"==typeof r.end[e]&&r.end[e](),delete r.end[e]}},s.closeAll=function(e){a.each(a("."+l[0]),function(){var t=a(this),n=e?t.attr("type")===e:1;n&&s.close(t.attr("times")),n=null})};var d=s.cache||{},u=function(e){return d.skin?" "+d.skin+" "+d.skin+"-"+e:""};s.prompt=function(e,t){"function"==typeof(e=e||{})&&(t=e);var n,i=2==e.formType?'<textarea class="layui-layer-input">'+(e.value||"")+"</textarea>":'<input type="'+(1==e.formType?"password":"text")+'" class="layui-layer-input" value="'+(e.value||"")+'">';return s.open(a.extend({btn:["&#x786E;&#x5B9A;","&#x53D6;&#x6D88;"],content:i,skin:"layui-layer-prompt"+u("prompt"),success:function(e){(n=e.find(".layui-layer-input")).focus()},yes:function(i){var a=n.val();""===a?n.focus():a.length>(e.maxlength||500)?s.tips("&#x6700;&#x591A;&#x8F93;&#x5165;"+(e.maxlength||500)+"&#x4E2A;&#x5B57;&#x6570;",n,{tips:1}):t&&t(a,i,n)}},e))},s.tab=function(e){var t=(e=e||{}).tab||{};return s.open(a.extend({type:1,skin:"layui-layer-tab"+u("tab"),title:function(){var e=t.length,n=1,i="";if(e>0)for(i='<span class="layui-layer-tabnow">'+t[0].title+"</span>";n<e;n++)i+="<span>"+t[n].title+"</span>";return i}(),content:'<ul class="layui-layer-tabmain">'+function(){var e=t.length,n=1,i="";if(e>0)for(i='<li class="layui-layer-tabli xubox_tab_layer">'+(t[0].content||"no content")+"</li>";n<e;n++)i+='<li class="layui-layer-tabli">'+(t[n].content||"no  content")+"</li>";return i}()+"</ul>",success:function(t){var n=t.find(".layui-layer-title").children(),i=t.find(".layui-layer-tabmain").children();n.on("mousedown",function(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0;var n=a(this),o=n.index();n.addClass("layui-layer-tabnow").siblings().removeClass("layui-layer-tabnow"),i.eq(o).show().siblings().hide(),"function"==typeof e.change&&e.change(o)})}},e))},s.photos=function(e,t,n){var i={};if((e=e||{}).photos){var o=e.photos.constructor===Object,r=o?e.photos:{},c=r.data||[],l=r.start||0;if(i.imgIndex=1+(0|l),e.img=e.img||"img",o){if(0===c.length)return s.msg("&#x6CA1;&#x6709;&#x56FE;&#x7247;")}else{var d=a(e.photos),f=function(){c=[],d.find(e.img).each(function(e){var t=a(this);t.attr("layer-index",e),c.push({alt:t.attr("alt"),pid:t.attr("layer-pid"),src:t.attr("layer-src")||t.attr("src"),thumb:t.attr("src")})})};if(f(),0===c.length)return;if(t||d.on("click",e.img,function(){var t=a(this).attr("layer-index");s.photos(a.extend(e,{photos:{start:t,data:c,tab:e.tab},full:e.full}),!0),f()}),!t)return}i.imgprev=function(e){i.imgIndex--,i.imgIndex<1&&(i.imgIndex=c.length),i.tabimg(e)},i.imgnext=function(e,t){i.imgIndex++,i.imgIndex>c.length&&(i.imgIndex=1,t)||i.tabimg(e)},i.keyup=function(e){if(!i.end){var t=e.keyCode;e.preventDefault(),37===t?i.imgprev(!0):39===t?i.imgnext(!0):27===t&&s.close(i.index)}},i.tabimg=function(t){c.length<=1||(r.start=i.imgIndex-1,s.close(i.index),s.photos(e,!0,t))},i.event=function(){i.bigimg.hover(function(){i.imgsee.show()},function(){i.imgsee.hide()}),i.bigimg.find(".layui-layer-imgprev").on("click",function(e){e.preventDefault(),i.imgprev()}),i.bigimg.find(".layui-layer-imgnext").on("click",function(e){e.preventDefault(),i.imgnext()}),a(document).on("keyup",i.keyup)},i.loadi=s.load(1,{shade:!("shade"in e)&&.9,scrollbar:!1}),function(e,t,n){var i=new Image;if(i.src=e,i.complete)return t(i);i.onload=function(){i.onload=null,t(i)},i.onerror=function(e){i.onerror=null,n(e)}}(c[l].src,function(t){s.close(i.loadi),i.index=s.open(a.extend({type:1,area:function(){var n=[t.width,t.height],i=[a(window).width()-50,a(window).height()-50];return!e.full&&n[0]>i[0]&&(n[0]=i[0],n[1]=n[0]*t.height/t.width),[n[0]+"px",n[1]+"px"]}(),title:!1,shade:.9,shadeClose:!0,closeBtn:!1,move:".layui-layer-phimg img",moveType:1,scrollbar:!1,moveOut:!0,shift:5*Math.random()|0,skin:"layui-layer-photos"+u("photos"),content:'<div class="layui-layer-phimg"><img src="'+c[l].src+'" alt="'+(c[l].alt||"")+'" layer-pid="'+c[l].pid+'"><div class="layui-layer-imgsee">'+(c.length>1?'<span class="layui-layer-imguide"><a href="javascript:;" class="layui-layer-iconext layui-layer-imgprev"></a><a href="javascript:;" class="layui-layer-iconext layui-layer-imgnext"></a></span>':"")+'<div class="layui-layer-imgbar" style="display:'+(n?"block":"")+'"><span class="layui-layer-imgtit"><a href="javascript:;">'+(c[l].alt||"")+"</a><em>"+i.imgIndex+"/"+c.length+"</em></span></div></div></div>",success:function(t,n){i.bigimg=t.find(".layui-layer-phimg"),i.imgsee=t.find(".layui-layer-imguide,.layui-layer-imgbar"),i.event(t),e.tab&&e.tab(c[l],t)},end:function(){i.end=!0,a(document).off("keyup",i.keyup)}},e))},function(){s.close(i.loadi),s.msg("&#x5F53;&#x524D;&#x56FE;&#x7247;&#x5730;&#x5740;&#x5F02;&#x5E38;<br>&#x662F;&#x5426;&#x7EE7;&#x7EED;&#x67E5;&#x770B;&#x4E0B;&#x4E00;&#x5F20;&#xFF1F;",{time:3e4,btn:["&#x4E0B;&#x4E00;&#x5F20;","&#x4E0D;&#x770B;&#x4E86;"],yes:function(){c.length>1&&i.imgnext(!0,!0)}})})}},r.run=function(){a=jQuery,o=a(window),l.html=a("html"),s.open=function(e){return new c(e).index}},r.run(),t.layer=s},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}function a(e,t){var n;if("/"==e.charAt(0))n=k(e.replace(/^\/*/,""),t.root||"/",!0);else{if(!t.filename)throw new Error("`include` use relative path requires the 'filename' option.");n=k(e,t.filename)}return n}function o(e,t){var n,i=e.filename,a=arguments.length>1;if(e.cache){if(!i)throw new Error("cache option requires a filename");if(n=b.get(i))return n;a||(t=u.readFileSync(i).toString().replace(y,""))}else if(!a){if(!i)throw new Error("Internal EJS error: no file name or template provided");t=u.readFileSync(i).toString().replace(y,"")}return n=C(t,e),e.cache&&b.set(i,n),n}function r(e,t,n,i){var a=t.split("\n"),o=Math.max(i-3,0),r=Math.min(a.length,i+3),s=a.slice(o,r).map(function(e,t){var n=t+o+1;return(n==i?" >> ":"    ")+n+"| "+e}).join("\n");throw e.path=n,e.message=(n||"ejs")+":"+i+"\n"+s+"\n\n"+e.message,e}function s(e,t){v.forEach(function(n){void 0!==e[n]&&(t[n]=e[n])})}function c(e,t){t=t||{};var n={};this.templateText=e,this.mode=null,this.truncate=!1,this.currentLine=1,this.source="",this.dependencies=[],n.client=t.client||!0,n.escapeFunction=t.escape||d.escapeXML,n.compileDebug=!1!==t.compileDebug,n.debug=!!t.debug,n.filename=t.filename,n.delimiter=t.delimiter||p,n.strict=t.strict||!1,n.context=t.context,n.cache=t.cache||!1,n.rmWhitespace=t.rmWhitespace,n.root=t.root,n.localsName=t.localsName||_||m,n.strict?n._with=!1:n._with=void 0===t._with||t._with,this.opts=n,this.regex=this.createRegex()}/**
 * @file Embedded JavaScript templating engine.
 * @author Matthew Eernisse <mde@fleegix.org>
 * @author Tiancheng "Timothy" Gu <timothygu99@gmail.com>
 * @project EJS
 * @license {@link http://www.apache.org/licenses/LICENSE-2.0 Apache License, Version 2.0}
 */
Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=t.__express=t.escapeXML=t.clearCache=t.renderFile=t.render=t.compile=t.resolveInclude=t.localsName=t.cache=void 0;var l=i(n(111)),d=i(n(113)),u={},f=!1,h=i(n(114)).version,p="%",m="locals",v=["cache","filename","delimiter","scope","context","debug","compileDebug","client","_with","root","rmWhitespace","strict","localsName"],g=/;\s*$/,y=/^\uFEFF/,b=t.cache=d.cache,_=t.localsName=m,k=t.resolveInclude=function(e,t,n){var i=l.dirname,a=l.extname,o=(0,l.resolve)(n?t:i(t),e);return a(e)||(o+=".ejs"),o},C=t.compile=function(e,t){return t&&t.scope&&(f||(console.warn("`scope` option is deprecated and will be removed in EJS 3"),f=!0),t.context||(t.context=t.scope),delete t.scope),new c(e,t).compile()},T=(t.render=function(e,t,n){var i=t||{},a=n||{};return 2==arguments.length&&s(i,a),o(a,e)(i)},t.renderFile=function(){var e,t=Array.prototype.slice.call(arguments),n=t.shift(),i=t.pop(),a=t.shift()||{},r=t.pop()||{};r=d.shallowCopy({},r),3==arguments.length&&(a.settings&&a.settings["view options"]?s(a.settings["view options"],r):s(a,r)),r.filename=n;try{e=o(r)(a)}catch(e){return i(e)}return i(null,e)});t.clearCache=function(){b.reset()};c.modes={EVAL:"eval",ESCAPED:"escaped",RAW:"raw",COMMENT:"comment",LITERAL:"literal"},c.prototype={createRegex:function(){var e="(<%%|%%>|<%=|<%-|<%_|<%#|<%|%>|-%>|_%>)",t=d.escapeRegExpChars(this.opts.delimiter);return e=e.replace(/%/g,t),new RegExp(e)},compile:function(){var e,t,n=this.opts,i="",s="",c=n.escapeFunction;this.source||(this.generateSource(),i+="  var __output = [], __append = __output.push.bind(__output);\n",!1!==n._with&&(i+="  with ("+n.localsName+" || {}) {\n",s+="  }\n"),s+='  return __output.join("");\n',this.source=i+this.source+s),e=n.compileDebug?"var __line = 1\n  , __lines = "+JSON.stringify(this.templateText)+"\n  , __filename = "+(n.filename?JSON.stringify(n.filename):"undefined")+";\ntry {\n"+this.source+"} catch (e) {\n  rethrow(e, __lines, __filename, __line);\n}\n":this.source,n.debug&&console.log(e),n.client&&(e="escape = escape || "+c.toString()+";\n"+e,n.compileDebug&&(e="rethrow = rethrow || "+r.toString()+";\n"+e)),n.strict&&(e='"use strict";\n'+e);try{t=new Function(n.localsName+", escape, include, rethrow",e)}catch(e){throw e instanceof SyntaxError&&(n.filename&&(e.message+=" in "+n.filename),e.message+=" while compiling ejs"),e}if(n.client)return t.dependencies=this.dependencies,function(){return t.apply(n.context,Array.from(arguments))};var l=function(e){return t.apply(n.context,[e||{},c,function(t,i){var r=d.shallowCopy({},e);return i&&(r=d.shallowCopy(r,i)),function(e,t){var n=d.shallowCopy({},t);return n.filename=a(e,n),o(n)}(t,n)(r)},r])};return l.dependencies=this.dependencies,l},generateSource:function(){this.opts.rmWhitespace&&(this.templateText=this.templateText.replace(/\r/g,"").replace(/^\s+|\s+$/gm,"")),this.templateText=this.templateText.replace(/[ \t]*<%_/gm,"<%_").replace(/_%>[ \t]*/gm,"_%>");var e=this,t=this.parseTemplateText(),n=this.opts.delimiter;t&&t.length&&t.forEach(function(i,o){var r,s,l,f,h,p;if(0===i.indexOf("<"+n)&&0!==i.indexOf("<"+n+n)&&(s=t[o+2])!=n+">"&&s!="-"+n+">"&&s!="_"+n+">")throw new Error('Could not find matching close tag for "'+i+'".');if((l=i.match(/^\s*include\s+(\S+)/))&&(r=t[o-1])&&(r=="<"+n||r=="<"+n+"-"||r=="<"+n+"_"))return f=d.shallowCopy({},e.opts),h=function(e,t){var n,i,o=d.shallowCopy({},t);n=a(e,o),i=u.readFileSync(n).toString().replace(y,""),o.filename=n;var r=new c(i,o);return r.generateSource(),{source:r.source,filename:n,template:i}}(l[1],f),p=e.opts.compileDebug?"    ; (function(){\n      var __line = 1\n      , __lines = "+JSON.stringify(h.template)+"\n      , __filename = "+JSON.stringify(h.filename)+";\n      try {\n"+h.source+"      } catch (e) {\n        rethrow(e, __lines, __filename, __line);\n      }\n    ; }).call(this)\n":"    ; (function(){\n"+h.source+"    ; }).call(this)\n",e.source+=p,void e.dependencies.push(k(l[1],f.filename));e.scanLine(i)})},parseTemplateText:function(){for(var e,t=this.templateText,n=this.regex,i=n.exec(t),a=[];i;)0!==(e=i.index)&&(a.push(t.substring(0,e)),t=t.slice(e)),a.push(i[0]),t=t.slice(i[0].length),i=n.exec(t);return t&&a.push(t),a},scanLine:function(e){function t(){n.truncate?(e=e.replace(/^(?:\r\n|\r|\n)/,""),n.truncate=!1):n.opts.rmWhitespace&&(e=e.replace(/^\n/,"")),e&&(e=e.replace(/\\/g,"\\\\"),e=e.replace(/\n/g,"\\n"),e=e.replace(/\r/g,"\\r"),e=e.replace(/"/g,'\\"'),n.source+='    ; __append("'+e+'")\n')}var n=this,i=this.opts.delimiter,a=0;switch(a=e.split("\n").length-1,e){case"<"+i:case"<"+i+"_":this.mode=c.modes.EVAL;break;case"<"+i+"=":this.mode=c.modes.ESCAPED;break;case"<"+i+"-":this.mode=c.modes.RAW;break;case"<"+i+"#":this.mode=c.modes.COMMENT;break;case"<"+i+i:this.mode=c.modes.LITERAL,this.source+='    ; __append("'+e.replace("<"+i+i,"<"+i)+'")\n';break;case i+i+">":this.mode=c.modes.LITERAL,this.source+='    ; __append("'+e.replace(i+i+">",i+">")+'")\n';break;case i+">":case"-"+i+">":case"_"+i+">":this.mode==c.modes.LITERAL&&t(),this.mode=null,this.truncate=0===e.indexOf("-")||0===e.indexOf("_");break;default:if(this.mode){switch(this.mode){case c.modes.EVAL:case c.modes.ESCAPED:case c.modes.RAW:e.lastIndexOf("//")>e.lastIndexOf("\n")&&(e+="\n")}switch(this.mode){case c.modes.EVAL:this.source+="    ; "+e+"\n";break;case c.modes.ESCAPED:this.source+="    ; __append(escape("+e.replace(g,"").trim()+"))\n";break;case c.modes.RAW:this.source+="    ; __append("+e.replace(g,"").trim()+")\n";break;case c.modes.COMMENT:break;case c.modes.LITERAL:t()}}else t()}n.opts.compileDebug&&a&&(this.currentLine+=a,this.source+="    ; __line = "+this.currentLine+"\n")}};t.escapeXML=d.escapeXML,t.__express=T,t.VERSION=h},,,function(e,t,n){"use strict";/*!art-template - Template Engine | http://aui.github.com/artTemplate/*/
function i(e){return e.replace(b,"").replace(_,",").replace(k,"").replace(C,"").replace(T,"").split(w)}function a(e){return"'"+e.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function o(e,t){function n(e){return f+=e.split(/\n/).length-1,d&&(e=e.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),e&&(e=g[1]+a(e)+g[2]+"\n"),e}function o(e){var n=f;if(l?e=l(e,t):r&&(e=e.replace(/\n/g,function(){return"$line="+ ++f+";"})),0===e.indexOf("=")){var a=u&&!/^=[=#]/.test(e);if(e=e.replace(/^=[=#]?|[\s;]*$/g,""),a){var o=e.replace(/\s*\([^\)]+\)/,"");p[o]||/^(include|print)$/.test(o)||(e="$escape("+e+")")}else e="$string("+e+")";e=g[1]+e+g[2]}return r&&(e="$line="+n+";"+e),y(i(e),function(e){if(e&&!h[e]){var t;t="print"===e?_:"include"===e?k:p[e]?"$utils."+e:m[e]?"$helpers."+e:"$data."+e,C+=e+"="+t+",",h[e]=!0}}),e+"\n"}var r=t.debug,s=t.openTag,c=t.closeTag,l=t.parser,d=t.compress,u=t.escape,f=1,h={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},v="".trim,g=v?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],b=v?"$out+=text;return $out;":"$out.push(text);",_="function(){var text=''.concat.apply('',arguments);"+b+"}",k="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+b+"}",C="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(r?"$line=0,":""),T=g[0],w="return new String("+g[3]+");";y(e.split(s),function(e){var t=(e=e.split(c))[0],i=e[1];1===e.length?T+=n(t):(T+=o(t),i&&(T+=n(i)))});var N=C+T+w;r&&(N="try{"+N+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+a(e)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')};}");try{var I=new Function("$data","$filename",N);return I.prototype=p,I}catch(e){throw e.temp="function anonymous($data,$filename) {"+N+"}",e}}Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(e,t){return"string"==typeof t?g(t,{filename:e}):d(e,t)};s.version="3.0.0",s.config=function(e,t){c[e]=t};var c=s.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},l=s.cache={};s.render=function(e,t){return g(e,t)};var d=s.renderFile=function(e,t){var n=s.get(e)||v({filename:e,name:"Render Error",message:"Template not found"});return t?n(t):n};s.get=function(e){var t;if(l[e])t=l[e];else if("object"==("undefined"==typeof document?"undefined":r(document))){var n=document.getElementById(e);if(n){var i=(n.value||n.innerHTML).replace(/^\s*|\s*$/g,"");t=g(i,{filename:e})}}return t};var u=function e(t,n){return"string"!=typeof t&&("number"===(n=void 0===t?"undefined":r(t))?t+="":t="function"===n?e(t.call(t)):""),t},f={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},h=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},p=s.utils={$helpers:{},$include:d,$string:u,$escape:function(e){return u(e).replace(/&(?![\w#]+;)|[<>"']/g,function(e){return f[e]})},$each:function(e,t){var n,i;if(h(e))for(n=0,i=e.length;i>n;n++)t.call(e,e[n],n,e);else for(n in e)t.call(e,e[n],n)}};s.helper=function(e,t){m[e]=t};var m=s.helpers=p.$helpers;s.onerror=function(e){var t="Template Error\n\n";for(var n in e)t+="<"+n+">\n"+e[n]+"\n\n";"object"==("undefined"==typeof console?"undefined":r(console))&&console.error(t)};var v=function(e){return s.onerror(e),function(){return"{Template Error}"}},g=s.compile=function(e,t){function n(n){try{return new r(n,a)+""}catch(i){return t.debug?v(i)():(t.debug=!0,g(e,t)(n))}}t=t||{};for(var i in c)void 0===t[i]&&(t[i]=c[i]);var a=t.filename;try{var r=o(e,t)}catch(e){return e.filename=a||"anonymous",e.name="Syntax Error",v(e)}return n.prototype=r.prototype,n.toString=function(){return r.toString()},a&&t.cache&&(l[a]=n),n},y=p.$each,b=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,_=/[^\w$]+/g,k=new RegExp(["\\b"+"break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined".replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),C=/^\d[^,]*|,\d[^,]*/g,T=/^,+|,+$/g,w=/^$|,+/,N=s;t.template=N},,,,,function(e,t,n){"use strict";function i(){return s||(s=window.pageData&&window.pageData.productTypeName?window.pageData.productTypeName:"")&&"diy"!=s||(s="selfTour"),s}function a(e){return function(){var e=location.href,t=/\brefresh\b/.test(e);return!t&&window.pageData&&(t=!!window.pageData.refresh),t}()&&(e+=-1===e.indexOf("?")?"?":"&",e+=o),app_url(e)}Object.defineProperty(t,"__esModule",{value:!0});var o="refresh=1",r=window.siteHost||"http://www.tuniu.com",s=void 0;t.config={host:r,url:{submit:function(e){return r+"/tours/"+e.productId+"/book/step1"},calendar:function(){return a("api/"+i()+"/calendar")},couponReceive:function(e){return a("/papi/product/couponReceive/"+e.couponId)},visa:function(e){var t=["/papi/product/visa"];return["productId","bookCityCode","departCityCode"].every(function(n){if(e[n])return t.push("/"+e[n]),!0}),a(t.join(""))},visaSend:function(){return a("/papi/product/visaSend")},visaPrint:function(e){var t=Object.keys(e).map(function(t){var n=e[t];return!!n&&(Array.isArray(n)?t+"="+n.map(function(e){return e.id+":"+e.name}).join(","):t+"="+n)}).filter(function(e){return e}).join("&");return r+"/tn?r=visa/VisaDetail/ShowEmailTemplate&"+t},retail:function(e){return a(["/papi/product/retail",e.bookCode].join("/"))},saveOrder:function(){return"drive"==i()?"/tn?r=order/TourV3DriveOrder/SaveMainRes":"/tn?r=order/DiyV3Order/SaveMainRes"},comment:function(){return a("api/"+i()+"/comment")},recommend:function(){return a("api/"+i()+"/recommend")},checkHotelPrice:function(){return a("api/"+i()+"/checkHotelPrice")},busTicket:function(){return a("api/"+i()+"/busTicket")},busList:function(){return a("api/"+i()+"/busList")},checkBusTicket:function(){return a("api/"+i()+"/checkBusTicket")},defaultResource:function(){return a("api/"+i()+"/resource")},trainList:function(){return a("api/"+i()+"/trainList")},addItem:function(){return a("api/"+i()+"/addItem")},newAddItemList:function(){return a("api/"+i()+"/newAddItemList")},hotelList:function(){return a("api/"+i()+"/hotelList")},hotelDetail:function(){return a("api/"+i()+"/hotelDetail")},hotelRooms:function(){return a("api/"+i()+"/hotelRooms")},combinedTspCity:function(){return a("api/"+i()+"/combinedTspCity")},combinedTrain:function(){return a("api/"+i()+"/combinedTrain")},page:function(e){var t=["/package",e.productId,e.bookCityCode,e.departCity,e.backCityCode].join("/");return e.journeyId&&(t+="?journeyId="+e.journeyId),a(t)},journey:function(e){var t=window.location.search;return-1===t.indexOf("journeyId")?(t+=-1===t.indexOf("?")?"?":"&",t+="journeyId="+e):t=t.replace(/(journeyId=)\d+/,"$1"+e),t},flight:function(){return a("api/"+i()+"/flight")},flightIsInternational:function(){return a("api/"+i()+"/flightIsInternational")},defaultFlight:function(){return a("api/tour/getDefaultFlight")},freeFlight:function(){return a("api/"+i()+"/freeFlight")},recommendFlight:function(){return a("api/"+i()+"/recommendFlight")},checkFlight:function(){return a("api/"+i()+"/flightCheck")},checkFavoriteState:function(){return a("/papi/product/checkFavoriteState")},addFavorite:function(){return a("/papi/product/addFavorite")},removeFavorite:function(){return a("/papi/product/removeFavorite")},login:function(){return"http://www.tuniu.com/u/login"},loginDialog:function(){var e=location.host.split(".")[0];return"https://passport.tuniu.com/login/iframe?origin="+encodeURIComponent("http://www.tuniu.com/ssoConnect/Iframe?reload=detail&domain="+e)},scenicDetail:function(){return a("api/drive/scenicDetail")}}}},,,,function(e,t,n){"use strict";function i(e){return c+e}Object.defineProperty(t,"__esModule",{value:!0}),t.Component=void 0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(494),s=0,c="_request_";t.Component=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));n.id=++s,n.loaded=!1,n.children=[],n.plugins=[],n.type=e.type,n.$element=e.el||n.$element,n.callback=e.callback||{},n.lifecycle=e.lifecycle||{},n.factory=e.factory||{},n.events=e.events||{},n.requests=e.requests||{},n.methods={};var i=e.methods||{};return Object.keys(i).forEach(function(e){n.methods[e]=i[e].bind(n)}),n._load(e),n.initSelfEvents(n.events),n.initRequests(n.requests),n.lifecycle.afterCreate&&n.lifecycle.afterCreate.call(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Emitter),o(t,[{key:"_load",value:function(e){this.loaded&&(this.destroyChildren(),this.loaded=!1),e.data&&(this.data=e.data,this.initialize(e),this.loaded=!0)}},{key:"load",value:function(e){this._load(e),this.dispatch("load")}},{key:"initialize",value:function(e){this.lifecycle.beforeInitialize&&this.lifecycle.beforeInitialize.call(this,e.children),this.initChildren(e.children),this.lifecycle.afterInitialize&&this.lifecycle.afterInitialize.call(this),this.$element&&(this.render(),this.mount(),this.bind()),this.initChildrenEvents()}},{key:"initSelfEvents",value:function(e){var t=this;e&&Object.keys(e).forEach(function(n){t.on(n,e[n])})}},{key:"initChildrenEvents",value:function(){var e=this;this.children.forEach(function(t){return e.initChildEvent(t)})}},{key:"initChildEvent",value:function(e){var t=this;e.on("_all_",function(e){!0!==e.request&&t.dispatch(e.type,e.data,{originTarget:e.originTarget})})}},{key:"initChildren",value:function(e){var t=this;Array.isArray(e)&&e.forEach(function(e){t._addChild(e)})}},{key:"$",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return this.$element?this.$element.find(e):$(null)})},{key:"getDOM",value:function(){return this.$element}},{key:"show",value:function(){this.$element.show()}},{key:"hide",value:function(){this.$element.hide()}},{key:"render",value:function(){var e=void 0;this.lifecycle.beforeRender&&this.lifecycle.beforeRender.call(this),this.callback.render&&(e=$(this.callback.render.call(this,this.data)||"<div />")),this.$element?this.needReplaceDOM?(this.$element.replaceWith(e),this.$element=e):this.$element.empty().append(e):(this.needReplaceDOM=!0,this.$element=e),this.children.forEach(function(e){return e.render()}),this.lifecycle.afterRender&&this.lifecycle.afterRender.call(this)}},{key:"bind",value:function(){this.lifecycle.beforeBind&&this.lifecycle.beforeBind.call(this),this.children.forEach(function(e){return e.bind()}),this.callback.bind&&this.callback.bind.call(this),this.lifecycle.afterBind&&this.lifecycle.afterBind.call(this)}},{key:"mount",value:function(){this.lifecycle.beforeMount&&this.lifecycle.beforeMount.call(this),this.children.forEach(function(e){return e.mount()}),this.callback.mount&&this.callback.mount.call(this,this.$element,this.children),this.lifecycle.afterMount&&this.lifecycle.afterMount.call(this)}},{key:"destroyChildren",value:function(){this.children.forEach(function(e){return e.destroy()}),this.children.length=0}},{key:"destroy",value:function(){this.destroyChildren(),this.$element&&this.$element.remove(),this.off()}},{key:"initPlugin",value:function(){}},{key:"initRequests",value:function(e){var t=this;e&&Object.keys(e).forEach(function(n){t.on(i(n),e[n])})}},{key:"request",value:function(e,t){t={type:e,request:!0,data:t},this.emitRequests(i(e),t)}},{key:"requestProgressAndEmit",value:function(e,t){t={type:e,request:!0,data:t},this.processRequests(i(e),t),this.emitRequests(i(e),t)}},{key:"processAndEmitRequests",value:function(e,t){this.processRequests(e,t),this.emitRequests(e,t)}},{key:"processRequests",value:function(e,t){this.dispatch(e,t.data,{request:!0})}},{key:"emitRequests",value:function(e,t){this.children.forEach(function(n){n.processAndEmitRequests(e,t)})}},{key:"get",value:function(e){return"string"!=typeof e?{type:this.type,children:this.children.map(function(e){return e.get()}),data:Object.assign({},this.data)}:e.split(".").reduce(function(e,t){var n=void 0;try{n=e[t]}catch(e){}return n},this.data)}},{key:"set",value:function(e,t,n){"string"==typeof e?this.setSingle(e,t,n):"object"===(void 0===e?"undefined":a(e))&&this.setBatch(e,t)}},{key:"_set",value:function(e,t){var n=e.split("."),i=n.pop(),a=n.reduce(function(e,t){return e?e[t]:e},this.data);a&&(a[i]=t)}},{key:"setSingle",value:function(e,t,n){var i=this.get(e);if(i!==t){if(this._set(e,t),n&&!0===n.slient)return;this.dispatch("change:"+e,{before:i,after:t,value:t})}}},{key:"setBatch",value:function(e,t){var n=this;if(e){var i={},a={};Object.keys(e).forEach(function(t){var o=n.get(t);o!==e[t]&&(n._set(t,e[t]),i[t]=o,a[t]=e[t])}),t&&!0===t.slient||Object.keys(i).length&&this.dispatch("change",{before:i,after:a,value:value})}}},{key:"indexOfChild",value:function(){}},{key:"getChild",value:function(e){var t=void 0;return this.children.some(function(n){if(n.id===e)return t=n,!0}),t}},{key:"filterChildren",value:function(e,t){return this.children.filter(function(n){return n.get(e)==t})}},{key:"filterChild",value:function(e,t){return this.filterChildren(e,t)[0]}},{key:"getChildren",value:function(){return this.children}},{key:"addChildren",value:function(e,t){var n=this;e&&Array.isArray(t)&&t.forEach(function(t){n.addChild({type:e,data:t})})}},{key:"_addChild",value:function(e){var t=void 0,n=void 0;return this.factory&&(t=this.factory[e.type])&&(n=t(e),this.children.push(n)),n}},{key:"addChild",value:function(e){var t=this._addChild(e);this.$element&&(t.render(),t.mount(),this.lifecycle.whenChildMount&&this.lifecycle.whenChildMount.call(this,t),t.bind()),this.initChildEvent(t)}},{key:"removeChild",value:function(){}},{key:"indexOfPlugin",value:function(){}},{key:"getPlugin",value:function(e){var t=this.plugins.filter(function(t){return t.name===e})[0];return t?t.instance:null}},{key:"addPlugin",value:function(e,t){this.plugins.push({name:e,instance:t})}},{key:"removePlugin",value:function(){}}]),t}()},,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.helper=void 0;var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(77));t.helper={removeHtmlTag:function(e){return String(e).replace(/<[a-zA-Z\/][^<>]*>/g,"")},trimBoundBr:function(e){return"string"==typeof e&&e?e.replace(/\s/g,"").replace(/^(<br\/?>)+/,"").replace(/(<br\/?>)+$/,""):e},resizeImage:function(e,t,n,i,a){var o=void 0;return t=t||0,n=n||0,i=i||0,a=a||0,(o=/^(.*?)(_w\d+_h\d+_c\d+_t\d+)*\.([\w]+)$/.exec(e))?[o[1],"_",["w"+t,"h"+n,"c"+i,"t"+a].join("_"),".",o[3]].join(""):e},nb2br:function(e){return(e=e||"").replace(/\n+?/gm,"<br>")},calculateDuration:function(e,t){if(e&&t){var n=/^(\d+):(\d+)$/,i=n.exec(e);n.lastIndex=0;var a=n.exec(t);if(i&&a)return 60*parseInt(a[1],10)+parseInt(a[2],10)-60*parseInt(i[1],10)-parseInt(i[2],10)}return 0},wrap:function(e){return e},empty:function(e){function t(e){return i.isString(e)?!e.replace(/^\s*|\s*$/g,""):i.isNumber(e)?!e:i.isBoolean(e)?e:Array.isArray(e)?e.every(t):i.isEmpty(e)}return t(e)}}},,,,,function(e,t,n){"use strict";function i(){a.layer.close(s),s=null}Object.defineProperty(t,"__esModule",{value:!0}),t.dialog=void 0;var a=n(10),o=n(116),r=null,s=null;t.dialog={open:function(e){e&&(function(e,t){r=e,window[o.config.getterName]=function(){return r},window[o.config.okCallbackName]=function(e){e=JSON.parse(JSON.stringify(e)),t(e),i()},window[o.config.cancelCallbackName]=function(){i()}}(e.data,e.callback),function(e){s=a.layer.open({type:2,title:[e.title,"font-weight:bold;font-size:16px;"],shadeClose:!0,shade:.8,move:!1,area:e.area||[.8*$(window).width()<1e3?"80%":"1000px","95%"],content:[e.url],end:function(){r=null,["getterName","okCallbackName","cancelCallbackName"].forEach(function(e){window[o.config[e]]=null;try{delete window[o.config[e]]}catch(e){}})}})}({title:e.title,url:e.url,area:e.area}))},close:i}},,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LOAD_CALENDAR="LOAD_CALENDAR",t.LOAD_CALENDAR_ROOM_BUDGET="LOAD_CALENDAR_ROOM_BUDGET",t.CHANGE_DEPART_DATE="CHANGE_DEPART_DATE",t.CHANGE_DEPART_CITY="CHANGE_DEPART_CITY",t.CHANGE_BACK_CITY="CHANGE_BACK_CITY",t.CHANGE_ADULT="CHANGE_ADULT",t.CHANGE_CHILD="CHANGE_CHILD",t.CHANGE_FREE_CHILD="CHANGE_FREE_CHILD",t.CHANGE_ADULT_TICKET="CHANGE_ADULT_TICKET",t.CHANGE_CHILD_TICKET="CHANGE_CHILD_TICKET",t.CHANGE_TRAIN_ADULT_TICKET="CHANGE_TRAIN_ADULT_TICKET",t.CHANGE_TRAIN_CHILD_TICKET="CHANGE_TRAIN_CHILD_TICKET",t.CHANGE_FREE_CHILD_TICKET="CHANGE_FREE_CHILD_TICKET",t.CHANGE_DEPART_DATE_TARGET="CHANGE_DEPART_DATE_TARGET",t.CHANGE_PRODUCT_STATUS="CHANGE_PRODUCT_STATUS",t.CHANGE_JOURNEY_DAY="CHANGE_JOURNEY_DAY"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LOAD_CALENDAR="LOAD_CALENDAR",t.CHANGE_DEPART_DATE="CHANGE_DEPART_DATE",t.CHILDREN_PRICE_TIP="CHILDREN_PRICE_TIP",t.CHILDREN_FREE_PRICE_TIP="CHILDREN_FREE_PRICE_TIP",t.CHECK_FLIGHT_RES_FAIL="CHECK_FLIGHT_RES_FAIL",t.INIT_VISA_FLAG="INIT_VISA_FLAG",t.SET_TRAFFIC_TYPE="SET_TRAFFIC_TYPE",t.SET_MIXED_TYPE="SET_MIXED_TYPE",t.SET_FLIGHT_INTERNATIONAL_NORMAL="SET_FLIGHT_INTERNATIONAL_NORMAL",t.SET_FLIGHT_TO_LIST_DATA="SET_FLIGHT_TO_LIST_DATA",t.SET_ORIGINALFLIGHT_DATA="SET_ORIGINALFLIGHT_DATA",t.SET_SUPPORT_CONDITION="SET_SUPPORT_CONDITION",t.SET_CANCEL_DESC="SET_CANCEL_DESC"},,,,,,,,,,,,,,,function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.Gallery=void 0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(110)),r=1,s=[],c={showNav:!0,direction:r,navDirection:r,thumbWidth:108,thumbHeight:50,galleryWidth:500,galleryHeight:282,navOffset:4,navAmountInView:4,navMinLimit:1,selectors:{},classNames:{}},l={displayBox:".gallery-display-box",photoItem:".gallery-photo",videoCover:".gallery-video-cover",videoButton:".gallery-video-button",navContainer:".gallery-nav",navPrev:".gallery-prev",navNext:".gallery-next",navMask:".gallery-mask",navList:".gallery-nav-list"},d={photoActive:"gallery-photo-active"},u=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.option=Object.assign({},c,i),this.container=$(t),this.selectors={},this.classNames={},0!==this.container.length&&(Object.keys(l).forEach(function(e){n.selectors[e]=n.option.selectors[e]||l[e]}),Object.keys(d).forEach(function(e){n.classNames[e]=n.option.classNames[e]||d[e]}),this.option.pictures?this.pictures=this.option.pictures.slice():this.pictures=this.collectPictures(),this.length=this.pictures.length,this.length<=1||(this.containerWidth=this.option.galleryWidth,this.containerHeight=this.option.galleryHeight,this.currentIndex=0,this.nextIndex=0,this.timer=null,this.navVisible=!1,this.navChanging=!1,this.displayChanging=!1,this.changing=!1,this.hovering=!1,this.videoPlaying=!1,this.option.direction==r?(this.positionProperty="left",this.displayChangeStep=this.option.galleryWidth):(this.positionProperty="top",this.displayChangeStep=this.option.galleryHeight),this.option.navDirection==r?(this.navPositionProperty="left",this.thumbChangeStep=this.option.thumbWidth):(this.navPositionProperty="top",this.thumbChangeStep=this.option.thumbHeight),this.initialize(),this.initializeDisplay(),this.length>this.option.navMinLimit&&this.option.showNav&&this.initializeNav(),this.option.autoChange&&this.startAutoChange(),function(e){s.push(e)}(this)))}return a(e,[{key:"initialize",value:function(){var e=this;this.container.hover(function(){e.hovering=!0,e.stopAutoChange()},function(){e.hovering=!1,e.startAutoChange()})}},{key:"collectPictures",value:function(){return this.container.find(this.selectors.photoItem).map(function(){var e=$(this);return{picture:e.data("src"),thumb:e.data("thumb"),type:e.data("type"),video:e.data("video"),loaded:!1,element:e}}).toArray()}},{key:"getPicture",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.pictures[e]}},{key:"getNextIndex",value:function(){return(this.currentIndex+1)%this.length}},{key:"getPrevIndex",value:function(){return(this.length+this.currentIndex-1)%this.length}},{key:"startAutoChange",value:function(){this.stopAutoChange(),this.autoChange()}},{key:"stopAutoChange",value:function(){clearTimeout(this.timer)}},{key:"autoChange",value:function(){var e=this;this.videoPlaying||(this.timer=setTimeout(function(){e.change(e.getNextIndex())},5e3))}},{key:"change",value:function(e,t){this.changing||e==this.currentIndex||(t||(t=e<this.currentIndex?-1:1),this.nextIndex=e,this.changing=!0,this.videoPlaying=!1,this.changeDisplay(t),this.option.showNav&&this.changeNav(),this.currentIndex=this.nextIndex)}},{key:"endChange",value:function(){this.displayChanging||this.navChanging||(this.changing=!1,this.hovering||this.startAutoChange())}},{key:"initializeNav",value:function(){var e,t,n=this,i=this;this.container.find(this.selectors.navContainer).length&&(e=this.container.find(this.selectors.navList),t=e.children(),this.option.navDirection==r?e.width(this.length*this.option.thumbWidth):e.height(this.length*this.option.thumbHeight),this.pictures.forEach(function(e,i){t.eq(i).click(function(){this.change(i)}.bind(n))}),this.container.find(this.selectors.navPrev).click(function(){i.change(i.getPrevIndex(),-1)}),this.container.find(this.selectors.navNext).click(function(){i.change(i.getNextIndex(),1)}))}},{key:"changeNav",value:function(){var e,t,n=this,a=this.container.find(this.selectors.navList),o=this.container.find(this.selectors.navMask);e=Math.max(0,this.nextIndex-this.option.navAmountInView+1)*this.thumbChangeStep,t=this.thumbChangeStep*this.nextIndex-e,n.navChanging=!0,o.animate(i({},this.navPositionProperty,t+this.option.navOffset),700),a.animate(i({},this.navPositionProperty,-e),700,function(){n.navChanging=!1,n.endChange()})}},{key:"initializeDisplay",value:function(){var e=this,t=this,n=this.currentIndex,i=this.containerWidth;this.container.find(this.selectors.photoItem).each(function(e){$(this).css(t.positionProperty,n==e?0:-i)}),this.pictures.forEach(function(t){switch(t.type){case"video":e.initializeVideo(t)}})}},{key:"createVideo",value:function(e,t,n){return $("<iframe />").attr({frameborder:0,scrolling:"no",width:t,height:n,src:e})}},{key:"initializeVideo",value:function(e){var t={f:e.video,c:0,b:1,p:1,i:e.picture,e:0,loaded:"ckLoadedHandler"},n=this.option.galleryWidth,i=this.option.galleryHeight,a=[e.video],r=this,s=e.element.find(this.selectors.videoCover),c=e.element.find(this.selectors.videoButton),l=$("<div />").width(n).height(i);l.hide().appendTo(e.element),e.videoContainer=l,e.videoCover=s,window.playerstop=function(){r.resetVideo(e)},c.click(function(){e.videoObject||(o['default'].embed(cdnConfig.url+"/site/static/js/plugins/ckplayer/6.8/ckplayer.swf",l[0],"J_Player",n,i,!1,t,a),e.videoObject=o['default'].getObjectById("J_Player")),s.hide(),l.show(),$.isPlainObject(e.videoObject)&&e.videoObject.videoPlay(),r.videoPlaying=!0,r.stopAutoChange()})}},{key:"resetVideo",value:function(e){e.videoCover.show(),e.videoContainer.hide(),$.isPlainObject(e.videoObject)?(e.videoObject.videoPause(),e.videoObject.videoSeek(0)):e.videoObject=null}},{key:"changeDisplay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this,n=this.positionProperty,a=this.getPicture(this.currentIndex),o=this.getPicture(this.nextIndex);this.displayChanging=!0,o.element.css(n,e*this.containerWidth),"video"===a.type&&this.resetVideo(a),a.element.addClass(this.classNames.photoActive),o.element.addClass(this.classNames.photoActive),this.container.find(this.selectors.displayBox).stop(!0,!0).animate(i({},n,-this.containerWidth*e),700,function(){$(this).css(n,0),o.element.css(n,0),a.element.css(n,-t.containerWidth).removeClass(t.classNames.photoActive),t.displayChanging=!1,t.endChange()})}},{key:"destroy",value:function(){!function(e){var t=s.indexOf(e);~t&&s.splice(t,1)}(this)}}]),e}();u.create=function(){return new(Function.prototype.bind.apply(u.apply,[null].concat(Array.prototype.slice.call(arguments))))},t.Gallery=u},,,,function(e,t,n){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var n=this||window,a=n._,o={},r=Array.prototype,s=Object.prototype,c=Function.prototype,l=r.push,d=r.slice,u=r.concat,f=s.toString,h=s.hasOwnProperty,p=r.forEach,m=r.map,v=r.reduce,g=r.reduceRight,y=r.filter,b=r.every,_=r.some,k=r.indexOf,C=r.lastIndexOf,T=Array.isArray,w=Object.keys,N=c.bind,I=function e(t){return t instanceof e?t:this instanceof e?void(this._wrapped=t):new e(t)};void 0!==e&&e.exports&&(t=e.exports=I),t._=I,I.VERSION="1.6.0";var D=I.each=I.forEach=function(e,t,n){if(null==e)return e;if(p&&e.forEach===p)e.forEach(t,n);else if(e.length===+e.length){for(var i=0,a=e.length;i<a;i++)if(t.call(n,e[i],i,e)===o)return}else for(var r=I.keys(e),i=0,a=r.length;i<a;i++)if(t.call(n,e[r[i]],r[i],e)===o)return;return e};I.map=I.collect=function(e,t,n){var i=[];return null==e?i:m&&e.map===m?e.map(t,n):(D(e,function(e,a,o){i.push(t.call(n,e,a,o))}),i)};var S="Reduce of empty array with no initial value";I.reduce=I.foldl=I.inject=function(e,t,n,i){var a=arguments.length>2;if(null==e&&(e=[]),v&&e.reduce===v)return i&&(t=I.bind(t,i)),a?e.reduce(t,n):e.reduce(t);if(D(e,function(e,o,r){a?n=t.call(i,n,e,o,r):(n=e,a=!0)}),!a)throw new TypeError(S);return n},I.reduceRight=I.foldr=function(e,t,n,i){var a=arguments.length>2;if(null==e&&(e=[]),g&&e.reduceRight===g)return i&&(t=I.bind(t,i)),a?e.reduceRight(t,n):e.reduceRight(t);var o=e.length;if(o!==+o){var r=I.keys(e);o=r.length}if(D(e,function(s,c,l){c=r?r[--o]:--o,a?n=t.call(i,n,e[c],c,l):(n=e[c],a=!0)}),!a)throw new TypeError(S);return n},I.find=I.detect=function(e,t,n){var i;return x(e,function(e,a,o){if(t.call(n,e,a,o))return i=e,!0}),i},I.filter=I.select=function(e,t,n){var i=[];return null==e?i:y&&e.filter===y?e.filter(t,n):(D(e,function(e,a,o){t.call(n,e,a,o)&&i.push(e)}),i)},I.reject=function(e,t,n){return I.filter(e,function(e,i,a){return!t.call(n,e,i,a)},n)},I.every=I.all=function(e,t,n){t||(t=I.identity);var i=!0;return null==e?i:b&&e.every===b?e.every(t,n):(D(e,function(e,a,r){if(!(i=i&&t.call(n,e,a,r)))return o}),!!i)};var x=I.some=I.any=function(e,t,n){t||(t=I.identity);var i=!1;return null==e?i:_&&e.some===_?e.some(t,n):(D(e,function(e,a,r){if(i||(i=t.call(n,e,a,r)))return o}),!!i)};I.contains=I.include=function(e,t){return null!=e&&(k&&e.indexOf===k?-1!=e.indexOf(t):x(e,function(e){return e===t}))},I.invoke=function(e,t){var n=d.call(arguments,2),i=I.isFunction(t);return I.map(e,function(e){return(i?t:e[t]).apply(e,n)})},I.pluck=function(e,t){return I.map(e,I.property(t))},I.where=function(e,t){return I.filter(e,I.matches(t))},I.findWhere=function(e,t){return I.find(e,I.matches(t))},I.max=function(e,t,n){if(!t&&I.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);var i=-1/0,a=-1/0;return D(e,function(e,o,r){var s=t?t.call(n,e,o,r):e;s>a&&(i=e,a=s)}),i},I.min=function(e,t,n){if(!t&&I.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);var i=1/0,a=1/0;return D(e,function(e,o,r){var s=t?t.call(n,e,o,r):e;s<a&&(i=e,a=s)}),i},I.shuffle=function(e){var t,n=0,i=[];return D(e,function(e){t=I.random(n++),i[n-1]=i[t],i[t]=e}),i},I.sample=function(e,t,n){return null==t||n?(e.length!==+e.length&&(e=I.values(e)),e[I.random(e.length-1)]):I.shuffle(e).slice(0,Math.max(0,t))};var P=function(e){return null==e?I.identity:I.isFunction(e)?e:I.property(e)};I.sortBy=function(e,t,n){return t=P(t),I.pluck(I.map(e,function(e,i,a){return{value:e,index:i,criteria:t.call(n,e,i,a)}}).sort(function(e,t){var n=e.criteria,i=t.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(n<i||void 0===i)return-1}return e.index-t.index}),"value")};var M=function(e){return function(t,n,i){var a={};return n=P(n),D(t,function(o,r){var s=n.call(i,o,r,t);e(a,s,o)}),a}};I.groupBy=M(function(e,t,n){I.has(e,t)?e[t].push(n):e[t]=[n]}),I.indexBy=M(function(e,t,n){e[t]=n}),I.countBy=M(function(e,t){I.has(e,t)?e[t]++:e[t]=1}),I.sortedIndex=function(e,t,n,i){for(var a=(n=P(n)).call(i,t),o=0,r=e.length;o<r;){var s=o+r>>>1;n.call(i,e[s])<a?o=s+1:r=s}return o},I.toArray=function(e){return e?I.isArray(e)?d.call(e):e.length===+e.length?I.map(e,I.identity):I.values(e):[]},I.size=function(e){return null==e?0:e.length===+e.length?e.length:I.keys(e).length},I.first=I.head=I.take=function(e,t,n){if(null!=e)return null==t||n?e[0]:t<0?[]:d.call(e,0,t)},I.initial=function(e,t,n){return d.call(e,0,e.length-(null==t||n?1:t))},I.last=function(e,t,n){if(null!=e)return null==t||n?e[e.length-1]:d.call(e,Math.max(e.length-t,0))},I.rest=I.tail=I.drop=function(e,t,n){return d.call(e,null==t||n?1:t)},I.compact=function(e){return I.filter(e,I.identity)};I.flatten=function(e,t){return function e(t,n,i){return n&&I.every(t,I.isArray)?u.apply(i,t):(D(t,function(t){I.isArray(t)||I.isArguments(t)?n?l.apply(i,t):e(t,n,i):i.push(t)}),i)}(e,t,[])},I.without=function(e){return I.difference(e,d.call(arguments,1))},I.partition=function(e,t){var n=[],i=[];return D(e,function(e){(t(e)?n:i).push(e)}),[n,i]},I.uniq=I.unique=function(e,t,n,i){I.isFunction(t)&&(i=n,n=t,t=!1);var a=n?I.map(e,n,i):e,o=[],r=[];return D(a,function(n,i){(t?i&&r[r.length-1]===n:I.contains(r,n))||(r.push(n),o.push(e[i]))}),o},I.union=function(){return I.uniq(I.flatten(arguments,!0))},I.intersection=function(e){var t=d.call(arguments,1);return I.filter(I.uniq(e),function(e){return I.every(t,function(t){return I.contains(t,e)})})},I.difference=function(e){var t=u.apply(r,d.call(arguments,1));return I.filter(e,function(e){return!I.contains(t,e)})},I.zip=function(){for(var e=I.max(I.pluck(arguments,"length").concat(0)),t=new Array(e),n=0;n<e;n++)t[n]=I.pluck(arguments,""+n);return t},I.object=function(e,t){if(null==e)return{};for(var n={},i=0,a=e.length;i<a;i++)t?n[e[i]]=t[i]:n[e[i][0]]=e[i][1];return n},I.indexOf=function(e,t,n){if(null==e)return-1;var i=0,a=e.length;if(n){if("number"!=typeof n)return i=I.sortedIndex(e,t),e[i]===t?i:-1;i=n<0?Math.max(0,a+n):n}if(k&&e.indexOf===k)return e.indexOf(t,n);for(;i<a;i++)if(e[i]===t)return i;return-1},I.lastIndexOf=function(e,t,n){if(null==e)return-1;var i=null!=n;if(C&&e.lastIndexOf===C)return i?e.lastIndexOf(t,n):e.lastIndexOf(t);for(var a=i?n:e.length;a--;)if(e[a]===t)return a;return-1},I.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((t-e)/n),0),a=0,o=new Array(i);a<i;)o[a++]=e,e+=n;return o};var $=function(){};I.bind=function(e,t){var n,i;if(N&&e.bind===N)return N.apply(e,d.call(arguments,1));if(!I.isFunction(e))throw new TypeError;return n=d.call(arguments,2),i=function(){if(!(this instanceof i))return e.apply(t,n.concat(d.call(arguments)));$.prototype=e.prototype;var a=new $;$.prototype=null;var o=e.apply(a,n.concat(d.call(arguments)));return Object(o)===o?o:a}},I.partial=function(e){var t=d.call(arguments,1);return function(){for(var n=0,i=t.slice(),a=0,o=i.length;a<o;a++)i[a]===I&&(i[a]=arguments[n++]);for(;n<arguments.length;)i.push(arguments[n++]);return e.apply(this,i)}},I.bindAll=function(e){var t=d.call(arguments,1);if(0===t.length)throw new Error("bindAll must be passed function names");return D(t,function(t){e[t]=I.bind(e[t],e)}),e},I.memoize=function(e,t){var n={};return t||(t=I.identity),function(){var i=t.apply(this,arguments);return I.has(n,i)?n[i]:n[i]=e.apply(this,arguments)}},I.delay=function(e,t){var n=d.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},I.defer=function(e){return I.delay.apply(I,[e,1].concat(d.call(arguments,1)))},I.throttle=function(e,t,n){var i,a,o,r=null,s=0;n||(n={});return function(){var c=I.now();s||!1!==n.leading||(s=c);var l=t-(c-s);return i=this,a=arguments,l<=0?(clearTimeout(r),r=null,s=c,o=e.apply(i,a),i=a=null):r||!1===n.trailing||(r=setTimeout(function(){s=!1===n.leading?0:I.now(),r=null,o=e.apply(i,a),i=a=null},l)),o}},I.debounce=function(e,t,n){var i,a,o,r,s;return function(){o=this,a=arguments,r=I.now();var c=n&&!i;return i||(i=setTimeout(function c(){var l=I.now()-r;l<t?i=setTimeout(c,t-l):(i=null,n||(s=e.apply(o,a),o=a=null))},t)),c&&(s=e.apply(o,a),o=a=null),s}},I.once=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}},I.wrap=function(e,t){return I.partial(t,e)},I.compose=function(){var e=arguments;return function(){for(var t=arguments,n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},I.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},I.keys=function(e){if(!I.isObject(e))return[];if(w)return w(e);var t=[];for(var n in e)I.has(e,n)&&t.push(n);return t},I.values=function(e){for(var t=I.keys(e),n=t.length,i=new Array(n),a=0;a<n;a++)i[a]=e[t[a]];return i},I.pairs=function(e){for(var t=I.keys(e),n=t.length,i=new Array(n),a=0;a<n;a++)i[a]=[t[a],e[t[a]]];return i},I.invert=function(e){for(var t={},n=I.keys(e),i=0,a=n.length;i<a;i++)t[e[n[i]]]=n[i];return t},I.functions=I.methods=function(e){var t=[];for(var n in e)I.isFunction(e[n])&&t.push(n);return t.sort()},I.extend=function(e){return D(d.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},I.pick=function(e){var t={},n=u.apply(r,d.call(arguments,1));return D(n,function(n){n in e&&(t[n]=e[n])}),t},I.omit=function(e){var t={},n=u.apply(r,d.call(arguments,1));for(var i in e)I.contains(n,i)||(t[i]=e[i]);return t},I.defaults=function(e){return D(d.call(arguments,1),function(t){if(t)for(var n in t)void 0===e[n]&&(e[n]=t[n])}),e},I.clone=function(e){return I.isObject(e)?I.isArray(e)?e.slice():I.extend({},e):e},I.tap=function(e,t){return t(e),e};I.isEqual=function(e,t){return function e(t,n,a,o){if(t===n)return 0!==t||1/t==1/n;if(null==t||null==n)return t===n;t instanceof I&&(t=t._wrapped),n instanceof I&&(n=n._wrapped);var r=f.call(t);if(r!=f.call(n))return!1;switch(r){case"[object String]":return t==String(n);case"[object Number]":return t!=+t?n!=+n:0==t?1/t==1/n:t==+n;case"[object Date]":case"[object Boolean]":return+t==+n;case"[object RegExp]":return t.source==n.source&&t.global==n.global&&t.multiline==n.multiline&&t.ignoreCase==n.ignoreCase}if("object"!=(void 0===t?"undefined":i(t))||"object"!=(void 0===n?"undefined":i(n)))return!1;for(var s=a.length;s--;)if(a[s]==t)return o[s]==n;var c=t.constructor,l=n.constructor;if(c!==l&&!(I.isFunction(c)&&c instanceof c&&I.isFunction(l)&&l instanceof l)&&"constructor"in t&&"constructor"in n)return!1;a.push(t),o.push(n);var d=0,u=!0;if("[object Array]"==r){if(d=t.length,u=d==n.length)for(;d--&&(u=e(t[d],n[d],a,o)););}else{for(var h in t)if(I.has(t,h)&&(d++,!(u=I.has(n,h)&&e(t[h],n[h],a,o))))break;if(u){for(h in n)if(I.has(n,h)&&!d--)break;u=!d}}return a.pop(),o.pop(),u}(e,t,[],[])},I.isEmpty=function(e){if(null==e)return!0;if(I.isArray(e)||I.isString(e))return 0===e.length;for(var t in e)if(I.has(e,t))return!1;return!0},I.isElement=function(e){return!(!e||1!==e.nodeType)},I.isArray=T||function(e){return"[object Array]"==f.call(e)},I.isObject=function(e){return e===Object(e)},D(["Arguments","Function","String","Number","Date","RegExp"],function(e){I["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),I.isArguments(arguments)||(I.isArguments=function(e){return!(!e||!I.has(e,"callee"))}),I.isFunction=function(e){return"function"==typeof e},I.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},I.isNaN=function(e){return I.isNumber(e)&&e!=+e},I.isBoolean=function(e){return!0===e||!1===e||"[object Boolean]"==f.call(e)},I.isNull=function(e){return null===e},I.isUndefined=function(e){return void 0===e},I.has=function(e,t){return h.call(e,t)},I.noConflict=function(){return n._=a,this},I.identity=function(e){return e},I.constant=function(e){return function(){return e}},I.property=function(e){return function(t){return t[e]}},I.matches=function(e){return function(t){if(t===e)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0}},I.times=function(e,t,n){for(var i=Array(Math.max(0,e)),a=0;a<e;a++)i[a]=t.call(n,a);return i},I.random=function(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))},I.now=Date.now||function(){return(new Date).getTime()};var j={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};j.unescape=I.invert(j.escape);var E={escape:new RegExp("["+I.keys(j.escape).join("")+"]","g"),unescape:new RegExp("("+I.keys(j.unescape).join("|")+")","g")};I.each(["escape","unescape"],function(e){I[e]=function(t){return null==t?"":(""+t).replace(E[e],function(t){return j[e][t]})}}),I.result=function(e,t){if(null!=e){var n=e[t];return I.isFunction(n)?n.call(e):n}},I.mixin=function(e){D(I.functions(e),function(t){var n=I[t]=e[t];I.prototype[t]=function(){var e=[this._wrapped];return l.apply(e,arguments),J.call(this,n.apply(I,e))}})};var O=0;I.uniqueId=function(e){var t=++O+"";return e?e+t:t},I.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var A=/(.)^/,L={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},R=/\\|'|\r|\n|\t|\u2028|\u2029/g;I.template=function(e,t,n){var i;n=I.defaults({},n,I.templateSettings);var a=new RegExp([(n.escape||A).source,(n.interpolate||A).source,(n.evaluate||A).source].join("|")+"|$","g"),o=0,r="__p+='";e.replace(a,function(t,n,i,a,s){return r+=e.slice(o,s).replace(R,function(e){return"\\"+L[e]}),n&&(r+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(r+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),a&&(r+="';\n"+a+"\n__p+='"),o=s+t.length,t}),r+="';\n",n.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{i=new Function(n.variable||"obj","_",r)}catch(e){throw e.source=r,e}if(t)return i(t,I);var s=function(e){return i.call(this,e,I)};return s.source="function("+(n.variable||"obj")+"){\n"+r+"}",s},I.chain=function(e){return I(e).chain()};var J=function(e){return this._chain?I(e).chain():e};return I.mixin(I),D(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];I.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),"shift"!=e&&"splice"!=e||0!==n.length||delete n[0],J.call(this,n)}}),D(["concat","join","slice"],function(e){var t=r[e];I.prototype[e]=function(){return J.call(this,t.apply(this._wrapped,arguments))}}),I.extend(I.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),I}).call(void 0)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.blockTemplate='\n<div class="block">\n    <div class="block-head">\n        <div class="title"><%= title %></div>\n    </div>\n\n    <div class="J_blockBody block-body">\n\n    </div>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=window.$,a=13,o={down:{direction:1,axis:"y",control:"height",justify:"width"},up:{direction:-1,axis:"y",control:"height",justify:"width"},right:{direction:1,axis:"x",control:"width",justify:"height"},left:{direction:-1,axis:"x",control:"width",justify:"height"}},r=i("body"),s=i(window),c=i("<div />").addClass("where-popup"),l=i("<div />").addClass("where-box"),d=i("<i />").addClass("where-arrow");c.append(d,l);var u=null;t.showPopup=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];u=setTimeout(function(){(function(e,t){var n=e.offset();if(n){if(n.width=e.outerWidth(),n.height=e.outerHeight(),n.win={x:s.scrollLeft(),y:s.scrollTop(),width:s.width(),height:s.height()},t.rangeTarget){var u=i(t.rangeTarget),f=u.offset();if(f){f.width=u.width(),f.height=u.height();var h=Math.min(n.win.x+n.win.width,f.left+f.width),p=Math.min(n.win.y+n.win.height,f.top+f.height);n.win.x=Math.max(n.win.x,f.left),n.win.y=Math.max(n.win.y,f.top),n.win.width=h-n.win.x,n.win.height=p-n.win.y}}n.x=n.left+n.width/2-n.win.x,n.y=n.top+n.height/2-n.win.y,l.html(t.content),c.addClass("hidden").appendTo(r);var m=function(e,t){var n=Object.keys(o).map(function(n){var i=o[n],r=i.direction,s=i.axis,c=i.control,l=e[s]+r*(e[c]/2+t[c]+a),d=!1,u=0;return r>0?(d=l<=e.win[c],u=e.win[c]-l):(d=l>=0,u=l),{direction:n,valid:d,delta:u}}),i=n.filter(function(e){return e.valid})[0];i||(i=n.sort(function(e,t){return t.delta-e.delta})[0]);var r=i.direction,s=o[r],c=void 0;if("x"===s.axis){var l=Math.min(e.win.height-t.height,Math.max(0,e.y-t.height/2));c={direction:r,left:s.direction>0?e.x+e.width/2+a:e.x-e.width/2-a-t.width,top:l,arrowLeft:s.direction>0?-6:t.width-1,arrowTop:Math.max(0,e.y-l-3)}}else{var d=Math.min(e.win.width-t.width,Math.max(0,e.x-t.width/2));c={direction:r,left:d,top:s.direction>0?e.y+e.height/2+a:e.y-e.height/2-a-t.height,arrowLeft:Math.max(0,e.x-d-3),arrowTop:s.direction>0?-6:t.height-1}}return c.left+=e.win.x,c.top+=e.win.y,c}(n,{width:l.width(),height:l.height()});d.css({left:m.arrowLeft,top:m.arrowTop}).addClass(m.direction),c.css({left:m.left,top:m.top-10}).removeClass("hidden")}}).apply(this,t)},200)},t.hidePopup=function(){clearTimeout(u),c.remove(),l.empty(),d.removeClass("up down right left"),r.width()}},function(e,t,n){"use strict";function i(e,t){u.push({target:e,callback:t}),l&&(l=!1,c.on("resize",o).on("resize scroll",r),o(),r())}function a(e){var t=-1;u.some(function(n,i){if(n.target===e)return t=i,!0}),-1!==t&&u.splice(t,1),0===u.length&&(l=!0,c.off("resize",o).off("resize scroll",r))}function o(){clearTimeout(f),f=setTimeout(function(){d=c.height(),u.forEach(function(e){e.visible=e.target.is(":visible"),e.offset=e.target.offset(),e.width=e.target.width(),e.height=e.target.height()})},s)}function r(){clearTimeout(h),h=setTimeout(function(){var e=c.scrollTop(),t=!1;u.filter(function(n){return!!(n.visible&&n.offset&&n.offset.top<d+e&&n.offset.top+n.height>e)&&(t=!0,!0)}).forEach(function(e){e.callback&&e.callback()}),t&&c.trigger("resize")},s)}Object.defineProperty(t,"__esModule",{value:!0});var s=150,c=$(window),l=!0,d=void 0,u=[],f=void 0,h=void 0;t.bind=i,t.unbind=a,t.on=i,t.off=a},function(e,t){},function(module,exports,__webpack_require__){"use strict";function ckcpt(){return""}function ckstyle(){return{cpath:"",language:"",flashvars:"",setup:"1,1,1,1,1,2,0,1,2,0,0,1,200,0,2,1,0,1,1,1,1,10,3,0,1,2,3000,0,0,0,0,1,1,1,1,1,1,250,0,90,0,0,0",pm_bg:"0x000000,100,230,180",mylogo:"logo.swf",pm_mylogo:"1,1,-100,-55",logo:"cklogo.png",pm_logo:"2,0,-100,20",control_rel:"related.swf,ckplayer/related.xml,0",control_pv:"Preview.swf,105,2000",pm_repc:"",pm_spac:"|",pm_fpac:"file->f",pm_advtime:"2,0,-110,10,0,300,0",pm_advstatus:"1,2,2,-200,-40",pm_advjp:"1,1,2,2,-100,-40",pm_padvc:"2,0,-13,-13",pm_advms:"2,2,-46,-67",pm_zip:"1,1,-20,-8,1,0,0",pm_advmarquee:"1,2,50,-70,50,20,0,0x000000,50,0,20,1,30,2000",pm_glowfilter:"1,0x01485d, 100, 6, 3, 10, 1, 0, 0",advmarquee:escape('{a href="http://www.ckplayer.com"}{font color="#FFFFFF" size="12" face="Microsoft YaHei"}{/font}{/a}'),mainfuntion:"",flashplayer:"",calljs:"ckplayer_status,ckadjump,playerstop,ckmarqueeadv",myweb:escape(""),cpt_lights:"1",cpt_share:"ckplayer/share.xml",cpt_list:""}}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},CKobject={_K_:function(e){return"string"==typeof e?document.getElementById(e):e},_T_:!1,_M_:!1,_G_:!1,_Y_:!1,_I_:null,_J_:0,_O_:{},uaMatch:function(e,t,n,i,a,o,r,s,c){var l=t.exec(e);return null!=l?{b:"IE",v:l[2]||"0"}:null!=(l=n.exec(e))?{b:l[1]||"",v:l[2]||"0"}:null!=(l=i.exec(e))?{b:l[1]||"",v:l[2]||"0"}:null!=(l=a.exec(e))?{b:l[1]||"",v:l[2]||"0"}:null!=(l=o.exec(e))?{b:l[2]||"",v:l[1]||"0"}:null!=(l=r.exec(e))?{b:l[1]||"",v:l[2]||"0"}:null!=(l=s.exec(e))?{b:l[1]||"",v:l[2]||"0"}:null!=(l=c.exec(e))?{b:l[1]||"",v:l[2]||"0"}:{b:"unknown",v:"0"}},browser:function(){var e=navigator.userAgent.toLowerCase(),t=this.uaMatch(e,/(msie\s|trident.*rv:)([\w.]+)/,/(firefox)\/([\w.]+)/,/(opera).+version\/([\w.]+)/,/(chrome)\/([\w.]+)/,/version\/([\w.]+).*(safari)/,/(safari)\/([\w.]+)/,/(mozilla)\/([\w.]+)/,/(mobile)\/([\w.]+)/);if(t.b)var n=t.b,i=t.v;return{B:n,V:i}},Platform:function(){var e="",t=navigator.userAgent,n=(navigator.appVersion,{iPhone:t.indexOf("iPhone")>-1||t.indexOf("Mac")>-1,iPad:t.indexOf("iPad")>-1,ios:!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:t.indexOf("Android")>-1||t.indexOf("Linux")>-1,webKit:t.indexOf("AppleWebKit")>-1,trident:t.indexOf("Trident")>-1,gecko:t.indexOf("Gecko")>-1&&-1==t.indexOf("KHTML"),presto:t.indexOf("Presto")>-1,mobile:!!t.match(/AppleWebKit.*Mobile.*/)||!!t.match(/AppleWebKit/),webApp:-1==t.indexOf("Safari")});for(var i in n)if(n[i]){e=i;break}return e},isHTML5:function(){return!!document.createElement("video").canPlayType},getType:function(){return this._T_},getVideo:function(){var e="",t=this._E_.v;if(t&&t.length>1)for(var n=0;n<t.length;n++){var i=t[n].split("->");i.length>=1&&""!=i[0]&&(e+='<source src="'+i[0]+'"'),i.length>=2&&""!=i[1]&&(e+=' type="'+i[1]+'"'),e+=">"}return e},getVars:function(e){var t=this._A_;return void 0===t?null:e in t?t[e]:null},getParams:function(){var e="";return this._A_&&(1==parseInt(this.getVars("p"))&&(e+=' autoplay="autoplay"'),1==parseInt(this.getVars("e"))&&(e+=' loop="loop"'),2==parseInt(this.getVars("p"))&&(e+=' preload="metadata"'),this.getVars("i")&&(e+=' poster="'+this.getVars("i")+'"')),e},getpath:function(e){d=e.substr(0,1);if("CDEFGHIJKLMNOPQRSTUVWXYZcdefghijklmnopqrstuvwxyz".indexOf(d)>-1&&(e.substr(0,4)==d+"://"||e.substr(0,4)==d+":\\"))return e;var t=unescape(window.location.href).replace("file:///",""),n=parseInt(document.location.port),i=document.location.protocol+"//"+document.location.hostname,a="",o="",r="",s=0;(f=unescape(e).split("//")).length>0&&(a=f[0]+"//");var c="http|https|ftp|rtsp|mms|ftp|rtmp|file".split("|");80!=n&&n&&(i+=":"+n);for(var l=0;l<c.length;l++)if(c[l]+"://"==a){s=1;break}if(0==s)if("/"==e.substr(0,1))r=i+e;else{o=t.substring(0,t.lastIndexOf("/")+1).replace("\\","/");var d,u=(i=(d=e.replace("../","./")).split("./")).length,f=d.replace("./",""),h=o.split("/"),p=h.length-u;for(l=0;l<p;l++)r+=h[l]+"/";r+=f}else r=e;return r},getXhr:function(){var e;try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){e=!1}}return e||"undefined"==typeof XMLHttpRequest||(e=new XMLHttpRequest),e},getX:function getX(){var f="ckstyle()";this.getVars("x")&&1!=parseInt(this.getVars("c"))&&(f=this.getVars("x")+"()");try{"object"==_typeof(eval(f))&&(this._X_=eval(f))}catch(e){try{"object"==_typeof(eval(ckstyle))&&(this._X_=ckstyle())}catch(e){this._X_=ckstyle()}}},getSn:function(e,t){return t>=0?this._X_[e].split(",")[t]:this._X_[e]},getUrl:function(e,t){var n=this,i=["get","utf-8"];if(e&&2==e.length){var a=e[0],o=e[1].split("/");o.length>=2&&(i[0]=o[1]),o.length>=3&&(i[1]=o[2]),this.ajax(i[0],i[1],a,function(e){if(e&&"error"!=e){var i="",a=e;if(e.indexOf("}")>-1){for(var o=e.split("}"),r=0;r<o.length-1;r++){i+=o[r]+"}";var s=o[r].replace("{","").split("->");2==s.length&&(n._A_[s[0]]=s[1])}a=o[o.length-1]}n._E_.v=a.split(","),t?n.showHtml5():(n.changeParams(i),n.newAdr())}})}},getflashvars:function(e){var t="",n=0;if(e)for(var i in e)n>0&&(t+="&"),"f"==i&&e[i]&&!this.getSn("pm_repc",-1)&&(e[i]=this.getpath(e[i]),e[i].indexOf("&")>-1&&(e[i]=encodeURIComponent(e[i]))),"y"==i&&e[i]&&(e[i]=this.getpath(e[i])),t+=i+"="+e[i],n++;return t},getparam:function(e){var t="",n="",i={allowScriptAccess:"always",allowFullScreen:!0,quality:"high",bgcolor:"#000"};if(e)for(var a in e)i[a]=e[a];for(var o in i)t+=o+'="'+i[o]+'" ',n+='<param name="'+o+'" value="'+i[o]+'" />';return t=t.replace("movie=","src="),{w:t,v:n}},getObjectById:function(e){var t=this;if(t._T_)return t._V_=t._K_(e),t;var n=null,i=t._K_(e);if(i&&"OBJECT"==i.nodeName)if(void 0!==i.SetVariable)n=i;else{var a=i.getElementsByTagName("embed")[0];a&&(n=a)}return n},ajax:function(e,t,n,i){var a=this.getXhr(),o=[],r="";"get"==e?(r=n.indexOf("?")>-1?n+"&t="+(new Date).getTime():n+"?t="+(new Date).getTime(),a.open("get",r)):(n=(o=n.split("?"))[0],r=o[1],a.open("post",n,!0)),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.setRequestHeader("charset",t),"post"==e?a.send(r):a.send(null),a.onreadystatechange=function(){if(4==a.readyState){var e=a.responseText;i(""!=e?e:null)}}},addListener:function addListener(e,f){var o=this._V_;switch(e){case"time":e="timeupdate",this.AT=f,f=this.addListenerTime;break;case"totaltime":return void(this.ATAll=f)}if("string"==typeof f&&(f=eval(f)),o.addEventListener)try{o.addEventListener(e,f,!1)}catch(e){this.getNot()}else if(o.attachEvent)try{o.attachEvent("on"+e,f)}catch(e){this.getNot()}else o["on"+e]=f},removeListener:function removeListener(e,f){var o=this._V_;switch(e){case"time":e="timeupdate",this.AT=null;break;case"totaltime":return void(this.ATAll=null)}if("string"==typeof f&&(f=eval(f)),o.removeEventListener)try{o.removeEventListener(e,f,!1)}catch(e){this.getNot()}else if(o.detachEvent)try{o.detachEvent("on"+e,f)}catch(e){this.getNot()}else o["on"+e]=null},Flash:function(){var e=!1,t=0;if(document.all||this.browser().B.toLowerCase().indexOf("ie")>-1)try{e=!0;var n=(i=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version");t=parseInt(n.split(" ")[1].split(",")[0])}catch(e){}else if(navigator.plugins&&navigator.plugins.length>0){var i=navigator.plugins["Shockwave Flash"];if(i){e=!0;for(var a=i.description.split(" "),o=0;o<a.length;++o)isNaN(parseInt(a[o]))||(t=parseInt(a[o]))}}return{f:e,v:t}},embed:function(e,t,n,i,a,o,r,s,c,l){var d=["all"];o?this.isHTML5()?this.embedHTML5(t,n,i,a,s,r,d,l):this.embedSWF(e,t,n,i,a,r,c):this.Flash().f&&parseInt(this.Flash().v)>10?this.embedSWF(e,t,n,i,a,r,c):this.isHTML5()?this.embedHTML5(t,n,i,a,s,r,d,l):this.embedSWF(e,t,n,i,a,r,c)},embedSWF:function(e,t,n,i,a,o,r){n||(n="ckplayer_a1"),r||(r={bgcolor:"#FFF",allowFullScreen:!0,allowScriptAccess:"always",wmode:"transparent"}),this._A_=o,this.getX();var s="undefined",c=!1,l=document,u="http://www.macromedia.com/go/getflashplayer",f='<a href="'+u+'" target="_blank">flash</a>',h={w:"w3c",f:"flash"+f,v:"flash"+f},p=_typeof(l.getElementById)!=s&&_typeof(l.getElementsByTagName)!=s&&_typeof(l.createElement)!=s,m='id="'+n+'" name="'+n+'" ',v="",g="";r.movie=e,r.flashvars=this.getflashvars(o),-1==i&&(d=!0,this._K_(t).style.width="100%",i="100%"),v+='<object pluginspage="http://www.macromedia.com/go/getflashplayer" ',v+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ',v+='codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=11,3,0,0" ',v+='width="'+i+'" ',v+='height="'+a+'" ',v+=m,v+='align="middle">',v+=this.getparam(r).v,v+="<embed ",v+=this.getparam(r).w,v+=' width="'+i+'" height="'+a+'" name="'+n+'" id="'+n+'" align="middle" '+m,v+='type="application/x-shockwave-flash" pluginspage="'+u+'" />',v+="</object>",p?this.Flash().f?this.Flash().v<11?(g=h.v,c=!0):(g=v,this._T_=!1):(g=h.f,c=!0):(g=h.w,c=!0),g&&(this._K_(t).innerHTML=g),c&&(this._K_(t).style.color="#0066cc",this._K_(t).style.lineHeight=this._K_(t).style.height,this._K_(t).style.textAlign="center")},embedHTML5:function(e,t,n,i,a,o,r,s){this._E_={c:e,p:t,w:n,h:i,v:a,s:r,j:!(void 0!=s&&!s)},this._A_=o,this.getX();var c=this.browser().B,l=this.browser().V,d=c+l,u=c+l.split(".")[0],f="",h=!1,p=this.Flash().f,m=!1;r||(r=["iPad","iPhone","ios"]);for(var v=0;v<r.length;v++){if("all"==(f=r[v]).toLowerCase()){h=!0;break}if("all+false"==f.toLowerCase()&&!p){h=!0;break}if(f.indexOf("+")>-1?(f=f.split("+")[0],m=!0):m=!1,this.Platform()==f||d==f||u==f||c==f){if(!m){h=!0;break}if(!p){h=!0;break}}}if(h){if(a){var g=a[0].split("->");if(g&&2==g.length&&g[1].indexOf("ajax")>-1)return void this.getUrl(g,!0)}this.showHtml5()}},status:function status(){this._H_=parseInt(this.getSn("setup",20));var f="ckplayer_status";""!=this.getSn("calljs",0)&&(f=this.getSn("calljs",0));try{if("function"==typeof eval(f))return this._L_=eval(f),this._M_=!0,!0}catch(e){try{if("function"==typeof eval(ckplayer_status))return this._L_=ckplayer_status,this._M_=!0,!0}catch(e){return!1}}return!1},showHtml5:function showHtml5(){var C=this,p=C._E_.p,a=C._E_.v,c=C._E_.c,j="",b=!1,s=this._E_.v,w=C._E_.w,h=C._E_.h,d=!1,r="";1==s.length&&(r=' src="'+s[0].split("->")[0]+'"'),-1==w&&(d=!0,C._K_(c).style.width="100%",w="100%"),w.toString().indexOf("%")>-1&&(w="100%"),h.toString().indexOf("%")>-1&&(h="100%"),C._E_.j&&(j=' controls="controls"');var v="<video"+j+r+' id="'+p+'" width="'+w+'" height="'+h+'"'+C.getParams()+" webkit-playsinline>"+C.getVideo()+"</video>";if(C._K_(c).innerHTML=v,C._K_(c).style.backgroundColor="#000",C._V_=C._K_(p),d||(C._K_(c).style.width=C._E_.w.toString().indexOf("%")>-1?C._K_(c).offsetWidth*parseInt(C._E_.w)*.01+"px":C._V_.width+"px",C._K_(c).style.height=C._E_.h.toString().indexOf("%")>-1?C._K_(c).offsetHeight*parseInt(C._E_.h)*.01+"px":C._V_.height+"px"),C._P_=!1,C._T_=!0,""!=C.getVars("loaded")){var f=C.getVars("loaded")+"()";try{"function"==typeof eval(f)&&eval(f)}catch(e){try{"function"==typeof eval(loadedHandler)&&loadedHandler()}catch(e){}}}C.status(),C.addListener("play",C.playHandler),C.addListener("pause",C.playHandler),C.addListener("error",C.errorHandler),C.addListener("emptied",C.errorHandler),C.addListener("loadedmetadata",C.loadedMetadataHandler),C.addListener("ended",C.endedHandler),C.addListener("volumechange",C.volumeChangeHandler),(""!=C.getVars("m")&&null!=C.getVars("m")||parseInt(C.getSn("setup",0))>0)&&(C._K_(c).style.cursor="pointer"),(""!=C.getVars("m")&&null!=C.getVars("m")||1==parseInt(C.getSn("setup",1)))&&C.addListener("click",C.html5Click)},addListenerTime:function(){var e=CKobject;e.AT&&e.AT(e._V_.currentTime)},videoPlay:function(){this._T_&&this._V_.play()},videoPause:function(){this._T_&&this._V_.pause()},playOrPause:function(){this._T_&&(this._V_.paused?this._V_.play():this._V_.pause())},fastNext:function(){this._T_&&(this._V_.currentTime=this._V_.currentTime+10)},fastBack:function(){this._T_&&(this._V_.currentTime=this._V_.currentTime-10)},changeVolume:function(e){e<0||e>100||this._T_&&(this._V_.volume=.01*e)},videoSeek:function(e){this._T_&&(this._V_.currentTime=e)},newAddress:function(e){var t=[];if(e&&(t=this.isHtml5New(e))&&this._T_){this.changeParams(e);var n=t[0].split("->");if(n&&2==n.length&&n[1].indexOf("ajax")>-1)return void this.getUrl(n,!1);this._E_.v=t,this.newAdr()}},quitFullScreen:function(){document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()},changeStatus:function(e){this._H_=e},newAdr:function(){var e=this._E_.v;this._V_.pause(),1==e.length?this._V_.src=e[0].split("->")[0]:this._V_.innerHTML=this.getVideo(),this._V_.load()},isHtml5New:function(e){if(-1==e.indexOf("html5"))return!1;for(var t=e.replace(/{/g,"").split("}"),n="",i=0;i<t.length;i++)if(t[i].indexOf("html5")>-1){n=t[i].replace("html5->","").split(",");break}return n},changeParams:function(e){if(e)for(var t=e.replace(/{/g,"").split("}"),n=0;n<t.length;n++){var i=t[n].split("->");if(2==i.length)switch(i[0]){case"p":1==parseInt(i[1])?this._V_.autoplay=!0:2==parseInt(i[1])?this._V_.preload="metadata":(this._V_.autoplay=!1,null!=this._I_&&(clearInterval(this._I_),this._I_=null));break;case"e":1==parseInt(i[1])?this._V_.loop=!0:this._V_.loop=!1;break;case"i":this._V_.poster=i[1]}}},frontAdPause:function(e){this.getNot()},frontAdUnload:function(){this.getNot()},changeFace:function(e){this.getNot()},plugin:function(e,t,n,i,a,o,r){this.getNot()},videoClear:function(){this.getNot()},videoBrightness:function(e){this.getNot()},videoContrast:function(e){this.getNot()},videoSaturation:function(e){this.getNot()},videoSetHue:function(e){this.getNot()},videoWAndH:function(e,t){this.getNot()},videoWHXY:function(e,t,n,i){this.getNot()},changeFlashvars:function(e){this.getNot()},changeMyObject:function(e,t){this.getNot()},getMyObject:function(e,t){this.getNot()},changeeFace:function(){this.getNot()},changeStyle:function(e,t){this.getNot()},promptLoad:function(){this.getNot()},promptUnload:function(){this.getNot()},marqueeLoad:function(e,t){this.getNot()},marqueeClose:function(e){this.getNot()},videoError:function(e){this.getNot()},formatUrl:function(e){this.getNot()},sendJS:function(e){this.getNot()},plugAttribute:function(e){this.getNot()},errorTextShow:function(e){this.getNot()},openUrl:function(e){window.open(e)},jsonParse:function(e){this.getNot()},promptShow:function(e,t,n){this.getNot()},screenShot:function(e,t,n,i,a){this.getNot()},fullScreen:function(){this.getNot()},allowFull:function(){this.getNot()},loadButton:function(){this.getNot()},getFile:function(){this.getNot()},textBoxShow:function(){this.getNot()},loadElement:function(){this.getNot()},textBoxClose:function(){this.getNot()},textBoxTween:function(){this.getNot()},getNot:function(){return"The ckplayer's API for HTML5 does not exist"},volumeChangeHandler:function(){var e=CKobject;e._V_.muted?(e.returnStatus("volumechange:0",1),e._O_.volume=0,e._O_.mute=!0):(e._O_.mute=!1,e._O_.volume=100*e._V_.volume,e.returnStatus("volumechange:"+100*e._V_.volume,1))},endedHandler:function endedHandler(){var C=CKobject,e=parseInt(C.getVars("e"));if(C.returnStatus("ended",1),C._I_&&(clearInterval(C._I_),C._I_=null),0==e||4==e||6==e){6==e&&this.quitFullScreen();var f="playerstop()";""!=C.getSn("calljs",2)&&(f=C.getSn("calljs",2)+"()");try{if("function"==typeof eval(f))return void eval(f)}catch(e){try{if("function"==typeof eval(playerstop))return void playerstop()}catch(e){return}}}},loadedMetadataHandler:function(){var e=CKobject;e.returnStatus("loadedmetadata",1),e._O_.totalTime=e._V_.duration,e._O_.width=e._V_.width,e._O_.height=e._V_.height,e._O_.awidth=e._V_.videoWidth,e._O_.aheight=e._V_.videoHeight,e._V_.defaultMuted?(e.returnStatus("volumechange:0",1),e._O_.mute=!0,e._O_.volume=0):(e._O_.mute=!1,e._O_.volume=100*e._V_.volume,e.returnStatus("volumechange:"+100*e._V_.volume,1)),1==parseInt(e.getVars("p"))&&e.playHandler(),e.ATAll&&e.ATAll(e._V_.duration)},errorHandler:function(){CKobject.returnStatus("error",1)},playHandler:function(){var e=CKobject;if(e._V_.paused)e.returnStatus("pause",1),e.addO("play",!1),null!=e._I_&&(clearInterval(e._I_),e._I_=null);else{if(e.returnStatus("play",1),e.addO("play",!0),e._P_||(e.returnStatus("play",1),e._P_=!0),e._I_=setInterval(e.playTime,parseInt(e.getSn("setup",37))),!e._G_){e._G_=!0;for(var t in e._A_)if("g"==t&&e._A_[t]){var n=parseInt(e._A_[t]);e.videoSeek(n)}}if(!e._Y_){e._Y_=!0;for(var t in e._A_)if("j"==t&&e._A_[t]){var i=parseInt(e._A_[t]);e._J_=i>0?i:parseInt(e._O_.totalTime)+i}}}},html5Click:function(){var e=CKobject;""!=e.getVars("m")&&null!=e.getVars("m")&&window.open(e.getVars("m"))},returnStatus:function(e,t){var n=e;3==this._H_&&(n=this._E_.p+"->"+n),this._M_&&t<=this._H_&&this._L_(n)},addO:function(e,t){this._O_[e]=t},getStatus:function(){return this._O_},playTime:function(){var e=CKobject,t=e._V_.currentTime;e._O_.time=t,e._J_>0&&t>e._J_&&(e._J_=0,e.videoSeek(e._O_.totaltime)),e.returnStatus("time:"+t,1)}};exports['default']=CKobject},function(e,t,n){"use strict";function i(e,t){for(var n=0,i=e.length-1;i>=0;i--){var a=e[i];"."===a?e.splice(i,1):".."===a?(e.splice(i,1),n++):n&&(e.splice(i,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function a(e,t){if(e.filter)return e.filter(t);for(var n=[],i=0;i<e.length;i++)t(e[i],i,e)&&n.push(e[i]);return n}var o=n(112),r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(e){return r.exec(e).slice(1)};t.resolve=function(){for(var e="",t=!1,n=arguments.length-1;n>=-1&&!t;n--){var r=n>=0?arguments[n]:o.process.cwd();if("string"!=typeof r)throw new TypeError("Arguments to path.resolve must be strings");r&&(e=r+"/"+e,t="/"===r.charAt(0))}return e=i(a(e.split("/"),function(e){return!!e}),!t).join("/"),(t?"/":"")+e||"."},t.normalize=function(e){var n=t.isAbsolute(e),o="/"===c(e,-1);return(e=i(a(e.split("/"),function(e){return!!e}),!n).join("/"))||n||(e="."),e&&o&&(e+="/"),(n?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(a(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,n){function i(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var a=i(e.split("/")),o=i(n.split("/")),r=Math.min(a.length,o.length),s=r,c=0;c<r;c++)if(a[c]!==o[c]){s=c;break}for(var l=[],c=s;c<a.length;c++)l.push("..");return(l=l.concat(o.slice(s))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=s(e),n=t[0],i=t[1];return n||i?(i&&(i=i.substr(0,i.length-1)),n+i):"."},t.basename=function(e,t){var n=s(e)[2];return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){return s(e)[3]};var c="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}},function(e,t,n){"use strict";function i(){}var a=e.exports={},o=[],r=!1;a.nextTick=function(e){o.push(e),r||setTimeout(function(){if(!r){r=!0;for(var e,t=o.length;t;){e=o,o=[];for(var n=-1;++n<t;)e[n]();t=o.length}r=!1}},0)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=i,a.addListener=i,a.once=i,a.off=i,a.removeListener=i,a.removeAllListeners=i,a.emit=i,a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(e,t,n){"use strict";var i=/[|\\{}()[\]^$+*?.]/g;t.escapeRegExpChars=function(e){return e?String(e).replace(i,"\\$&"):""};t.escapeXML=new Function("markup","\n    return markup == undefined\n    ? ''\n    : String(markup).replace(_MATCH_HTML, encode_char);\n"),t.escapeXML.toString=function(){return Function.prototype.toString.call(this)+';\nvar _ENCODE_HTML_RULES = {\n      "&": "&amp;"\n    , "<": "&lt;"\n    , ">": "&gt;"\n    , \'"\': "&#34;"\n    , "\'": "&#39;"\n    }\n  , _MATCH_HTML = /[&<>\'"]/g;\nfunction encode_char(c) {\n  return _ENCODE_HTML_RULES[c] || c;\n};\n'},t.shallowCopy=function(e,t){t=t||{};for(var n in t)e[n]=t[n];return e},t.cache={_data:{},set:function(e,t){this._data[e]=t},get:function(e){return this._data[e]},reset:function(){this._data={}}}},function(e,t,n){"use strict";e.exports={name:"ejs",description:"Embedded JavaScript templates",keywords:["template","engine","ejs"],version:"2.5.2",author:"Matthew Eernisse <mde@fleegix.org> (http://fleegix.org)",contributors:["Timothy Gu <timothygu99@gmail.com> (https://timothygu.github.io)"],license:"Apache-2.0",main:"./lib/ejs.js",repository:{type:"git",url:"git://github.com/mde/ejs.git"},bugs:"https://github.com/mde/ejs/issues",homepage:"https://github.com/mde/ejs",dependencies:{},devDependencies:{browserify:"^13.0.1",eslint:"^3.0.0",istanbul:"~0.4.3",jake:"^8.0.0",jsdoc:"^3.4.0","lru-cache":"^4.0.1",mocha:"^3.0.2",rimraf:"^2.2.8","uglify-js":"^2.6.2"},engines:{node:">=0.10.0"},scripts:{test:"mocha",coverage:"istanbul cover node_modules/mocha/bin/_mocha",doc:"rimraf out && jsdoc -c jsdoc.json lib/* docs/jsdoc/*",devdoc:"rimraf out && jsdoc -p -c jsdoc.json lib/* docs/jsdoc/*"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.record=function(e,t){return}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.config={dataKey:"",getterName:"__getDialogData__",okCallbackName:"__dialogOkCallback__",cancelCallbackName:"__dialogCancelCallback__"}},function(e,t,n){"use strict";function i(e){var t=e.offset()||{left:0,top:0},n=e.width()||0,i=e.height()||0;return{left:t.left,right:t.left+n,top:t.top,bottom:t.top+i,width:n,height:i}}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=(self,$(window)),r=$("body"),s=[],c=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=$(t),this.fixed=!1,this.inited=!1,this.disabled=!1,this.range=null,this.$element=t,this.$target=t.children(":first-child"),this.originPosition=this._getOriginRectInfo(),this.originStyle={position:this.$target.css("position"),left:this.$target.css("left"),top:this.$target.css("top")},this.rangeRef=Object.assign({left:t,right:t,top:t,bottom:t},n.range),this.ctx=n.ctx||r,this.offset=n.offset||{},this.rangeOffset=n.rangeOffset||{},void 0===this.offset.left&&(this.offset.left=this.originPosition.left-i(this.rangeRef.left).left),this.offset=Object.assign({left:0,right:0,top:0,bottom:0},this.offset),this.rangeOffset=Object.assign({left:0,right:0,top:0,bottom:0},this.rangeOffset),t.is(":visible")&&this.position()}return a(e,[{key:"_getOriginRectInfo",value:function(){var e=this.$element.offset()||{left:0,top:0},t=this.$target.width()||0,n=this.$target.height()||0;return{left:e.left,right:e.left+t,top:e.top,bottom:e.top+n,width:t,height:n}}},{key:"_updateOriginPosition",value:function(){this.originPosition=this._getOriginRectInfo()}},{key:"_updateRange",value:function(){var e=this,t={};return["left","right","top","bottom"].forEach(function(n){t[n]=i(e.rangeRef[n])[n]+e.rangeOffset[n]}),this.range=t,t}},{key:"_update",value:function(){this._updateOriginPosition(),this._updateRange(),this.inited=!0}},{key:"update",value:function(){this.disabled||(this._update(),this.position())}},{key:"position",value:function(e,t){!1===this.inited&&this._update(),e=void 0===e?o.scrollTop():e,t=void 0===t?o.scrollLeft():t;var n=this.originPosition,i=this.range,a=this.offset.top;(e+=a)>i.top&&e<=i.bottom?this.$target.css({position:"fixed",left:i.left+this.offset.left-t,top:Math.min(a,i.bottom-(e-a+n.height))}).addClass("fixed"):this.fixed||(this.fixed=!1,this.$target.css(this.originStyle).removeClass("fixed"))}},{key:"disable",value:function(){this.disabled=!0}},{key:"enable",value:function(){this.disabled=!1}}]),e}(),l=void 0,d=void 0;o.on("resize",function(e,t){"FIXER"!==t&&(clearTimeout(l),l=setTimeout(function(){s.forEach(function(e){e.update()})},150))}).on("scroll",function(e,t){"FIXER"!==t&&(clearTimeout(d),d=setTimeout(function(){var e=o.scrollTop(),t=o.scrollLeft();s.forEach(function(n){n.position(e,t)})},10))}),t.createFixer=function(e,t){var n=new c(e,t);return s.push(n),n},t.updateFixer=function(e){e&&e instanceof c?e.update():s.forEach(function(e){e.update()})}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function i(e){return String(e).replace(/\-/g,"/")}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;e=String(e);for(var n=Math.max(t-e.length,0);n>0;n--)e="0"+e;return e}function o(e){return[e.getFullYear(),a(e.getMonth()+1),a(e.getDate())].join(d)}function r(e){return"string"==typeof e?new Date(i(e)):e}function s(){return{1:"A",2:"D"}[(0,l.getStore)().getState("adType")]}function c(){return 2===(0,l.getStore)().getState("brandId")}Object.defineProperty(t,"__esModule",{value:!0}),t.isNeedReception=t.isNiuZhuan=t.getProductStockType=t.checkEmail=t.getDeltaDate=t.getNextDate=t.formateDate=t.getWeek=t.getNowDate=t.getYMDDate=t.getYMDate=t.justifyNumber=t.justifyDate=t.str2Date=void 0;var l=n(1),d="-",u=["","","","","","",""],f=[{unit:1e3,property:"millsecond"},{unit:60,property:"second"},{unit:60,property:"minute"},{unit:24,property:"hour"},{unit:1,property:"day"}];t.str2Date=r,t.justifyDate=i,t.justifyNumber=a,t.getYMDate=function(e){return"string"==typeof e&&(e=new Date(i(e))),[e.getFullYear(),a(e.getMonth()+1)].join(d)},t.getYMDDate=o,t.getNowDate=function(){return o(new Date)},t.getWeek=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"string"==typeof e&&(e=new Date(i(e))),t+u[e.getDay()]},t.formateDate=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD";return"string"==typeof e&&(e=new Date(i(e))),t.replace(/YYYY/g,e.getFullYear()).replace(/MM/g,a(e.getMonth()+1)).replace(/DD/g,a(e.getDate()))},t.getNextDate=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return"string"==typeof e&&(e=new Date(i(e))),e.setDate(e.getDate()+t-1),o(e)},t.getDeltaDate=function(e,t){var n={};return e=r(e),t=r(t),f.reduce(function(e,t){return n[t.property]=e%t.unit,parseInt(e/t.unit,10)},e-t||0),n},t.checkEmail=function(e){return/(?=^.{5,255}$)(^([\w\!\#\$\%\&\'\*\+\-\.\/\?\^\_\`\{\|\}\~]+)@([a-zA-Z0-9\-]+\.)+([a-zA-Z0-9\-]+)$)/.test(String(e))},t.getProductStockType=s,t.isNiuZhuan=c,t.isNeedReception=function(){return"D"===s()||"A"===s()&&c()}},,,,function(e,t,n){"use strict";function i(e){return String(e).replace(/\-/g,"/")}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;e=String(e);for(var n=Math.max(t-e.length,0);n>0;n--)e="0"+e;return e}function o(e){return[e.getFullYear(),a(e.getMonth()+1),a(e.getDate())].join(s)}function r(e){return"string"==typeof e?new Date(i(e)):e}Object.defineProperty(t,"__esModule",{value:!0});var s="-",c=["","","","","","",""],l=[{unit:1e3,property:"millsecond"},{unit:60,property:"second"},{unit:60,property:"minute"},{unit:24,property:"hour"},{unit:1,property:"day"}];t.str2Date=r,t.justifyDate=i,t.justifyNumber=a,t.getYMDate=function(e){return"string"==typeof e&&(e=new Date(i(e))),[e.getFullYear(),a(e.getMonth()+1)].join(s)},t.getYMDDate=o,t.getNowDate=function(){return o(new Date)},t.getWeek=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return"string"==typeof e&&(e=new Date(i(e))),t+c[e.getDay()]},t.formateDate=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD";return"string"==typeof e&&(e=new Date(i(e))),t.replace(/YYYY/g,e.getFullYear()).replace(/MM/g,a(e.getMonth()+1)).replace(/DD/g,a(e.getDate()))},t.getNextDate=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return"string"==typeof e&&(e=new Date(i(e))),e.setDate(e.getDate()+t-1),o(e)},t.getDeltaDate=function(e,t){var n={};return e=r(e),t=r(t),l.reduce(function(e,t){if("day"!=t.property)return n[t.property]=e%t.unit,parseInt(e/t.unit,10);n[t.property]=e},e-t||0),n},t.checkEmail=function(e){return/(?=^.{5,255}$)(^([\w\!\#\$\%\&\'\*\+\-\.\/\?\^\_\`\{\|\}\~]+)@([a-zA-Z0-9\-]+\.)+([a-zA-Z0-9\-]+)$)/.test(String(e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.resourceStatus={loading:1,loaded:4,saleout:2,normal:3},t.requestStatus={abort:"abort"},t.orderTip={error:""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HotelDetail=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),o=(n(1),n(19)),r=n(10),s=n(73),c=n(168),l=n(48),d=a.compile(c.detailTemplate,{client:!0,compileDebug:!1});t.HotelDetail=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);this.params=this.getParams(t),this.chineseName="",this.startX=0,this.startY=0,this.mapLoaded=!1,this.flag=t.flag||0,this.data=t.data,!1!==t.openOnInit&&this.show()}return i(e,[{key:"getParams",value:function(e){var t={};return["hotelId","nationType","hotelType","ifNewStockHotel"].reduce(function(t,n){return t[n]=e[n],t},t),t}},{key:"fetchDetail",value:function(){var e=this,t=this;return new Promise(function(e,n){$.ajax({type:"GET",url:o.config.url.hotelDetail(),data:{d:JSON.stringify(t.params)},dataType:"json",success:function(t){t&&t.success&&t.data?e(t.data):n("")},error:function(){n("")}})}).then(function(t){return e.data=t,t})}},{key:"getDetail",value:function(){var e=this;return new Promise(function(t,n){e.data?t(e.data):n("No initial data")}).then(function(e){return e},function(t){return e.fetchDetail()})}},{key:"showDetail",value:function(e){r.layer.open({type:1,shadeClose:!0,title:!1,shade:.6,area:["950px","523px"],content:e})}},{key:"show",value:function(){var e=this;this.getDetail().then(function(t){var n=d({data:t,cdn:cdnConfig||{},flag:e.flag||0,helper:l.helper});e.chineseName=t.chineseName,e.startX=t.longitude,e.startY=t.latitude,e.showDetail(n),e.bindEvent(),e.initGallery()})['catch'](function(e){})}},{key:"initGallery",value:function(){new s.Gallery("#J_Gallery-hotel")}},{key:"initMap",value:function(){var e=this;$("#mapStyle").size()||$("head").append('<link id="mapStyle" rel="stylesheet" href="http://api.map.baidu.com/res/11/bmap.css"/>'),$.getScript("http://api.map.baidu.com/getscript?v=1.1&ak=&services=true&t=20130716024058",function(){window.BMap_loadScriptTime=(new Date).getTime(),e.showMap()})}},{key:"bindEvent",value:function(){var e=this;$("#hotel-detail-nav").on("click","li",function(){if(!$(this).hasClass("on")){var t=$(this).index(),n=$(".detail-hotel-scroll").children();$(this).addClass("on").siblings().removeClass("on"),n.eq(t).show().siblings().hide(),"showMap"!==$(this).attr("id")||e.mapLoaded||(e.initMap(),e.mapLoaded=!0)}}),this.flag&&$("#showMap").trigger("click")}},{key:"showMap",value:function(){$("#newMapShow").show(),this.startMap()}},{key:"startMap",value:function(){this.initMaps(this.startX,this.startY)}},{key:"initMaps",value:function(e,t){this.createMap(e,t),this.setMapEvent(),this.addMapControl()}},{key:"createMap",value:function(e,t){var n=new BMap.Map("newMapShow"),i=new BMap.Point(e,t);n.centerAndZoom(i,14);var a=new BMap.Marker(i);n.addOverlay(a);var o=new BMap.InfoWindow('<p style="font-size:14px;font-weight: bolder;">'+this.chineseName+"</p>","");a.openInfoWindow(o),window.map=n,a.addEventListener("click",function(e){this.openInfoWindow(o)})}},{key:"setMapEvent",value:function(){map.enableDragging(),map.enableScrollWheelZoom(),map.enableDoubleClickZoom(),map.enableKeyboard()}},{key:"addMapControl",value:function(){var e=new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,type:BMAP_NAVIGATION_CONTROL_LARGE});map.addControl(e);var t=new BMap.OverviewMapControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT,isOpen:1});map.addControl(t);var n=new BMap.ScaleControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT});map.addControl(n)}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=[],o=$("body"),r=$(window),s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=$(t),this.disabled=!1,this.options=Object.assign({selectFirst:!0,ctx:o},n);var i=this.options.ctx;this.$element=t,this.tabs=t.find("[data-rel]").toArray().map(function(e){return e=$(e),{$tab:e,$target:i.find(e.data("rel"))}}).filter(function(e){return e.$target.length}),this.options.selectFirst&&this.active(this.tabs[0]),this.bind()}return i(e,[{key:"bind",value:function(){var e=this;this.tabs.forEach(function(t){t.$tab.click(function(){t.active||this.active(t)}.bind(e))})}},{key:"active",value:function(e){e&&(this.tabs.forEach(function(t){e===t?(t.$tab.addClass("active"),t.$target.addClass("active"),t.active=!0):(t.$tab.removeClass("active"),t.$target.removeClass("active"),t.active=!1)}),$.isFunction(this.options.onactive)&&this.options.onactive(e),r.trigger("resize"))}}]),e}();t.createTaber=function(e,t){var n=new s(e,t);return a.push(n),n}},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createTip=t.Tip=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(10),o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=(new Date).getTime()+""+Math.random(),this.$target=t,this.options=Object.assign({delay:100,type:"hover"},n),this.dialogOptions=Object.assign({type:4,tips:3,shift:0,shade:!1,fix:!1,closeBtn:!1,skin:"layui-layer-rim",area:["300px","auto"],tipsOffset:[10,-27]},this.options.dialog),this.dialogOptions.content=[this.getContent(),this.$target],this.options.delay&&this.options.hoverIncludeTip&&(this.dialogOptions.success=function(e){var t=this;e.hover(function(){clearTimeout(t.timer)},this.close.bind(this))}.bind(this)),"click"===this.options.type&&(this.dialogOptions.success=function(e){e.click(function(e){e.stopPropagation()})}),this.dialog=null,this.timer=null,this.visible=!1,this.bind()}return i(e,[{key:"bind",value:function(){switch(this.options.type){case"click":this.$target.click(this.toggle.bind(this)).click(function(e){$(document).trigger("customclick",this._id),e.stopPropagation()}.bind(this)),$(document).click(this.close.bind(this)).on("customclick",function(e,t){t!==this._id&&this.close()}.bind(this));break;case"hover":default:this.$target.hover(this.open.bind(this),this.close.bind(this))}}},{key:"getContent",value:function(){return"function"==typeof this.options.content?this.options.content():this.options.content}},{key:"toggle",value:function(){this.visible?this.close():this.open()}},{key:"open",value:function(){var e=this;$.isFunction(this.options.width)&&(this.dialogOptions.area[0]=this.options.width()+"px"),this.options.delay&&"click"!==this.options.type?(clearTimeout(this.timer),this.timer=setTimeout(function(){e.visible||(e.dialog=a.layer.open(e.dialogOptions),e.visible=!0)},this.options.delay)):(this.dialog=a.layer.open(this.dialogOptions),this.$target.addClass("expand"),this.visible=!0)}},{key:"close",value:function(){var e=this;this.options.delay&&this.options.hoverIncludeTip?(clearTimeout(this.timer),this.timer=setTimeout(function(){a.layer.close(e.dialog),e.visible=!1},this.options.delay)):(a.layer.close(this.dialog),this.$target.removeClass("expand"),clearTimeout(this.timer),this.visible=!1)}}]),e}();t.Tip=o,t.createTip=function(){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a={str2Date:function(e){if(e)switch(void 0===e?"undefined":i(e)){case"string":return new Date(e.replace(/\-/g,"/"));case"number":return new Date(e);case"object":return e}},justifyNum:function(e,t){for(t=t||2,e=parseInt(e)+"";e.length<t;)e="0"+e;return e},date2Str:function(e){return e.getFullYear()+"-"+a.justifyNum(e.getMonth()+1)+"-"+a.justifyNum(e.getDate())},getDeltaDate:function(e,t){return 0===(t=void 0===t?1:t)?a.str2Date(e):((e=a.str2Date(e)).setDate(e.getDate()+t),e)},getDeltaDateStr:function(e,t){return a.date2Str(a.getDeltaDate(e,t))},getDeltaMonth:function(e,t){return 0===(t=void 0===t?1:t)?a.str2Date(e):((e=a.str2Date(e)).setMonth(e.getMonth()+t),e)},getDeltaMonthStr:function(e,t){return a.date2Str(a.getDeltaMonth(e,t))},getMDDateStr:function(e){return(e="string"==typeof e?a.str2Date(e):e)?a.justifyNum(e.getMonth()+1)+"-"+a.justifyNum(e.getDate()):void 0},getWeekDay:function(e,t){return t=t||"","string"==typeof e&&(e=a.str2Date(e)),t+["","","","","","",""][e.getDay()]},getDeltaDays:function(e,t){return"string"==typeof e&&(e=a.str2Date(e)),"string"==typeof t&&(t=a.str2Date(t)),Math.floor((t-e)/864e5)},compareTime:function(e,t){var n=/^\s*(\d+)\s*:\s*(\d+)\s*$/,i=n.exec(e),a=n.exec(t);return i&&a?+i[2]+60*i[1]-(+a[2]+60*a[1]):NaN}};t.Tool=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.flight=void 0;var i=n(1),a=n(19),o=void 0,r=void 0,s=void 0,c=void 0;t.flight={fetchDefaultFlightP:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,i.getStore)(),n={journeyId:t.getState("journeyId")||"",productId:t.getState("productId"),departDate:t.getState("departDate"),departCityCode:t.getState("departCityCode"),backCityCode:t.getState("backCityCode"),bookCityCode:t.getState("bookCityCode"),adultNum:null!=e.adultNum?e.adultNum:t.getState("adult"),childNum:null!=e.childNum?e.childNum:t.getState("child"),freeChildNum:t.getState("freeChild")};return new Promise(function(e,t){s&&s.abort(),s=$.ajax({url:a.config.url.flight(),data:n,dataType:"json",success:function(n){n&&n.success&&n.data?e(n.data):t(null)},error:function(){t(null)}})})['catch'](function(e){return null})},checkFlightP:function(e){return(0,i.getStore)().subscribe(function(){c&&c.abort()},"change:departDate"),new Promise(function(t,n){c&&c.abort(),c=$.ajax({type:"POST",url:a.config.url.checkFlight(),data:{d:JSON.stringify(e)},dataType:"json",success:function(e){e&&e.success&&e.data&&e.data.checkStatus?t(e.data):n(null)},error:function(){n(null)}})})['catch'](function(e){return null})},getFlightIsInternationalP:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,i.getStore)(),n={productId:t.getState("productId"),adultNum:null!=e.adultNum?e.adultNum:t.getState("adult"),childNum:null!=e.childNum?e.childNum:t.getState("child"),freeChildNum:t.getState("freeChild"),departDate:t.getState("departDate"),bookCityCode:t.getState("bookCityCode"),departCityCode:t.getState("departCityCode"),backCityCode:t.getState("backCityCode"),journeyId:t.getState("journeyId")||""};return new Promise(function(e,t){o&&r.abort(),o=$.ajax({url:a.config.url.flightIsInternational(),data:n,dataType:"json",success:function(n){n&&n.success&&n.data?e(n.data):t(null)},error:function(){t(null)}})})['catch'](function(e){return null})},fetchProductDefaultFlightP:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,i.getStore)(),n={productId:t.getState("productId"),adultNum:null!=e.adultNum?e.adultNum:t.getState("adult"),childNum:null!=e.childNum?e.childNum:t.getState("child"),freeChildNum:t.getState("freeChild"),departDate:t.getState("departDate"),bookCityCode:t.getState("bookCityCode"),departCityCode:t.getState("departCityCode"),backCityCode:t.getState("backCityCode"),journeyId:t.getState("journeyId")||""};return new Promise(function(e,t){r&&r.abort(),r=$.ajax({url:a.config.url.defaultFlight(),data:n,dataType:"json",success:function(n){n&&n.success&&n.data?e(n.data):t(null)},error:function(){t(null)}})})['catch'](function(e){return null})}}},function(e,t,n){"use strict";function i(e){(0,a.getStore)().dispatch({type:o.SET_ORIGINALFLIGHT_DATA,data:e});var t=(0,a.getStore)().getState("adult"),n=(0,a.getStore)().getState("child"),i={},r=[],s=[],c=[],l=[],d=e.firstJourney&&Array.isArray(e.firstJourney)&&e.firstJourney[0]&&e.firstJourney[0].list&&e.firstJourney[0].list[0];c.push(d);for(var u in e.sequenceMap)u==d&&e.sequenceMap[u]&&e.sequenceMap[u].next&&(c.push(e.sequenceMap[u].next[0]),d=d+"_"+e.sequenceMap[u].next[0]);var f=e.fareMap&&e.fareMap[d];c&&c.forEach(function(t,n){var a=t.match(/(.*)#/)?t.match(/(.*)#/)[1]:null;l.push(e.flightOptionMap[a]),e.flightOptionMap[a].flightList.forEach(function(t,o){var r=e.flightDetailMap[t]||{},c={flightDate:r.flightDate,airlineName:r.airlineName,airplaneTypeName:r.airplaneTypeName,flightNo:r.flightNo,departureCityName:r.departureCityName,destinationCityName:r.destinationCityName,departureAirportName:r.departureAirportName,destinationAirportName:r.destinationAirportName,departTime:r.departTime,arriveTime:r.arriveTime,arriveDate:r.arriveDate,arriveDay:r.arriveDay,stopNum:r.stopNum,stopPointList:r.stopPointList,duration:r.duration,dTerminal:r.dTerminal,aTerminal:r.aTerminal,dCityIataCode:r.dCityIataCode,aCityIataCode:r.aCityIataCode,dAirportIataCode:r.dAirportIataCode,aAirportIataCode:r.aAirportIataCode,dCityCode:r.dCityCode,aCityCode:r.aCityCode,isShareFlight:r.isShareFlight,shareFlightNo:r.shareFlightNo,shareAirlineName:r.shareAirlineName,onTimeRate:+r.onTimeRate,hasMeal:r.hasMeal,cabinClass:i.cabinClass,seatType:i.seatTypeName,seatStatus:i.seatStatus,seatTypeCode:i.seatTypeCode,transferTips:e.flightOptionMap[a].transferTips&&e.flightOptionMap[a].transferTips[o],trainsitTime:e.flightOptionMap[a].trainsitTimes&&e.flightOptionMap[a].trainsitTimes[o],visaTips:e.flightOptionMap[a].visaTips&&e.flightOptionMap[a].visaTips[o],journeyNum:n,additionals:f.additionals};s.push(c)})}),r.push({resId:f.resId,adultPrice:f.adultPrice,childPrice:f.childPrice,flightTicketInfo:s,price:f.adultPrice*t+f.childPrice*n});var h={journeyCount:e.journeyCount,journeyList:l,airplaneBasePrice:{adultPrice:f.adultPrice,childPrice:f.childPrice}};return(0,a.getStore)().dispatch({type:o.SET_FLIGHT_TO_LIST_DATA,data:h}),r}Object.defineProperty(t,"__esModule",{value:!0}),t.flight=void 0;var a=n(1),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(58));t.flight={formatFlightData:function(e){if(!(e=e||{}).lackResFlag&&e.showTicketList){var t=1==e.showTicketList.length&&2==e.showTicketList[0]?2:1,n=[],i={showTicketList:e.showTicketList,canReplaceTicket:e.canReplaceTicket,selectedTicketList:t};return 1==t&&e.pkgTicketBySeq&&e.pkgTicketBySeq.forEach(function(e){e.data=(e.pkgTicketList||[])[0],e.selectedTicketList=1,n.push(e)}),2==t&&e.singleTicketList&&n.push(Object.assign({data:e.singleTicketList.map(function(e){return e.singleTicketList}),selectedTicketList:2},(e.pkgTicketBySeq||[])[0])),n.sort(function(e,t){return e.seqNum-t.seqNum}),{type:"flight",data:i,children:n.map(function(t){return{type:"flightTicket",data:Object.assign({showTicketList:e.showTicketList,canReplaceTicket:e.canReplaceTicket},t)}})}}},formatProductFlightData:function(e){var t=i(e);return{type:"flight",data:{},children:[{type:"flightTicket",data:{data:t[0],pkgTicketList:t}}]}},getFlightList:i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailTemplate='\n    <div class="ad-gallery">\n        <ul id="hotel-detail-nav" class="clearfix">\n            <li class="on"></li>\n            <% if(data.detail || (data.pois && data.pois.length)){ %>\n            <li class="service"></li>\n            <% } %>\n            <% if(!data.isInternational) {%>\n                <li class="map" id="showMap"></li>\n            <%}%>\n        </ul>\n        <div class="detail-hotel-scroll">\n            <div class="scoll_item clearfix showmessage">\n                <% if (data.pictures && data.pictures.length) { %>\n                    <div class="gallery" id="J_Gallery-hotel">\n                        <div class="gallery-display">\n                            <ul class="gallery-display-box">\n                                <% data.pictures.forEach(function(media, index) { %>\n                                    <li class="gallery-photo<% if (index === 0) { %> gallery-photo-active<% } %>" data-src="helper.resizeImage(media.path, 450, 300, 1)%>">\n                                        <img src="<%= helper.resizeImage(media.path, 450, 300, 1)%>">\n                                    </li>\n                                <% }) %>\n                            </ul>\n                        </div>\n                        <div class="gallery-nav">\n                            <div class="gallery-prev"><i class="icon"></i></div>\n                            <div class="gallery-next"><i class="icon"></i></div>\n                            <div class="gallery-thumbs">\n                                <div class="gallery-mask"></div>\n                                <div class="gallery-nav-box">\n                                    <ul class="gallery-nav-list">\n                                        <% data.pictures.forEach(function(media, index) { %>\n                                            <li class="gallery-thumb">\n                                                <img src="<%= helper.resizeImage(media.path, 71, 52, 1)%>">\n                                            </li>\n                                        <% }) %>\n                                    </ul>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                <% } else { %>\n                    <div class="gallery">\n                        <div class="gallery-display">\n                            <ul class="gallery-display-box">\n                                <li class="gallery-photo gallery-photo-active">\n                                    <img src="<%= cdn.url %>/static/img/2016/modules/tour/default-picture.jpg">\n                                </li>\n                            </ul>\n                        </div>\n                        <div class="gallery-nav">\n                            <div class="gallery-prev disabled"><i class="icon"></i></div>\n                            <div class="gallery-next disabled"><i class="icon"></i></div>\n                            <div class="gallery-thumbs">\n                                <div class="gallery-nav-box">\n                                    <ul class="gallery-nav-list">\n                                        <li class="gallery-thumb"><img src="<%= cdn.url %>/static/img/2016/modules/tour/default-picture-thumb.jpg"></li>\n                                    </ul>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                <% } %>\n                <div class="message">\n                    <h1><%=data.chineseName%> </h1>\n                    <%if(data.englishName && data.englishName != \'\') {%><p><%=data.englishName%><p><%}%>\n                    <%if(data.address && data.address != \'\') {%><p><%=data.address%><p><%}%>\n                    <%if(data.languages && data.languages != \'\') {%><p><%=data.languages%><p><%}%>\n                    <%if(data.localName && data.localName != \'\') {%><p><%=data.localName%><p><%}%>\n                    <%if(data.localAddress && data.localAddress != \'\') {%><p><%=data.localAddress%><p><%}%>\n                    <%if(data.roomNumber && data.roomNumber != \'\') {%><p><%=data.roomNumber%><p><%}%>\n                    <%if(data.debutYear && data.debutYear != \'\') {%><p><%=data.debutYear%><p><%}%>\n                    <%if(data.decorateYear && data.decorateYear != \'\') {%><p><%=data.decorateYear%><p><%}%>\n                    <%if(data.businessDistricts && data.businessDistricts.length > 0) {%><p><%= data.businessDistricts.map(function(item){ return item.districtName }).join(\'\') %></p><%}%>\n                </div>\n            </div>\n            <% if(data.detail || (data.pois && data.pois.length)){ %>\n            <div class="scoll_item clearfix serviceShow" id="serviceShow" style="display:none;">\n                <div class="serviceMsg">\n                    <% if(data.detail){ %>\n                    <h1></h1>\n                    <p><%= data.detail  %></p>\n                    <% } %>\n                    <% if(data.facilitiesNew && data.facilitiesNew.length){ %>\n                    <h1></h1>\n                    <p><%= data.facilitiesNew.map(function(item){ return item.name}).join(\'\') %></p>\n                    <% } %>\n                    <% if(data.tel || data.mobile || data.fax || data.url || data.email){ %>\n                    <h1></h1>\n                    <% if(data.tel){ %><p> <%= data.tel %></p><% } %>\n                    <% if(data.mobile){ %><p> <%= data.mobile %></p><% } %>\n                    <% if(data.fax){ %><p> <%= data.fax %></p><% } %>\n                    <% if(data.url){ %><p> <%= data.url %></p><% } %>\n                    <% if(data.email){ %><p> <%= data.email %></p><% } %>\n                    <% } %>\n                    <% if(data.acceptCreditCard){ %>\n                    <h1></h1>\n                    <p><%= data.acceptCreditCard %></p>\n                    <% } %>\n                    <% if(data.policy && data.policy.length){ %>\n                    <h1></h1>\n                    <% data.policy.forEach(function(item){ %>\n                    <p><%= item %></p>\n                    <% }) %>\n                    <% }  %>\n                    <% if(data.features){ %>\n                    <h1></h1>\n                    <p><%= data.features %></p>\n                    <% } %>\n                    <% if(data.tips && data.tips.length){ %>\n                    <h1></h1>\n                    <% data.tips.forEach(function(item){ %>\n                    <p><%= item %></p>\n                    <% }) %>\n                    <% }  %>\n                    <% var subPois = data.pois && data.pois.length ? data.pois[0].subPois : [];  %>\n                    <% if(subPois && subPois.length){ %>\n                    <h1></h1>\n                    <% subPois.forEach(function(item){ %>\n                        <p><%= item.subName %>\n                        <% if(item.distance) { %>\n                            <%= item.distance  %>\n                        <% }  %>\n                        </p>\n                        <% }) %>\n                    <% } %>\n                </div>\n            </div>\n            <% } %>\n            <div id="newMapShow" style="height:368px;text-align: center;display:none;">\n                <input type="hidden" id="mapShowTimes" value="0" />\n            </div>\n\n        </div>\n    </div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.roomTemplate='\n<%\n    var formatBreakfast = function(i){\n        var arr = [\'\',\'\',\'\',\'\',\'\',\'\',\'\',\'\',\'\',\'\']\n        return arr[i];\n    }\n%>\n    <div class="hotel-roomPlan <%if(!room.beShow){%>hotel-roomPlan-hide hide<%}%>">\n        <div class="res-rooms-list hotel-roomId" data-resId="<%= room.roomId%>" data-roomId="<%= room.roomId%>">\n            <span class="res-rooms-type"><a class="J_room-detail" href="javascript:;"><%= room.name%></a></span>\n            <span class="res-rooms-bed"><%= room.bedType || \'--\'%></span>\n            <span class="res-rooms-breakfast"><%= room.hotelPackages && room.hotelPackages[0].breakfast || \'--\'%></span>\n            <span class="res-rooms-network"><%= room.network || \'--\'%></span>\n            <span class="res-rooms-count">\n                <%if(room.select) {%>\n                <select class="hotel_num" name="hotel_num">\n                    <% for(var i = room.roomNum; i <= 20; i++) {%>\n                        <% if(i == room.selectNum) {%>\n                        <option selected="selected"><%= i%></option>\n                        <% } else { %>\n                        <option><%= i%></option>\n                        <% } %>\n                    <%}%>\n                </select> \n                <%}else{%>\n                    --\n                <%}%>\n            </span>\n            <span class="res-rooms-price">\n            <% if(room.select){%>--<% }else{ %>\n                <%if(room.diffPrice >= 0){%>+<%}else{%>-<%}%><%= Math.abs(room.diffPrice)%>/\n            <%}%>\n            </span>\n            <span class="res-rooms-select"><%if(room.select) {%><em class="res-label-selected"><i class="icon-selected"></i></em><%}else{%><a href="javascript:;" class="J_rooms_choose"></a><%}%></span>\n        </div>\n        <div class="res-rooms-detail hide">\n            <a href="javascript:;" class="res-detail-close"></a>\n            <h5><%=room.name%></a></h5>\n            <% if(room.roomBigPics) {%>\n            <div class="res-detail-pictures">\n                <ul>\n                    <% for(var i=0; i < room.roomBigPics.length; i++) {%>\n                    <li>\n                        <img src="<%=helper.resizeImage(room.roomBigPics[i].path, 180, 100, 1)%>" alt="">\n                    </li>\n                    <%}%>\n                </ul>\n                <% if (room.roomBigPics.length >= 5) { %>\n                    <a href="javascript:;" class="J_prev"><span class="J_prev_icon"></span></a>\n                    <a href="javascript:;" class="J_next"><span class="J_next_icon"></span></a>\n                <% } %>\n            </div>\n            <%}%>\n            <p class="res-detail-text">\n                <%if(room.adultNum != 0 || room.baseNum != 0) {%>\n                    <span class="res-text-item"> <strong></strong> <%= room.adultNum == 0 ? (room.baseNum == 0 ? \'2\':room.baseNum+\'\'): room.adultNum+\'\'+(room.childNum == 0 ?\'\':room.childNum+\'\')%> </span>\n                <%}%>\n                <%if(room.area && room.area != 0) {%><span class="res-text-item"> <strong></strong> <%=room.area%> </span><%}%>\n                <%if(room.isNoSmoking && room.isNoSmoking != -1) {%>\n                    <span class="res-text-item"> <strong></strong> <%= room.isNoSmoking == 0 ? \'\' : \'\'%> </span>\n                <%}%>\n\n                <%if(room.floor && room.floor != 0) {%><span class="res-text-item"> <strong></strong> <%=room.floor%> </span><%}%>\n            </p>\n            <%if(room.bookNotice) {%>\n                <p class="res-detail-notice">\n                    <strong></strong>\n                    <span><%- room.bookNotice%></span>\n                </p>\n            <%}%>\n        </div>\n    </div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemTemplate='\n<%\n    var formatBreakfast = function(i){\n        var arr = [\'\',\'\',\'\',\'\',\'\',\'\',\'\',\'\',\'\',\'\']\n        return arr[i];\n    }\n%>\n    <div class="res-rooms-ratePlan hotel-ratePlan" style="position:relative" data-conditionrateplanid="<%=ratePlan.conditionRatePlanId%>" data-rateplanid="<%= ratePlan.ratePlanId%>">\n        <span class="res-rooms-type"><%= ratePlan.ratePlanName%></span>\n        <span class="res-rooms-bed canhover" style="cursor:pointer"><%= ratePlan.bedType || \'--\'%></span>\n            <script class="bed-detail" type="text/template">\n                <div class="bed-detail" style="padding:10px">\n                    <%= ratePlan.bedType || \'--\'%>\n                </div>\n            <\/script>\n        <span class="res-rooms-breakfast canhover" style="cursor:pointer"><%= ratePlan.breakfast || \'--\'%></span>\n            <script class="breakfast-detail" type="text/template">\n                <div class="breakfast-detail" style="padding:10px">\n                    <%= ratePlan.breakfast || \'--\'%>\n                </div>\n            <\/script>\n        <span class="res-rooms-network canhover" style="cursor:pointer"><%= ratePlan.network || \'--\'%></span>\n            <script class="network-detail" type="text/template">\n                <div class="network-detail" style="padding:10px">\n                    <%= ratePlan.network || \'--\'%>\n                </div>\n            <\/script>\n        <span class="res-rooms-count">\n            <%if(ratePlan.select) {%>\n            <select class="hotel_num" name="hotel_num" data-roomid="">\n                <% for(var i = ratePlan.roomNum; i <= 20; i++) {%>\n                    <% if(i == ratePlan.selectNum) {%>\n                    <option selected="selected"><%= i%></option>\n                    <% } else { %>\n                    <option><%= i%></option>\n                    <% } %>\n                <%}%>\n            </select> \n            <%}else{%>\n            --\n            <%}%>\n        </span>\n        <span class="res-rooms-price">\n            <%if(ratePlan.select) {%>--<% }else{ %>\n                <%if(ratePlan.diffPrice >= 0){%>+<%}else {%>-<%}%><%= Math.abs(ratePlan.diffPrice)%>/\n            <% } %>\n        </span>\n        <span class="res-rooms-select"><%if(ratePlan.select) {%><em class="res-label-selected"><i class="icon-selected"></i></em><%}else{%><a href="javascript:;" class="J_rooms_choose J_plan_choose" data-vendorId="<%= ratePlan.vendorId%>" data-uniqueId="<%= ratePlan.uniqueId%>"></a><%}%></span>\n    </div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.planTemplate='\n    <%\n        var getSelectItem = (function() {\n            for (var i = 0; i<hotelPackages.length; i++) {\n                if(hotelPackages[i].select) {\n                    return hotelPackages[i];\n                }\n            }\n            return hotelPackages[0];\n        })();\n        var formatBreakfast = function(i){\n            var arr = [\'\',\'\',\'\',\'\',\'\',\'\',\'\',\'\',\'\',\'\']\n            return arr[i];\n        }\n    %>\n\n    <div class="hotel-roomPlan <%if(!beShow){%>hotel-roomPlan-hide hide<%}%> plan">\n        <div class="res-rooms-list hotel-ratePlan J_select-ratePlan" data-conditionRatePlanId="<%=getSelectItem.conditionRatePlanId%>" data-rateplanid="<%=getSelectItem.ratePlanId%>" data-roomId="<%= roomId%>">\n            <span class="res-rooms-type"><a class="J_room-detail" href="javascript:;"><%=name%></a></span>\n            <span class="res-rooms-bed hide"><%= getSelectItem.bedType || \'--\'%></span>\n            <span class="res-rooms-breakfast hide"><%= getSelectItem.breakfast || \'--\'%></span>\n            <span class="res-rooms-network hide"><%= getSelectItem.network || \'--\'%></span>\n            <span class="res-rooms-count hide">\n                <%if(getSelectItem.select) {%>\n                <select class="hotel_num" name="hotel_num" data-roomid="">\n                    <% for(var i = getSelectItem.roomNum; i <= 20; i++) {%>\n                        <% if(i == getSelectItem.selectNum) {%>\n                        <option selected="selected"><%= i%></option>\n                        <% } else { %>\n                        <option><%= i%></option>\n                        <% } %>\n                    <%}%>\n                </select> \n                <%}else{%>\n                --\n                <%}%>\n            </span>\n            <span class="res-rooms-price hide">\n            <% if(getSelectItem.select){%>--<% }else{ %>\n            <%if(getSelectItem.diffPrice >= 0){%>+<%}else {%>-<%}%><%= Math.abs(getSelectItem.diffPrice)%>/\n            <% } %>\n            </span>\n            <span class="res-rooms-select hide"><%if(getSelectItem.select) {%><em class="res-label-selected"><i class="icon-selected"></i></em><%}else{%><a href="javascript:;" class="J_rooms_choose" data-vendorId="<%= getSelectItem.vendorId%>" data-uniqueId="<%= getSelectItem.uniqueId%>"></a><%}%></span>\n        </div>\n        <div class="res-rooms-detail hide">\n            <a href="javascript:;" class="res-detail-close"></a>\n            <h5><%=name%></a></h5>\n            <% if(roomBigPics) {%>\n            <div class="res-detail-pictures">\n                <ul>\n                    <% for(var i=0; i < roomBigPics.length; i++) {%>\n                    <li>\n                        <img src="<%=helper.resizeImage(roomBigPics[i].path, 180, 100, 1)%>" alt="">\n                    </li>\n                    <%}%>\n                </ul>\n                <% if (roomBigPics.length >= 5) { %>\n                    <a href="javascript:;" class="J_prev"><span class="J_prev_icon"></span></a>\n                    <a href="javascript:;" class="J_next"><span class="J_next_icon"></span></a>\n                <% } %>\n            </div>\n            <%}%>\n            <p class="res-detail-text">\n                <%if(adultNum != 0 || baseNum != 0) {%>\n                    <span class="res-text-item"> <strong></strong> <%= adultNum == 0 ? (baseNum == 0 ? \'2\':baseNum+\'\'): adultNum+\'\'+(childNum == 0 ?\'\':childNum+\'\')%> </span>\n                <%}%>\n                <%if(area && area != 0) {%><span class="res-text-item"> <strong></strong> <%=area%> </span><%}%>\n                <%if(isNoSmoking != -1) {%>\n                    <span class="res-text-item"> <strong></strong> <%= isNoSmoking == 0 ? \'\' : \'\'%> </span>\n                <%}%>\n\n                <%if(floor && floor != 0) {%><span class="res-text-item"> <strong></strong> <%=floor%> </span><%}%>\n            </p>\n            <%if(bookNotice) {%>\n                <p class="res-detail-notice">\n                    <strong></strong>\n                    <span><%- bookNotice%></span>\n                </p>\n            <%}%>\n        </div>\n        <div class="hotel-ratePlan-list room_<%= roomId%>" id="<%= roomId%>"></div>\n        <% if(hotelPackages && hotelPackages.length > 3) { %>\n            <div class="J_showAll-plans plan-button"><span></span><i class="iconfont icon off"></i></div>\n        <% } %>\n    </div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hotelConfig={showPrev:function(e){var t=$(e);if(!t.hasClass("T_disabled")){var n=t.siblings("ul"),i=parseInt(n.css("left")),a=n.children().eq(0).width();i>=0||(i+a>0?n.animate({left:0},"linear"):(t.addClass("T_disabled"),n.animate({left:i+a},"linear",function(){t.removeClass("T_disabled")})))}},showNext:function(e){var t=$(e);if(!t.hasClass("T_disabled")){var n=t.siblings("ul"),i=parseInt(n.css("left")),a=t.parent().width(),o=0,r=n.children().eq(0).width();n.children().each(function(e,t){o+=$(t).outerWidth(!0)}),i<=a-(o-=10)||(i-r<a-o?n.animate({left:a-o},"linear"):(t.addClass("T_disabled"),n.animate({left:i-r},"linear",function(){t.removeClass("T_disabled")})))}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=$(window),o=$("body"),r=[],s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=$(t),this.inited=!1,this.disabled=!1,this.visible=!1,this.options=Object.assign({offset:0,ctx:o,attr:"data-rel",firstDefault:!0},n),this.firstDefault=this.options.firstDefault,this.$element=t;var i=this.options.ctx,a=this.options.attr;this.tabs=t.find("["+a+"]").toArray().map(function(e){return e=$(e),{$tab:e,$target:i.find(e.attr(a)),offset:{left:0,top:0,width:0,height:0}}}).filter(function(e){if(e.$target.length)return!0;e.$tab.remove()}),this.update(),this.bind()}return i(e,[{key:"bind",value:function(){var e=this.options.offset;this.tabs.forEach(function(t){t.$tab.click(function(){t.active||a.scrollTop(t.offset.top-e)})})}},{key:"isAvailable",value:function(){return!this.disabled&&this.visible}},{key:"_updateVisibility",value:function(){this.visible=this.$element.is(":visible")}},{key:"_updateTabs",value:function(){this.isAvailable()&&(this.tabs=this.tabs.filter(function(e){return!(!e.$target||!e.$target[0].parentNode)||(e.$tab.remove(),!1)}))}},{key:"_update",value:function(){this.isAvailable()&&(this.tabs.forEach(function(e){Object.assign(e.offset,e.$target.offset()),e.offset.width=e.$target.outerWidth(),e.offset.height=e.$target.outerHeight(),e.offset.right=e.offset.left+e.offset.width,e.offset.bottom=e.offset.top+e.offset.height}),this.tabs.sort(function(e,t){return e.offset.top-t.offset.top}),this.inited=!0)}},{key:"_position",value:function(e){var t=this;if(this.isAvailable()){var n=this.options.offset;e=void 0===e?a.scrollTop():e;!0!==this.tabs.reduce(function(i,a){return!0===i||(i=i||a.offset.top,a.$target&&a.$target.is(":hidden")?i:e+n>i&&e+n<=a.offset.bottom?(t.active(a),!0):a.offset.bottom)},0)&&(this.firstDefault?this.active(this.tabs[0]):this.deactive())}}},{key:"update",value:function(){this._updateVisibility(),this._updateTabs(),this._update(),this._position()}},{key:"position",value:function(e){!1===this.inited&&(this._updateVisibility(),this._updateTabs(),this._update()),this._position(e)}},{key:"active",value:function(e){e&&this.tabs.forEach(function(t){e===t?(t.$tab.addClass("active"),t.active=!0):(t.$tab.removeClass("active"),t.active=!1)})}},{key:"deactive",value:function(){this.tabs.forEach(function(e){e.$tab.removeClass("active"),e.active=!1})}},{key:"disable",value:function(){this.disabled=!0}},{key:"enable",value:function(){this.disabled=!1}}]),e}();a.on("resize",function(){r.forEach(function(e){e.update()})}).on("scroll resize",function(){var e=a.scrollTop();r.forEach(function(t){t.position(e)})}),t.createScrollTaber=function(e,t){var n=new s(e,t);return r.push(n),n},t.updateScrollTaber=function(e){instance&&instance instanceof Fixer?instance.update():r.forEach(function(e){e.update()})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPagination=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=[],o=n(14).template.compile('\n<div class="pagination-box">\n    <span class="pagination-item pagination-prev<%= current === 1 ? \' disabled\' : \'\' %>">&lt;</span>\n    <% for (var page = min; page <= max; page++) { %>\n        <span class="pagination-item pagination-page<%= current === page ? \' active\' : \'\' %>"\n            <% if (current !== page) { %>data-page="<%= page %>"<% } %>><%= page %></span>\n    <% } %>\n    <% if (more) { %>\n        <span class="pagination-item pagination-more"></span>\n    <% } %>\n    <% if (last) { %>\n        <span class="pagination-item pagination-page" data-page="<%= total %>"><%= total %></span>\n    <% } %>\n    <span class="pagination-item pagination-next<%= current === total ? \' disabled\' : \'\' %>">&gt;</span>\n</div>\n'),r=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.current=n.current||1,this.total=n.total||1,this.offset=2,this.$element=t,this.options=Object.assign({},n),this.bind(),this.render()}return i(e,[{key:"bind",value:function(){var e=this;this.$element.on("click",".pagination-prev",function(){e.change(e.current-1)}).on("click",".pagination-next",function(){e.change(e.current+1)}).on("click",".pagination-page",function(){e.change($(this).data("page"))})}},{key:"change",value:function(e){(e=parseInt(e))&&this.current!==e&&e>0&&e<=this.total&&(this.current=e,this.render(),this.options.onchange&&this.options.onchange(e))}},{key:"params",value:function(){var e=this.current,t=this.total,n=this.offset,i=Math.max(e-n,1),a=Math.min(t,i+2*n);return i=Math.max(a-2*n,1),{current:e,total:t,min:i,max:a,more:a<t,last:a!==t}}},{key:"render",value:function(){this.$element.html(o(this.params()))}},{key:"reload",value:function(e){this.current=e.current||this.current,this.total=e.total||this.total,this.offset=e.offset||this.offset,this.options=Object.assign({},this.options,e)}}]),e}();t.createPagination=function(e,t){var n=new r(e,t);return a.push(n),n}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.CHANGE_LOGIN_STATUS="CHANGE_LOGIN_STATUS"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.LOAD_COMMENT="LOAD_COMMENT",t.CHANGE_COMMENT_FILTER="CHANGE_COMMENT_FILTER",t.CHANG_DETAIL_JOURNEY="CHANG_DETAIL_JOURNEY"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.traffic=function(e){return new a.Component({type:"traffic",el:e.el,data:Object.assign({title:""},e.data),children:e.children,callback:{render:function(e){return f(e)},mount:function(e,t){var n=this.$(".J_blockBody");t.forEach(function(e){return n.append(e.getDOM())})},bind:function(){}},methods:{updateView:function(){this.getChildren().length?this.show():this.hide(),$(window).trigger("resize")},getFlightData:function(){function e(t,n){return n=n||[],"flightTicket"===t.type?t.data&&t.data.data&&(Array.isArray(t.data.data)?t.data.data.forEach(function(e){return n.push(e)}):n.push(t.data.data)):t.children&&t.children.forEach(function(t){return e(t,n)}),n}var t=e(this.get());return t.filter(function(e){return e}).sort(function(e,t){return e.seqNum-t.seqNum}),t},getDateRange:function(){var e=this.methods.getFlightData(),t=e[0]||{},n=e[e.length-1]||{},i=(t.flightTicketInfo||[])[0],a=n.flightTicketInfo||[],o=a[a.length-1];return{goTime1:s.Tool.str2Date(i.flightDate+" "+i.departTime),backTime1:s.Tool.getDeltaDate(o.flightDate+" "+o.arriveTime,o.arriveDay)}},getTrainTime:function(e){return{goTime1:s.Tool.getDeltaDate(e[0].trainTicketInfo.departureDate+" "+e[0].trainTicketInfo.departDepartTime,e[0].trainTicketInfo.durationDay-1),backTime1:s.Tool.getDeltaDate(e[1].trainTicketInfo.departureDate+" "+e[1].trainTicketInfo.destArriveTime,e[1].trainTicketInfo.durationDay-1)}}},lifecycle:{beforeMount:function(){this.methods.updateView()},beforeRender:function(){var e=this;this.getChildren().forEach(function(t){"train"==t.type&&1!==(0,o.getStore)().getState("supportTrafficType")&&e.request("changeCombinedCheck",e.methods.getTrainTime(t.data.list))})},whenChildMount:function(e){"flight"==e.type&&this.$(".J_blockBody").prepend(e.getDOM())}},events:{load:function(e){this.children,1!==(0,o.getStore)().getState("supportTrafficType")&&("flightTicket"==e.originTarget.type&&this.request("changeCombinedCheck",this.methods.getDateRange()),"train"==e.originTarget.type&&this.request("changeCombinedCheck",this.methods.getTrainTime(e.originTarget.data.list)))},"change:pareTime":function(e){this.request("loadPareTime",e.data.after)}},requests:{"load:flight":function(e){e.data&&(this.addChild(e.data),this.methods.updateView(),1!==(0,o.getStore)().getState("supportTrafficType")&&this.request("changeCombinedCheck",this.methods.getDateRange()),this.dispatch("load:flight"))}},factory:{bus:c.bus,train:l.train,combined:d.combined,flight:u.flight}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(23),o=n(1),r=n(106),s=n(165),c=n(495),l=n(497),d=n(504),u=n(506),f=i.compile(r.blockTemplate,{client:!0,compileDebug:!1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetcher=void 0;var i=n(499),a=n(500),o=n(501),r=n(502);t.fetcher={defaultResource:i.defaultResource,bus:a.bus,combination:o.combination,addition:r.addition}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.status=void 0;var i=n(1);t.status={need:{flight:function(){var e=(0,i.getStore)().getState("supportTrafficType");return 1===e||2===e},bus:function(){return 13==(0,i.getStore)().getState("proMode")}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SelectBox=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),o=n(503),r=n(107),s=window.$,c=["adultNumber","childNumber","originalAdultNumber","originalChildNumber"],l={AUTO_CHANGE_ADULT:"",AUTO_CHANGE_CHILD:""},d={childInfo:[],toastLastTime:3e3,toastMsg:"",preventDefaultToast:!1},u=a.compile(o.selectBoxTemplate),f=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);try{this.init(t,n,i)}catch(e){this.errorReport(e)}}return i(e,[{key:"getData",value:function(){return this.data}},{key:"change",value:function(e,t){var n=this;n.setData(e,t);var i="",a=n.checkDataStatus();if(a.isOverTotalNumber.flag){var o=a.isOverTotalNumber.offset+"";"adult"===e?(i=l.AUTO_CHANGE_CHILD,n.setData("child",o)):"child"===e&&(i=l.AUTO_CHANGE_ADULT,n.setData("adult",o))}n.options.change.call(n,n.getData(),i),n.load(),!n.options.preventDefaultToast&&i&&setTimeout(function(){n.toast(i)},10)}},{key:"toast",value:function(e,t){var n=this.container.find(".message-info");e&&(this.messageTimer&&clearTimeout(this.messageTimer),n.text(e).show(),this.messageTimer=setTimeout(function(){n.hide()},t||this.options.toastLastTime||3e3))}},{key:"setData",value:function(e,t){var n=void 0;if(void 0===this.data[e+"Number"])return!1;n="string"==typeof t&&/^(\+|-)\d+$/.test(t)?this.data[e+"Number"]+parseInt(t,10):t,this.data[e+"Number"]=n}},{key:"computeData",value:function(e){var t=e||this.getData();return{adultNumber:t.adultNumber,childNumber:t.childNumber,adult:{start:t.originalAdultNumber,end:t.originalAdultNumber+t.originalChildNumber},child:{start:0,end:t.originalChildNumber}}}},{key:"checkDataStatus",value:function(e){var t=e||this.getData(),n=t.originalAdultNumber+t.originalChildNumber,i=t.adultNumber+t.childNumber,a={isOverTotalNumber:{flag:!1,offset:0},isFreeChildGreaterThanAdult:{flag:!1}};return i>n?(a.isOverTotalNumber.flag=!0,a.isOverTotalNumber.offset=n-i):n-i>t.adultNumber&&(a.isFreeChildGreaterThanAdult.flag=!0),a}},{key:"bind",value:function(){var e=this,t=this.container;t.find(".select-display").on("click",function(e){return s(this).closest(".select-area").toggleClass("open").siblings(".select-area").removeClass("open"),e.stopPropagation(),!1}),t.off("click").on("click",function(){s(this).find(".select-area").removeClass("open")}),t.find(".select-option-box .select-option").on("click",function(t,n){var i=s(this);if(!i.hasClass("selected")){var a=i.closest(".select-area").data("key")||"",o=i.data("value")||0;e.change.call(e,a,o)}}),t.find(".childinfo").each(function(){var e=s(this),t=e.siblings(".J_childinfodetail").html();e.hover(function(){(0,r.showPopup)(e,{content:t})},function(){(0,r.hidePopup)()})})}},{key:"render",value:function(){this.container.html(u(s.extend({},this.computeData(),{childInfo:this.options.childInfo})))}},{key:"load",value:function(){this.render(),this.bind()}},{key:"errorReport",value:function(e){}},{key:"valid",value:function(e){var t="";return c.forEach(function(n,i){void 0===e[n]&&(t+=n+"")}),t&&this.errorReport(t),!t}},{key:"init",value:function(e,t,n){this.valid(t)&&(this.container=e,this.data={adultNumber:+t.adultNumber,childNumber:+t.childNumber,originalAdultNumber:+t.originalAdultNumber,originalChildNumber:+t.originalChildNumber},this.options=s.extend({},d,n),this.load(),this.options.toastMsg&&this.toast(this.options.toastMsg))}}]),e}();t.SelectBox=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t['default']=function(e,t){var n=function(e){function t(e,t){e.needCheckPrice&&u.flight[t].push({seqNum:e.seqNum,resId:e.resId,checkCabinAndPrice:e.checkCabinAndPrice,price:e.price,isInternational:e.isInternational})}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=(0,i.getStore)(),o=e.showTicketList&&e.showTicketList.length&&e.showTicketList[0]||1,r=e.selectedTicketList,s=e.data,c=e.pkgTicketBySeq,l=e.singleTicketList,d=["pkgFlight","singleFlight"],u={productId:a.getState("productId"),adultNum:null!=n.adultNum?n.adultNum:a.getState("adult"),childNum:null!=n.childNum?n.childNum:a.getState("child"),freeChildNum:a.getState("freeChild"),departDate:a.getState("departDate"),bookCityCode:a.getState("bookCityCode"),departCityCode:a.getState("departCityCode"),backCityCode:a.getState("backCityCode"),flight:{pkgFlight:[],singleFlight:[]}};return 1==o&&c&&c.length?c.forEach(function(e){e.pkgTicketList&&e.pkgTicketList.length&&e.pkgTicketList.forEach(function(e){t(e,"pkgFlight")})}):2==o&&l&&l.length&&l.forEach(function(e){var n=e.singleTicketList;n&&Object.keys(n).length&&t(n,"singleFlight")}),r&&Array.isArray(s)?s.forEach(function(e){t(e,d[r-1])}):r&&!Array.isArray(s)&&t(s,d[r-1]),u}(e,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),r=(0,i.getStore)();(n.flight.pkgFlight.length||n.flight.singleFlight.length)&&o.flight.checkFlightP(n).then(function(e){switch(e.checkStatus){case 1:t.request("check:flightFail",{tips:""}),r.dispatch({type:a.CHECK_FLIGHT_RES_FAIL,data:1});break;case 2:t.request("change:flightSuccess",{list:e.resIds||null}),r.dispatch({type:a.CHECK_FLIGHT_RES_FAIL,data:0});break;case 3:var n={tips:e.tipMsg,list:e.resIds||null};t.request("change:flightPrice",n),r.dispatch({type:a.CHECK_FLIGHT_RES_FAIL,data:0})}})['catch'](function(e){})};var i=n(1),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(58)),o=(n(10),n(166))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.item=function(e){return new a.Component({type:"item",el:e.el,data:e.data,children:e.children,methods:{update:function(){var e=this.get().data,t=e.select?"--":e.diffPrice>=0?"+"+e.diffPrice+"/":"-"+-1*e.diffPrice+"/";this.$(".res-rooms-select").html(c({select:e.select})),this.$(".res-rooms-count").html(s({select:e.select,roomNum:e.roomNum,selectNum:e.selectNum})),this.$(".res-rooms-price").html(t)},updateRoomNum:function(){}},callback:{render:function(e){return r({ratePlan:e})},mount:function(){},bind:function(){var e=this;this.$element.on("click",".J_rooms_choose",function(){e.set("select",!0)}),this.$element.on("change","select",function(){var t=$(this).val();e.set("selectNum",t)})}},lifecycle:{beforeInitialize:function(){},afterInitialize:function(){},beforeRender:function(){},afterRender:function(){},beforeMount:function(){},afterMount:function(){},beforeBind:function(){},afterBind:function(){}},events:{},requests:{"change:select":function(e){var t=this.get("price")-e.data.basePrice;e.data.id!=this.get("conditionRatePlanId")&&e.data.id!=this.get("ratePlanId")||e.data.basePrice!=this.get("price")||e.data.vendorId!=this.get("vendorId")?this.set("select",!1):this.set("select",!0),this.set("diffPrice",t),this.methods.update()},"change:selectNum":function(e){this.get("select")?this.set("selectNum",e.data.selectNum):this.set("selectNum",e.data.selectNum,{slient:!0}),this.methods.update()}}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(23),o=n(170),r=i.compile(o.itemTemplate,{client:!0,compileDebug:!1}),s=i.compile('\n    <%if(select) {%>\n    <select class="hotel_num" name="hotel_num" data-roomid="">\n        <% for(var i = roomNum; i <= 20; i++) {%>\n            <% if(i == selectNum) {%>\n            <option selected="selected"><%= i%></option>\n            <% } else { %>\n            <option><%= i%></option>\n            <% } %>\n        <%}%>\n    </select> \n    <%}else{%>\n    --\n    <%}%>\n',{client:!0,compileDebug:!1}),c=i.compile('\n    <%if(select) {%>\n        <em class="res-label-selected"><i class="icon-selected"></i></em>\n    <%}else{%>\n        <a href="javascript:;" class="J_rooms_choose"></a>\n    <%}%>\n',{client:!0,compileDebug:!1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addition=function(e){return new o.Component({type:"addition",el:e.el,data:e.data,children:e.children,methods:{showAdditionList:function(e){var t=this,n=[],i=(0,a.getStore)(),o=app_url("package/"+i.getState("productId")+"/addItemList?bookCityCode="+i.getState("bookCityCode")+"&departCityCode="+i.getState("departCityCode")+"&backCityCode="+i.getState("backCityCode")+"&isLeastOne=false&departDate="+i.getState("departDate")+"&itemType="+e+"&adultNum="+i.getState("adult")+"&journeyDay="+i.getState("duration")+"&childNum="+i.getState("child")+"&freeChildNum="+i.getState("freeChild")+"&productTypeName="+i.getState("productTypeName")+"&journeyId="+i.getState("journeyId"));this.filterChildren("isOpt",!0).forEach(function(e){e.getChildren().forEach(function(e){n.push(e.get().data)})}),l.dialog.open({title:[""],url:o,area:["1020px","95%"],data:n,callback:function(e){var i=c.addition.getChildData(n,e),a=t.filterChildren("isOpt",!1).map(function(e){return e.get()}),o=a.length-1,r=c.addition.formatListData(i);r.unshift(o,0),[].splice.apply(a,r),t.load({data:t.data,children:a})}})}},callback:{render:function(e){var t=(0,a.getStore)(),n=this.filterChildren("isMore",!1);return window.addItemCurrentData=$.extend(!0,{},this.data,{adultNum:t.getState("adult"),childNum:t.getState("child")}),d(Object.assign(e,{childNum:(0,a.getStore)().getState("child")||0,hasList:n.length>0}))},mount:function(){var e=this.getChildren(),t=$("<div />");e.forEach(function(e){t.append(e.getDOM())}),this.$(".addition-main").append(t.children())},bind:function(){var e=this;e.$element.on("click",".J_optionInfoItem",function(){e.methods.showAdditionList($(this).data("id"))})}},lifecycle:{beforeInitialize:function(){},afterInitialize:function(){},beforeRender:function(){},afterRender:function(){},beforeMount:function(){},afterMount:function(){},beforeBind:function(){},afterBind:function(){}},events:{},factory:{addItem:r.addItem}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(1),o=n(23),r=(n(19),n(524)),s=n(529),c=n(399),l=(n(48),n(10),n(53)),d=i.compile(s.additionTemplate,{client:!0,compileDebug:!1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addition={getChildData:function(e,t,n){var i=[];return e.forEach(function(e){return e.selected=0}),t.forEach(function(a){var o=!1;1===t.length&&n?a.isShow=!1:a.isShow=!0,e.forEach(function(e){e.isShow=!0,a.resourceId===e.resourceId&&(o=!0,e.selected=1,e.selectedNum=a.selectedNum,e.selectedChildNum=a.selectedChildNum,e.selectedDate=a.selectedDate,e.isShow=a.isShow)}),!o&&i.push(a)}),e.concat(i)},formatListData:function(e){return e.reduce(function(e,t){var n=!1;return e.forEach(function(e){e.itemType===t.itemType&&(e.resources.push(t),n=!0)}),n||e.push({itemType:t.itemType,itemTypeName:t.itemTypeName,resourceType:t.resourceType,resources:[t]}),e},[]).map(function(e){return{type:"addItem",data:Object.assign(e,{isMore:!1,isOpt:!0}),children:(e.resources||[]).map(function(e){return{type:"item",data:e}})}})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Map=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(548),o=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.element=t,this.map=null,this.visible=!1,this.activedMarker=null,this.markers=[],this.option=n||{}}return i(e,[{key:"createMap",value:function(){return new google.maps.Map(this.element,{zoom:1,maxZoom:16,minZoom:1,mapTypeControl:!1,streetViewControl:!1,scaleControl:!0})}},{key:"getMap",value:function(){return this.map||(this.map=this.createMap()),this.map}},{key:"getBound",value:function(){var e=this.resList,t=0,n=90,i=-180,a=180;if(e&&e)return e.forEach(function(e){t=Math.max(e.latitude,t),n=Math.min(e.latitude,n),a=Math.min(e.longitude,a),i=Math.max(e.longitude,i)}),new google.maps.LatLngBounds(new google.maps.LatLng(n,a),new google.maps.LatLng(t,i))}},{key:"resize",value:function(){var e=this.getBound();google.maps.event.trigger(this.map,"resize"),this.map.setCenter(e.getCenter()),this.map.fitBounds(e)}},{key:"renderMarker",value:function(e){var t=(0,a.createMarker)({serial:1,type:e.moduleType,name:e.title,latitude:e.latitude,longitude:e.longitude});return t.id=e.id,t.setMap(this.map),this.markers.push(t),t}},{key:"bindMarkerEvent",value:function(e,t){var n=this;e.addListener("click",function(){n.activateMarker(e),n.option&&n.option.onMarkerActive&&n.option.onMarkerActive(t)}),e.addListener("mouseenter",function(){this.hightlight(),this.moveToTop()}),e.addListener("mouseleave",function(){this.removeHightlight(),this.restoreZIndex()})}},{key:"clearAllMarker",value:function(){for(var e=this.markers;e.length;)e.pop().setMap(null)}},{key:"activateMarker",value:function(e){this.activedMarker&&(this.activedMarker.deactivate(),this.activedMarker=null),e&&(this.activedMarker=e,e.activate())}},{key:"activateMarkerById",value:function(e){var t=this.getMarkerById(e);t&&this.activateMarker(t)}},{key:"getMarkerById",value:function(e){return this.markers.filter(function(t){return t.id==e})[0]}},{key:"render",value:function(){var e=this,t=this.resList;this.activeSpot;t&&t&&(this.getMap(),this.clearAllMarker(),this.map.fitBounds(this.getBound()),t.forEach(function(t,n){e.bindMarkerEvent(e.renderMarker(Object.assign({},t,{serial:n+1})),t)}))}},{key:"load",value:function(e){this.resList=e,this.render()}}]),e}();t.Map=o},function(e,t,n){"use strict";function i(e){e=Object.assign({},e);for(var t in e)e.hasOwnProperty(t)&&(e[t]=-e[t]);return e}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=[],r=$(window),s=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=Object.assign({direction:"h"},n),this.children=null,this.size=null,this.prevDisabled=!0,this.nextDisabled=!0,this.position={left:0,top:0},this.$container=t,this.$list=null,this.$prev=null,this.$next=null,this.init(),this.bind()}return a(e,[{key:"init",value:function(){this.options.direction;this.$list=this.$container.find("[data-role=list]"),this.$prev=this.$container.find("[data-role=prev]"),this.$next=this.$container.find("[data-role=next]"),this.children=function(e,t){return e.find("[data-role=item]").toArray().map(function(e){return e=$(e),{$element:e}})}(this.$list),this.updateSize(),this.updateState(),this.updateView()}},{key:"update",value:function(){this.updateSize(),this.move(0)}},{key:"updateSize",value:function(){var e="h"===this.options.direction?"width":"height";!function(e){e.forEach(function(e){e.width=e.$element.outerWidth(!0),e.height=e.$element.outerHeight(!0)})}(this.children),this.size={width:this.$container.width(),height:this.$container.height()},this.$list[e](this.children.reduce(function(t,n){return n[e]+t},0)),this.listSize={width:this.$list.width(),height:this.$list.height()},this.listSize[e]<=this.size[e]?(this.$prev.hide(),this.$next.hide()):(this.$prev.show(),this.$next.show())}},{key:"updatePosition",value:function(e){var t=this.options.direction,n="h"===t?"left":"top",i="h"===t?"width":"height",a=0,o=this.position[n];e>0&&(o+=this.size[i]),this.children.some(function(t,n){var i=a+t.width;return 1===e&&o>=a&&o<i?(a=i,!0):-1===e&&o>a&&o<=i||(a=i,!1)}),e>0&&(a-=this.size[i]),this.listSize[i]-a<this.size[i]&&(a=this.listSize[i]-this.size[i]);var r={};r[n]=a,this.position=Object.assign({left:0,top:0},r)}},{key:"updateState",value:function(){var e=this.options.direction,t="h"===e?"left":"top",n="h"===e?"width":"height",i=this.position,a=this.size,o=this.listSize;i[t]<=0?this.prevDisabled=!0:this.prevDisabled=!1,i[t]+a[n]>=o[n]?this.nextDisabled=!0:this.nextDisabled=!1}},{key:"updateView",value:function(){this.prevDisabled?this.$prev.addClass("disabled"):this.$prev.removeClass("disabled"),this.nextDisabled?this.$next.addClass("disabled"):this.$next.removeClass("disabled")}},{key:"bind",value:function(){var e=this;this.$prev.click(function(){e.prevDisabled||e.move(-1)}),this.$next.click(function(){e.nextDisabled||e.move(1)})}},{key:"move",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;0===e?this.$list.css(i(this.position)):(this.updatePosition(e),this.updateState(),this.updateView(),this.$list.stop(!0,!0).animate(i(this.position),700))}}]),e}();r.on("resize",function(){o.forEach(function(e){return e.update()})}),t.createGallery=function(e,t){var n=new s(e,t);return o.push(n),n}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var i=n(1),a=n(468),o=n(473),r=n(483),s=n(545);n(559);var c=window.pageData||{};(0,i.createStore)(a.reducers,{status:c.status,isLogin:c.isLogin,productId:c.productId,productType:c.productType,productName:c.productName,homeBookCityCode:c.homeBookCityCode,bookCityCode:c.bookCityCode,bookCityName:c.bookCityName,departCityCode:c.departCityCode,departCityName:c.departCityName,backCityCode:c.backCityCode,departDate:c.departDate,proMode:c.proMode,lowestPromoPrice:c.lowestPromoPrice,journeyType:c.journeyType,journeyData:c.journeyData,resTypeList:c.resTypeList,journeyId:c.journeyId||"",productTypeName:c.productTypeName||"",needFlight:c.needFlight,supportTrafficType:0,mixedTrafficType:0,isSingleTeamMixed:c.isSingleTeamMixed,flightInternationalNormal:!1,flightToListData:null,originalFlightData:null,checkResFaild:-1,duration:0,calendar:null,childrenPriceTip:"",adult:2,child:0,adultTicket:2,childTicket:0,trainAdultTicket:2,trainChildTicket:0,freeChildTicket:0,freeChild:0,initVisa:[],isSupportCondition:0,cancelDesc:[]});o.basisModule.init(),r.productModule.init(),s.detailModule.init()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducers=void 0;var i=n(1),a=n(469),o=n(470),r=n(471),s=n(472);t.reducers=(0,i.combineReducer)(Object.assign({},a.commonReducers,o.resourceReducers,r.detailReducers,s.detailReducers))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.commonReducers=void 0;var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(390));t.commonReducers={isLogin:function(e,t){return t.type===i.CHANGE_LOGIN_STATUS?t.data:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resourceReducers=void 0;var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(57));t.resourceReducers={calendar:function(e,t){return t.type===i.LOAD_CALENDAR?t.data:e},roomBudget:function(e,t){return t.type===i.LOAD_CALENDAR_ROOM_BUDGET?t.data:e},departDate:function(e,t){return t.type===i.CHANGE_DEPART_DATE?t.data:e},departCity:function(e,t){return t.type===i.CHANGE_DEPART_CITY&&t.data&&t.data.code&&t.data.code!==e.code?t.data:e},backCity:function(e,t){return t.type===i.CHANGE_BACK_CITY&&t.data&&t.data.code?t.data:e},adult:function(e,t){return t.type===i.CHANGE_ADULT?t.data:e},child:function(e,t){return t.type===i.CHANGE_CHILD?t.data:e},freeChild:function(e,t){return t.type===i.CHANGE_FREE_CHILD?t.data:e},adultTicket:function(e,t){return t.type===i.CHANGE_ADULT_TICKET?t.data:e},childTicket:function(e,t){return t.type===i.CHANGE_CHILD_TICKET?t.data:e},trainAdultTicket:function(e,t){return t.type===i.CHANGE_TRAIN_ADULT_TICKET?t.data:e},trainChildTicket:function(e,t){return t.type===i.CHANGE_TRAIN_CHILD_TICKET?t.data:e},freeChildTicket:function(e,t){return t.type===i.CHANGE_FREE_CHILD_TICKET?t.data:e},departDateTarget:function(e,t){return t.type===i.CHANGE_DEPART_DATE_TARGET?t.data:e},duration:function(e,t){return t.type===i.CHANGE_JOURNEY_DAY?t.data:e},status:function(e,t){return t.type===i.CHANGE_PRODUCT_STATUS&&e!=t.data?t.data:e},currentJourney:function(e,t){return t.type===i.CHANG_DETAIL_JOURNEY?t.data:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detailReducers=void 0;var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(391));t.detailReducers={currentJourney:function(e,t){return t.type===i.CHANG_DETAIL_JOURNEY?t.data:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detailReducers=void 0;var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(58));t.detailReducers={childrenPriceTip:function(e,t){return t.type===i.CHILDREN_PRICE_TIP?t.data:e},freeChildPriceTip:function(e,t){return t.type===i.CHILDREN_FREE_PRICE_TIP?t.data:e},checkResFaild:function(e,t){return t.type===i.CHECK_FLIGHT_RES_FAIL?t.data:e},initVisa:function(e,t){return t.type===i.INIT_VISA_FLAG?t.data:e},supportTrafficType:function(e,t){return t.type===i.SET_TRAFFIC_TYPE?t.data:e},mixedTrafficType:function(e,t){return t.type===i.SET_MIXED_TYPE?t.data:e},flightInternationalNormal:function(e,t){return t.type===i.SET_FLIGHT_INTERNATIONAL_NORMAL?t.data:e},flightToListData:function(e,t){return t.type===i.SET_FLIGHT_TO_LIST_DATA?t.data:e},originalFlightData:function(e,t){return t.type===i.SET_ORIGINALFLIGHT_DATA?t.data:e},isSupportCondition:function(e,t){return t.type===i.SET_SUPPORT_CONDITION?t.data:e},cancelDesc:function(e,t){return t.type===i.SET_CANCEL_DESC?t.data:e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.basisModule=void 0;var i=n(1),a=(n(14),n(10),n(73)),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(57)),r=n(19),s=n(164),c=n(474),l=n(478),d=n(479),u=n(481),f=n(482),h=n(53),p=void 0,m=void 0,v=void 0;$(window),t.basisModule={init:function(){var e=(p=(0,i.getStore)()).getState("status");m=$("#J_Calendar"),v=$("#J_Form"),1==e&&(this.initCalendar(),this.initCity(),this.initJourney(),this.intDownpaymentTip(),this.initPriceTip(),d.favorModule.init({couponReceiveUrl:r.config.url.couponReceive})),this.initGallery(),this.initPromotionTip(),this.initRecommend(),this.initFeature(),this.initQr(),this.initFavorite(),this.initService(),this.bind()},bind:function(){var e=this;p.subscribe(function(){var e=p.getState("calendar");e&&e.length||p.dispatch({type:o.CHANGE_PRODUCT_STATUS,data:0})},"change:calendar"),p.subscribe(function(){e.update()},"change:status"),$("#J_seeMore").click(function(){var e=$("#J_product").offset().top;$("html,body").animate({scrollTop:e},300)}),$(".scenic-sub-item").click(function(e){var t=e.currentTarget.getAttribute("data-scenicid");h.dialog.open({title:"",url:app_url("drive/scenicDetail/"+t),area:["1020px","95%"],callback:function(){}})}),$(".resource-feature-item").bind({click:function(e){try{for(var t,n=(e=e||window.event)?e.target:e.srcElement;n.parentNode&&"BODY"!=n.nodeName&&"HTML"!=n.nodeName;)(t=n.getAttribute("m"))&&window.eventTrack&&window.eventTrack.push({text:t,x:e.clientX,y:e.clientY}),n=n.parentNode}catch(e){}e.stopPropagation(),$(this).addClass("focus")}})},update:function(){var e=p.getState("status"),t=$("#J_ResourcePrice");$("#J_toolbar");$("#J_toolbar").removeClass("loading disabled normal").addClass("disabled"),0==e&&(t.html('\n                <div class="resource-section-item resource-price-item resource-price-saleout">\n                    <div class="resource-price-empty"><strong>~</strong></div>\n                    <div class="resource-price-other"></div>\n                </div>\n            '),$("#J_SubmitBasis").addClass("disabled"))},initGallery:function(){new a.Gallery("#J_Gallery",{autoChange:!0})},initCalendar:function(){c.calendarModule.init({calendarUrl:r.config.url.calendar,paramsType:"query"})},initCity:function(){l.cityModule.init({pageUrl:r.config.url.page})},initJourney:function(){f.journeyModule.init({journeyUrl:r.config.url.journey})},initPriceTip:function(){var e=$("#J_ResourcePriceTip"),t=$("#"+e.data("for")),n=$("#J_ResourcePromotionPriceTip"),i=$("#"+n.data("for"));new s.Tip(e,{content:$("<div />").append(t.removeClass("tip-content")).html(),dialog:{tipsOffset:[10,-27]}}),new s.Tip(n,{content:$("<div />").append(i.removeClass("tip-content")).html(),dialog:{area:["380px","auto"],tipsOffset:[10,-27]}})},intDownpaymentTip:function(){var e=$("#J_ResourceDownpaymentList").html();new s.Tip($("#J_ResourceDownpaymentTip"),{content:e,dialog:{tipsOffset:[10,-2]}})},initPromotionTip:function(){var e=$("#J_ResourcePromotionMore").html();new s.Tip($("#J_ResourcePromotionTip"),{type:"click",content:e,dialog:{area:["290px","auto"],tipsOffset:[0,-20]}})},initRecommend:function(){var e=$("#J_ResourceRecommend"),t=e.find(".resource-section-content"),n=e.find(".resource-recommend-content-outer"),i=e.find(".resource-recommend-content-inner"),a=e.find(".resource-recommend-expand"),o=i.height(),r=!1;n.height()<o&&(e.addClass("fixed").height(72),n.height(72).css("max-height","none"),a.show(),t.hover(function(){n.height(o),e.addClass("expanded"),r=!0},function(){n.height(72),e.removeClass("expanded"),r=!1}))},initFeature:function(){var e=$("#J_ResourceFeature"),t=e.find(".resource-feature-content-inner"),n=e.find(".resource-feature-list"),i=t.height(),a=n.height(),o=!1;i<a&&$("<div />").addClass("resource-feature-more").html("<i></i>").click(function(){o?(t.height(i),$(this).html("<i></i>").removeClass("expand"),o=!1):(t.height(a),$(this).html("<i></i>").addClass("expand"),o=!0)}).appendTo(t),t.find(".resource-feature-item").each(function(){var e=$(this),t=e.data("for"),n=void 0;t&&(n=$("#"+t),new s.Tip(e,{type:"click",content:$("<div />").append(n.removeClass("tip-content")).html(),dialog:{tipsOffset:[10,-27]}}))})},initQr:function(){$(".J_QR").hover(function(){$(this).addClass("expand")},function(){$(this).removeClass("expand")})},initFavorite:function(){u.favoriteModule.init({checkFavoriteStateUrl:r.config.url.checkFavoriteState,addFavoriteUrl:r.config.url.addFavorite,removeFavoriteUrl:r.config.url.removeFavorite})},initService:function(){function e(e){e&&e.url&&($(".J_Service").attr({href:e.url,target:"_blank"}).show(),window.showHeadTuniuChat?window.showHeadTuniuChat(e):window.showHeadTuniuChat=e)}window.getKefuData?window.getKefuData(e):(window.sidebarCallbacks=window.sidebarCallbacks||[],window.sidebarCallbacks.push(e))}}},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}function a(e){return x.lastIndex=0,x.exec(String(e))}function o(e){return String(e).replace(/\-/g,"/")}function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;e=String(e);for(var n=Math.max(t-e.length,0);n>0;n--)e="0"+e;return e}function s(e){return[e.getFullYear(),r(e.getMonth()+1),r(e.getDate())].join(T)}function c(e){return"string"==typeof e&&(e=new Date(o(e))),[e.getFullYear(),r(e.getMonth()+1)].join(T)}function l(){var e={},t=[],n=o(A+"-01"),i=new Date(n),a=new Date(n),r=void 0,c=void 0;for(i.setDate(i.getDate()-i.getDay()),(a=new Date(i.getTime())).setDate(a.getDate()+w-1),e.start=s(i),e.end=s(a),r=new Date(o(e.start));r<=a;)c=s(r),t.push({fullDate:c,year:r.getFullYear(),month:r.getMonth(),date:r.getDate(),isInCurrentMonth:~c.indexOf(A)}),r.setDate(r.getDate()+1);return e.all=t,e}function d(e,t){var n=a(e),i=a(t),o=n[1],r=n[2];return 12*(o-i[1])+(r-i[2])}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=new Date(o(e+"-01"));return n.setMonth(n.getMonth()+t),c(n)}function f(e){var t=d(e,E),n=Math.floor(t/I),i=new Date(o(E+"-01"));return i.setMonth(i.getMonth()+n*I),c(i)}function h(e){return!!(a(e)&&e>=L&&e<=R)&&(A=e,!0)}Object.defineProperty(t,"__esModule",{value:!0}),t.calendarModule=void 0;var p=n(1),m=n(14),v=n(10),g=i(n(58)),y=i(n(57)),b=n(475),_=n(476),k=n(477),C=n(115),T="-",w=42,N=s(new Date),I=4,D=m.template.compile(k.calendarDetailTemplate),S=void 0,x=/^(\d{4})\-(\d{2})$/,P=/^(\d{4})\-(\d{2})\-(\d{2})$/,M=void 0,j=void 0,E=void 0,O=void 0,A=void 0,L=void 0,R=void 0,J=[],F=void 0,H=void 0,B=void 0,V=!1,G={init:function(e){var t=this;S=e,F=$("#J_Calendar"),(M=(0,p.getStore)()).subscribe(function(){t.load()},"change:calendar"),M.subscribe(function(){(function(){var e=M.getState("departDate"),t=l();return e<=t.end&&e>=t.start})()||(A=c(new Date(o(M.getState("departDate")))),O=f(A)),t.render()},"change:departDate"),E=c(new Date),this.fetch()},bind:function(){F.on("click",".calendar-date-enabled",function(e){F.offset().top;F.offset().top!=$(window).scrollTop()&&($("html,body").animate({scrollTop:F.offset().top},300),$(this).mouseleave()),G.changeDepart($(this).data("date")),(0,C.record)("____",e)}).on("mouseenter",".calendar-date-enabled",function(){var e=$(this),t=e.data("date");clearTimeout(B),B=setTimeout(function(){G.showDateDetail(t,e)},200)}).on("mouseleave",".calendar-date-enabled",function(){clearTimeout(B),G.hideDateDetail($(this).data("date"))}).on("click",".calendar-month",function(e){G.changeMonth($(this).data("month")),(0,C.record)("____",e)}).on("click",".calendar-prev",function(){G.goNextMonth(-1)}).on("click",".calendar-next",function(){G.goNextMonth()}),d(R,L)<=3?F.find(".calendar-prev, .calendar-next").remove():F.find(".calendar-prev, .calendar-next").show()},fetch:function(e){e=e||0,$.ajax({dataType:"json",url:S.calendarUrl(),data:{productId:M.getState("productId"),bookCityCode:M.getState("bookCityCode")||void 0,departCityCode:M.getState("departCityCode")||void 0,backCityCode:M.getState("backCityCode")||void 0,journeyId:M.getState("journeyId")||void 0}}).done(function(e){var t={};e&&e.success&&e.data&&(t=e.data),J=t.promotionList||[],M.dispatch({type:g.CHILDREN_PRICE_TIP,data:t.childrenPriceTip||""}),M.dispatch({type:g.CHILDREN_FREE_PRICE_TIP,data:t.freeChildPriceTip||""}),M.dispatch({type:g.LOAD_CALENDAR,data:function(e){return e&&e.forEach(function(e){((e||{}).discountDesc||[]).some(function(t){if(t&&1==t.type)return e.isPromotion=!0,!0})}),e}(t.calendarInfo)||[]})}).fail(function(){e<=5?this.fetch(e+1):M.dispatch({type:g.LOAD_CALENDAR,data:[]})}.bind(this))},load:function(){A=function(){var e=M.getState("calendar");if(e&&e.length)return c(e[0].planDate)}()||E,O=f(A),j=function(){var e=M.getState("calendar");return j={},e&&e.forEach(function(e){var t=c(e.planDate);e.isRealTimePrice?j[t]||(j[t]=1/0):j[t]=Math.min(e.startPrice,j[t]||1/0)}),j}(),L=function(){var e=M.getState("calendar")[0];return e?c(e.planDate):null}()||E,R=function(){var e=M.getState("calendar"),t=e[e.length-1];return t?c(t.planDate):u(L,3)}()||E,O=O<L?L:O,F.removeClass("loading"),this.bind(),this.render(),F.removeClass("loading").find(".calendar-loading-mask").remove(),window.PERFORMANCE&&window.d&&(window.PERFORMANCE.r=(new Date).getTime()-window.d.getTime())},changeMonth:function(e){h(e)&&this.render()},goNextMonth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;h(u(A,e))&&(this.changeMonthGroup(e),this.render())},changeMonthGroup:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=d(A,O),n=void 0;t<4&&t>=0||((n=function(e){var t=new Date(o(O+"-01"));return t.setMonth(t.getMonth()+e),c(t)}(e))<L&&(n=L),n>R&&(n=R),O=n)},changeDepart:function(e){!V&&function(e){return P.lastIndex=0,P.exec(String(e))}(e)&&function(e){return M.getState("calendar").some(function(t){return t.planDate===e})}(e)&&(M.dispatch({type:g.CHANGE_DEPART_DATE,data:e}),1===M.getState("supportTrafficType")&&(M.dispatch({type:y.CHANGE_TRAIN_ADULT_TICKET,data:M.getState("adult")}),M.dispatch({type:y.CHANGE_TRAIN_CHILD_TICKET,data:M.getState("child")}),M.dispatch({type:y.CHANGE_ADULT_TICKET,data:M.getState("adult")}),M.dispatch({type:y.CHANGE_CHILD_TICKET,data:M.getState("child")})))},render:function(){this.renderMonth(),this.renderDate()},renderMonth:function(){A<=L?F.find(".calendar-prev").addClass("calendar-prev-disabled"):F.find(".calendar-prev").removeClass("calendar-prev-disabled"),A>=R?F.find(".calendar-next").addClass("calendar-next-disabled"):F.find(".calendar-next").removeClass("calendar-next-disabled"),F.find(".calendar-months").html(m.template.compile(b.calendarMonthTemplate)({list:function(){var e,t,n=[],i=new Date(o(O+"-01"));for(t=0;t<I;t++)(e=c(i))>=L&&e<=R&&n.push({month:e,price:j[e]}),i.setMonth(i.getMonth()+1);return n}(),current:A,nonEmptyMonth:j,infinity:1/0}))},renderDate:function(){var e=function(){var e=l(),t={};return M.getState("calendar").filter(function(t){return t.planDate>=e.start&&t.planDate<=e.end}).forEach(function(e){t[e.planDate]=e}),{all:e.all,date:t}}();e.current=M.getState("departDate"),e.today=N,F.find(".calendar-dates").html(m.template.compile(_.calendarDateTemplate)(e))},hideDateDetail:function(){v.layer.close(H)},showDateDetail:function(e,t){var n=function(e){var t=M.getState("calendar"),n=null;return t&&t.length&&t.some(function(t){if(t.planDate===e)return n=t,!0}),n}(e);n&&G.openDateDetail(n,t)},openDateDetail:function(e,t){H=v.layer.open({type:4,skin:"layui-layer-rim",area:["auto","auto"],content:[D(Object.assign({},e,{promotions:function(e){return J.filter(function(t){return!t.planDates||!Array.isArray(t.planDates)||!!~t.planDates.indexOf(e)})}(e.planDate)})),t],tips:3,shade:!1,fix:!1,closeBtn:!1,tipsOffset:[-1,-1]})},disable:function(){V=!0},enable:function(){V=!1}};t.calendarModule=G},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.calendarMonthTemplate='\n<ul>\n    <% for (var i = 0; i < list.length; i++) { %>\n        <% var item = list[i] %>\n        <li data-month="<%= item.month %>"\n            class="calendar-month\n            <% if (item.month === current) { %>calendar-month-active<% } %>\n            <% if (!item.price) { %>calendar-month-empty<% } %>">\n            <div class="calendar-month-date"><%= item.month.replace(\'-\', \'\') + \'\' %></div>\n            <% if (item.price) { %>\n                <% if (item.price < infinity) { %>\n                    <div class="calendar-month-price">&yen;<%= item.price %></div>\n                <% } else { %>\n                    <div class="calendar-month-price"></div>\n                <% } %>\n            <% } else { %>\n                <div class="calendar-month-none-price"></div>\n            <% } %>\n        </li>\n    <% } %>\n</ul>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.calendarDateTemplate="\n    <ul>\n        <% var weeks = ['sun', 'mon', 'tue', 'mon', 'thu', 'fri', 'sat']; %>\n        <% for(var i = 0; i < all.length; i++) { %>\n            <%\n                var currentDateObj = all[i];\n                var currentDate = currentDateObj.fullDate;\n                var dateObj = date[currentDate];\n            %>\n            <li data-date=\"<%= currentDate %>\"\n                class=\"calendar-date\n                    calendar-date-<%= weeks[i % 7] %>\n                    <%= (dateObj && currentDateObj.isInCurrentMonth) ? 'calendar-date-enabled' : ''%>\n                    <%= (currentDate === current && currentDateObj.isInCurrentMonth) ? 'calendar-date-active' : ''%>\n                    <%= currentDateObj.isInCurrentMonth ? '' : 'calendar-date-other'%>\">\n                <span class=\"calendar-date-number\">\n                    <%\n                    if (currentDate == today) {\n                        %><%\n                    } else if (currentDate == backDate) {\n                        %><%\n                    } else { %>\n                        <%= currentDateObj.date %>\n                    <% } %>\n                </span>\n                <% if (currentDateObj.isInCurrentMonth) { %>\n                    <div class=\"calendar-date-tag\">\n                        <% if (dateObj && (dateObj.cutPrice || dateObj.maxCoupon)) { %>\n                            <span class=\"calendar-date-tag-item calendar-date-tag-promotion\"></span>\n                        <% } %>\n                    </div>\n\n                    <div class=\"calendar-date-content\">\n                        <% if (dateObj) { %>\n                            <div class=\"calendar-date-rest\">&nbsp;</div>\n                            <% if (dateObj.isRealTimePrice == 1) { %>\n                                <div class=\"calendar-date-price\"></div>\n                            <% } else {%>\n                                <div class=\"calendar-date-price\">&yen;<%= dateObj.startPrice %></div>\n                            <% } %>\n                        <% } %>\n                    </div>\n                <% } %>\n            </li>\n        <% } %>\n\n    </ul>\n"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.calendarDetailTemplate='\n<div class="calendar-detail">\n    <div class="calendar-detail-price">\n        <% if (isRealTimePrice) { %>\n            \n        <% } else { %>\n            <% if (adultPrice) { %>\n                <span><strong>&yen;<%= adultPrice %></strong></span>\n            <% } %>\n\n            <% if(excludeChildFlag) { %>\n                <span></span>\n            <% } else if(childPrice) { %>\n                <span><strong>&yen;<%= childPrice %></strong></span>\n            <% } %>\n\n        <% } %>\n\n    </div>\n\n    <% if (isRealTimePrice != 1 && (cutPrice || maxCoupon)) { %>\n        <div class="calendar-detail-favor">\n            * <strong>&yen;<%= startPrice %></strong>\n            =\n             &yen;<%= adultPrice %>\n            <% if (cutPrice) { %>\n            -\n             &yen;<%= cutPrice %>\n            <% } %>\n            <% if (maxCoupon) { %>\n            -\n             &yen;<%= maxCoupon %>\n            <% } %>\n        </div>\n    <% } %>\n\n    <% if (isRealTimePrice != 1 && promotionIntro) { %>\n    <div class="calendar-detail-activity">\n        <%= promotionIntro %>\n    </div>\n    <% } %>\n\n    <% if (isRealTimePrice != 1 && flightTicketType == 2) { %>\n        <div class="calendar-detail-real">\n            \n        </div>\n    <% } %>\n\n    <% if (isRealTimePrice == 1) { %>\n        <div class="calendar-detail-real">\n            \n        </div>\n    <% } %>\n\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cityModule=void 0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=n(1),o=(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);t['default']=e}(n(57)),n(115)),r=void 0,s=void 0,c={init:function(e){var t=$("#J_ResourceDepartCity");s=e,r=(0,a.getStore)(),t.length&&new l(t,{selected:r.getState("departCityCode"),onchange:function(e,t,n){(0,o.record)("__//__"),function(e,t,n){var i=r.getState("journeyId");window.location=s.pageUrl({productId:r.getState("productId"),bookCityCode:e,departCity:t,backCityCode:n,journeyId:i})}(e,t,n)}})}},l=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=n||{},this.$container=$(t),this.$drop=this.$container.find(".resource-city-drop"),this.$selected=this.$container.find(".resource-city-more-selected"),this.$dropTab=this.$drop.find(".resource-city-drop-head"),this.$dropList=this.$drop.find(".resource-city-drop-list"),this.bind()}return i(e,[{key:"bind",value:function(){var e=this,t=$(document);t.click(function(){e.hideDrop()}).on("customclick",function(t,n){"city"!==n&&e.hideDrop()}),this.$container.on("click",function(e){t.trigger("customclick","city"),e.stopPropagation()}).hover(function(){},function(){}).on("click",".resource-city-more-label",function(){e.toggleDrop()}).on("click",".resource-city-drop-tab-item",function(){e.updateTab($(this).index())}).on("click",'.resource-city-drop-city-item:not(".active")',function(){e.change($(this).data("book"),$(this).data("code"),$(this).data("name"),$(this).data("back")),e.hideDrop()})}},{key:"updateTab",value:function(e){this.$container.find(".J_cityTab").removeClass("active").eq(e).addClass("active"),this.$container.find(".J_cityContent").removeClass("active").eq(e).addClass("active")}},{key:"change",value:function(e,t,n,i){t&&(this.update(t,n),this.options&&this.options.onchange&&this.options.onchange(e,t,i))}},{key:"update",value:function(e,t){this.$selected.html(t||""),this.$dropList.find(".J_cityItem").removeClass("active").filter("[data-code="+e+"]").addClass("active")}},{key:"toggleDrop",value:function(){this.$container.hasClass("expand")?this.hideDrop():this.showDrop()}},{key:"showDrop",value:function(){this.$container.addClass("expand")}},{key:"hideDrop",value:function(){this.$container.removeClass("expand")}}]),e}();t.cityModule=c},function(e,t,n){"use strict";function i(){h||(h=s.template.compile($("#J_ResourceCouponDialog").html())),f=c.layer.open({type:1,title:!1,closeBtn:!1,content:h({data:u.getState("coupon")}),area:["960px","auto"],btn:!1,success:function(e){!function(e){p=e,e.on("click",".dialog-close",a).find(".J_CouponItem").each(function(e){var t=$(this),n=t.data("id");t.find(".coupon-more");t.on("click",".coupon-button",function(){!function(e){l.isLogin()?function(e){$.ajax({url:d.couponReceiveUrl({couponId:e}),dataType:"json",success:function(t){t&&t.success?(function(e){var t=c.layer.open({type:1,title:!1,time:1500,content:'<div class="dialog-success"><div class="dialog-close"></div><i class="icon"></i>'+(e||"")+"</div>",area:["400px","auto"],btn:!1,closeBtn:!1,success:function(e){e.on("click",".dialog-close",function(){c.layer.close(t)})}})}(),function(e){p&&e&&(!function(e){var t=function(e){return(u.getState("coupon")||[]).filter(function(t){return t.id==e})[0]}(e);t&&(t.selected=!0)}(e),p.find(".J_CouponItem[data-id="+e+"]").addClass("selected"))}(e)):o(t&&t.message)},error:function(e){o(e&&e.message)}})}(e):(a(),l.open(function(){i()}))}(n)})});var t=e.find(".J_CouponMore"),n=e.find(".J_CouponDetail");$(document).click(function(){t.removeClass("expand"),n.hide()}),n.click(function(e){e.stopPropagation()}),t.click(function(e){e.stopPropagation();var i=$(this).data("id"),a=n.filter("[data-id="+i+"]");a.is(":visible")?($(this).removeClass("expand"),a.hide()):(t.removeClass("expand"),$(this).addClass("expand"),n.hide(),a.show())})}(e)}})}function a(){c.layer.close(f)}function o(e){var t=c.layer.open({type:1,title:!1,time:1500,content:'<div class="dialog-error"><div class="dialog-close"></div><i class="icon"></i>'+(e||"")+"</div>",area:["400px","auto"],btn:!1,closeBtn:!1,success:function(e){e.on("click",".dialog-close",function(){c.layer.close(t)})}})}Object.defineProperty(t,"__esModule",{value:!0}),t.favorModule=void 0;var r=n(1),s=n(14),c=n(10),l=(n(164),function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(480))),d=void 0,u=($(window),void 0),f=void 0,h=void 0,p=void 0,m={init:function(e){d=e,u=(0,r.getStore)(),$(".J_DetailCouponItem").click(i)}};t.favorModule=m},function(e,t,n){"use strict";function i(){return!!(0,o.getStore)().getState("isLogin")}function a(e){window.detailLoginCallback=function(){window.detailLoginCallback=null,(0,o.getStore)().dispatch({type:s.CHANGE_LOGIN_STATUS,data:!0}),e(),r.layer.close(t)};var t=r.layer.open({type:2,title:!1,content:[function(){var e=location.host.split(".")[0];return"https://passport.tuniu.com/login/iframe?origin="+encodeURIComponent("http://www.tuniu.com/ssoConnect/Iframe?reload=detail&domain="+e)}(),"no"],area:["375px","350px"],btn:!1});return t}Object.defineProperty(t,"__esModule",{value:!0}),t.open=t.login=t.isLogin=void 0;var o=n(1),r=n(10),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(390));t.isLogin=i,t.login=function(e){i()?e():a(e)},t.open=a},function(e,t,n){"use strict";function i(e){$.ajax({url:e.url,data:{productId:u.getState("productId"),productType:u.getState("productType"),bookCityCode:u.getState("bookCityCode")},success:e.success,error:e.error})}function a(){p=!0,h.addClass("active").find(".J_FavoriteLabel").text("")}function o(){p=!1,h.removeClass("active").find(".J_FavoriteLabel").text("")}function r(e){var t=c.layer.open({type:1,title:!1,time:void 0===e.time?1500:e.time,content:'<div class="dialog-'+(e.type||"success")+'"><div class="dialog-close"></div><i class="icon"></i>'+e.msg+"</div>",area:["400px","auto"],btn:!1,closeBtn:!1,success:function(e){e.on("click",".dialog-close",function(){c.layer.close(t)})}})}Object.defineProperty(t,"__esModule",{value:!0}),t.favoriteModule=void 0;var s=n(1),c=n(10),l={isFavorite:"/papi/tour/comment/isFavorite",add:"/papi/tour/comment/addFavorite",remove:"/papi/tour/comment/deleteFavorite"},d=void 0,u=($(window),void 0),f=void 0,h=void 0,p=!1,m={checkInitState:function(){$.ajax({url:l.isFavorite,data:{productId:u.getState("productId"),productType:u.getState("productType")},success:function(e){e&&e.data&&e.data.isCollected?a():o()},error:function(){o()}})},add:function(){$.ajax({url:l.add,data:{productId:u.getState("productId"),productType:u.getState("productType"),price:u.getState("lowestPromoPrice"),bookCityCode:u.getState("bookCityCode")},success:function(e){e&&e.data&&e.data.inserted?(a(),r({msg:""})):r({type:"error",msg:""})},error:function(){r({type:"error",msg:""})}})},remove:function(){$.ajax({url:l.remove,data:{productId:u.getState("productId"),productType:u.getState("productType")},success:function(e){e&&e.data&&e.data.isDeleted?(o(),r({msg:""})):r({type:"error",msg:""})},error:function(){r({type:"error",msg:""})}})}},v={init:function(e){d=e,u=(0,s.getStore)(),f=u.getState("productType"),h=$(".J_Favorite"),u.getState("isLogin")&&(83===f?m.checkInitState():$.ajax({url:d.checkFavoriteStateUrl(),data:{productId:u.getState("productId"),bookCityCode:u.getState("bookCityCode")},success:function(e){e&&e.data&&e.data.isCollected?a():o()},error:function(){o()}})),function(){h.click(function(){u.getState("isLogin")?p?83===f?m.remove():i({url:d.removeFavoriteUrl(),success:function(e){e&&e.data&&e.data.isSuccess?(o(),r({msg:""})):r({type:"error",msg:""})},error:function(){r({type:"error",msg:""})}}):83===f?m.add():i({url:d.addFavoriteUrl(),success:function(e){e&&e.data&&e.data.isSuccess?(a(),r({msg:""})):r({type:"error",msg:""})},error:function(){r({type:"error",msg:""})}}):r({msg:'<a class="dialog-login-button" href="https://passport.tuniu.com/login?origin='+encodeURIComponent(location.href)+'"></a><br><a class="dialog-login-button" href="https://passport.tuniu.com/register" target="_blank"></a>',time:0})});var e=$(".weixin_dialog");$(".resource-button-weixin").click(function(t){t.stopPropagation(),e.toggleClass("active")}),e.on("click",function(e){e.stopPropagation()}),$(document).click(function(){e.removeClass("active")})}()}};t.favoriteModule=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.journeyModule=void 0;n(1);var i=void 0,a={init:function(e){i=e||{},this.$container=$("#J_JourneyList"),this.bind()},bind:function(){this.$container.on("click",'.J_journeyItem:not(".active")',function(){!function(e){window.location.search=i.journeyUrl(e)}($(this).data("journey"))})}};t.journeyModule=a},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}function a(e){p.feeModule.load(D.get())}function o(e){if("drive"==I.getState("productTypeName")){var t=[];e.mainResParams.selectHotel.forEach(function(e){if(1==e.isJiBao&&2==e.hoteltype){var n={hotelId:e.hotelId,roomId:e.roomId,productId:I.getState("productId"),vendorId:e.vendorId,vendorResId:e.vendorResId,lastCheckInTime:null,roomNum:e.num,adultNum:e.maxAdultNum,childNum:e.maxChildNum,checkIn:e.departDate,checkOut:e.backDate};t.push(n)}}),t.length?function(e,t){$.ajax({type:"GET",url:f.config.url.checkHotelPrice(),data:{d:JSON.stringify({hotelRatePlans:e})},dataType:"json",success:function(e){if(e.success&&e.data&&e.data.hotelRatePlans&&e.data.hotelRatePlans.length&&e.data.hotelRatePlans[0].callFlag){var n=[];if(t.mainResParams.selectHotel.forEach(function(t){1==t.isJiBao&&e.data.hotelRatePlans.forEach(function(e){if(e.hotelId==t.hotelId&&e.roomId==t.roomId&&e.callFlag){var i=e.ratePlanTotalPrice-t.price*t.num;0!=i&&(i<0?n.push(t.resourceHotelRoom.hotelChineseName+""+-i+""):n.push(t.resourceHotelRoom.hotelChineseName+""+i+""),t.resourceHotelRoom.resourceId=e.resId,t.resourceHotelRoom.price=e.ratePlanTotalPrice)}})}),n.length)var i=_.layer.open({type:1,title:!1,content:P({diffMessage:n}),area:["400px","auto"],btn:!1,closeBtn:!1,success:function(e){e.on("click",".dialog-close",function(){_.layer.close(i)}),e.on("click",".cancel-sure",function(){_.layer.close(i),r(t)}),e.on("click",".cancel-no",function(){_.layer.close(i)})},end:function(){}});else r(t)}else r(t)},error:function(){}})}(t,e):r(e)}else r(e)}function r(e){$.ajax({type:"post",url:f.config.url.saveOrder(),data:(0,b.base64Encode)(JSON.stringify(e)),dataType:"json",beforeSend:function(){},complete:function(){},success:function(e){e&&e.success?location.href=e.next:alert(N.orderTip.error)},error:function(){alert(N.orderTip.error)}})}function s(){return I.dispatch({type:u.CHECK_FLIGHT_RES_FAIL,data:-1}),S.addClass("loading"),function(){M++;(0,l.getStore)().getState("productType");return c(M)}().then(function(e){D.load(v.formater.formatResourceData(e)),p.feeModule.load(D.get()),S.removeClass("loading"),$(window).trigger("resize")})['catch'](function(e){e===N.requestStatus.abort||(D.load({data:{lack:1}}),S.removeClass("loading"))})}function c(e){return Promise.all([y.fetcher.defaultResource.fetchDefaultResourceP(),y.fetcher.bus.fetchDefaultBusP()]).then(function(e){return Object.assign({},e[0],{bus:e[1]})}).then(function(e){return 1==e.supportTrafficType&&(!e.wholeJourney||e.wholeJourney&&0==e.wholeJourney.lackTrainFlag&&(!e.wholeJourney.trainTicket||e.wholeJourney.trainTicket.length<1))&&I.dispatch({type:u.SET_MIXED_TYPE,data:2}),I.dispatch({type:u.SET_TRAFFIC_TYPE,data:e.supportTrafficType}),I.dispatch({type:d.CHANGE_JOURNEY_DAY,data:e.journeyDay}),e.visaUrl&&""!=e.visaUrl&&I.dispatch({type:u.INIT_VISA_FLAG,data:[1]}),y.fetcher.combination.fetchCombinedDataP(e.journeyDay).then(function(t){return t&&(e.combined=t),e})}).then(function(t){if(e!==M)throw N.requestStatus.abort;return t})}Object.defineProperty(t,"__esModule",{value:!0}),t.productModule=void 0;var l=n(1),d=i(n(57)),u=i(n(58)),f=n(19),h=n(484),p=n(491),m=n(493),v=n(538),g=n(539),y=n(393),b=n(540),_=(n(53),n(10)),k=i(n(11)),C=function(e){return e&&e.__esModule?e:{default:e}}(n(541)),T=n(544),w=i(n(108)),N=n(160),I=void 0,D=void 0,S=$("#J_product"),x=($(document),k.compile('\n    <div class="cancel">\n        <div class="cancel-title"><span></span></div>\n        <div class="dialog-close cancel-icon"></div>\n        <div class="cancel-content"><%= cancelDesc %></div>\n        <div class="cancel-sure"></div>\n    </div>\n',{client:!0,compileDebug:!1})),P=k.compile('\n    <div class="cancel">\n        <div class="cancel-title"><span></span></div>\n        <div class="dialog-close cancel-icon"></div>\n        <div class="cancel-content"><%= diffMessage.join(\'<br>\') %></div>\n        <div class="cancel-box">\n            <div class="cancel-sure"></div>\n            <div class="cancel-no"></div>\n        </div>\n    </div>\n',{client:!0,compileDebug:!1}),M=(t.productModule={init:function(){I=(0,l.getStore)(),h.toolbarModule.init(),p.feeModule.init(),D=(0,m.resource)({el:$("#J_ResourceContent")}),$("#J_SubmitBasis").click(function(){var e=$("#J_product").offset().top;$("html,body").animate({scrollTop:e},300)}),$("#J_SubmitResource").click(function(){if(0==I.getState("status")||D.get("status")!==N.resourceStatus.normal)return!1;var e=(0,g.formatOrderData)(D.get()),t=(0,l.getStore)().getState("cancelDesc");if(t=t.join(";"))var n=_.layer.open({type:1,title:!1,content:x({cancelDesc:t}),area:["400px","auto"],btn:!1,closeBtn:!1,success:function(t){t.on("click",".dialog-close",function(){_.layer.close(n)}),t.on("click",".cancel-sure",function(){_.layer.close(n),o(e)})},end:function(){}});else o(e);return!0}),I.subscribe(s,"change:departDate"),I.subscribe(s,"change:adult"),I.subscribe(s,"change:child"),I.subscribe(s,"change:freeChild"),I.subscribe(function(){!function(e){var t=$(".J_DetailVisa");t.show(),$('.detail-tab-item[data-rel=".J_DetailVisa"]').show(),w.on(t,function(){w.off(t);var n=new C['default']({$el:t,journeyList:e});T.fetchVisa.fetch(function(e){n.load(e),n.render()},function(){n.remove()})})}(I.getState("initVisa"))},"change:initVisa"),D.on("change:select",a),D.on("change:selectNum",a),D.on("change:selectedPackId",a),D.on("change:selected",a),D.on("load",a),D.on("load:flight",a),D.on("change:flightPrice",a),D.on("change:status",function(e){e.data.value===N.resourceStatus.loading?(p.feeModule.enableLoading(),p.feeModule.showLoading()):(p.feeModule.disableLoading(),a()),h.toolbarModule.update(e.data.value)}),s()}},0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toolbarModule=void 0;n(1);var i=n(485),a=n(487),o=n(117),r=n(160),s=t.toolbarModule={init:function(){i.dateModule.init(),a.touristModule.init();var e=$("#J_toolbar");e.height(e.height()),(0,o.createFixer)(e,{range:{bottom:$("#J_product")}});var t=$("#J_toolbarFeeDetail"),n=$("#J_fee"),r=void 0;t.hover(function(){var e='<div class="fee fee-float">'+n.html()+"</div>";r=layer.open({type:4,skin:"layui-layer-rim",area:["auto"],content:[e,t],tips:3,shade:!1,fix:!1,closeBtn:!1,tipsOffset:[10,-27]})},function(){layer.close(r)})},update:function(e){if(e!=r.resourceStatus.loaded){$("#J_toolbar");var t=!1,n=void 0;switch(e){case r.resourceStatus.loading:n="loading",t=!0;break;case r.resourceStatus.saleout:n="disabled";break;case r.resourceStatus.normal:n="normal"}t?s.disable():s.enable(),$("#J_toolbar").removeClass("loading disabled normal").addClass(n)}},disable:function(){i.dateModule.disable(),a.touristModule.disable()},enable:function(){i.dateModule.enable(),a.touristModule.enable()}}},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}function a(){var e=g.offset(),t=(g.width(),v.width());return e.top+=g.height()+10,e.arrowLeft=28,e.left+650>t&&(e.arrowLeft=e.arrowLeft+e.left+650-t,e.left=e.left-(e.left+650-t)),e}Object.defineProperty(t,"__esModule",{value:!0}),t.dateModule=void 0;var o=n(1),r=(n(14),i(n(159))),s=n(486),c=n(115),l=i(n(58)),d=i(n(57)),u=r.getYMDDate(new Date),f=4,h=200,p=void 0,m=!1,v=$(window),g=void 0,y=void 0,b=void 0,_=void 0,k=!1,C={init:function(){p=(0,o.getStore)(),g=$("#J_ResourceDate"),y=g.find(".date-selected"),b=(0,s.createDatePanel)(),p.getState("calendar")?(C.bind(),C.update()):p.subscribe(function(){C.bind(),C.update()},"change:calendar")},bind:function(){var e=$(document),t=$(window);e.click(function(){C.hideDatePicker()}).on("customclick",function(e,t){"date"!==t&&C.hideDatePicker()}),t.on("scroll resize",function(){clearTimeout(_),_=setTimeout(function(){m&&b&&b.position(a())},50)}),g.click(function(t){k||(C.toggleDatePicker(),e.trigger("customclick","date"),t.stopPropagation())}),p.subscribe(function(){C.update()},"change:departDate")},change:function(e){p.dispatch({type:l.CHANGE_DEPART_DATE,data:e}),1===p.getState("supportTrafficType")&&(p.dispatch({type:d.CHANGE_TRAIN_ADULT_TICKET,data:p.getState("adult")}),p.dispatch({type:d.CHANGE_TRAIN_CHILD_TICKET,data:p.getState("child")}),p.dispatch({type:d.CHANGE_ADULT_TICKET,data:p.getState("adult")}),p.dispatch({type:d.CHANGE_CHILD_TICKET,data:p.getState("child")})),C.update(),(0,c.record)("__//__")},update:function(){var e=function(e){var t=p.getState("calendar"),n=null;return t&&t.length&&t.some(function(t){if(t.planDate===e)return n=t,!0}),n}(p.getState("departDate"));if(e){var t=e.planDate;y.html([t,"  ",r.getWeek(t),""].join(""))}},toggleDatePicker:function(){m?C.hideDatePicker():C.showDatePicker()},showDatePicker:function(){var e=p.getState("departDate")||(p.getState("calendar")[0]||{}).planDate||u,t=new Date(r.justifyDate(e));b.open({type:2,year:t.getFullYear(),month:t.getMonth(),current:p.getState("departDate"),dateList:function(){var e={};return p.getState("calendar").forEach(function(t){e[t.planDate]=!0}),e}(),min:r.getNowDate(),onChange:function(e){C.change(e)}},a()),m=!0},hideDatePicker:function(){b.close(),m=!1},flash:function(){function e(){t%2?g.addClass("flashed"):g.removeClass("flashed"),(t%2!=0||t<f)&&(t++,setTimeout(e,h))}var t=1;e()},disable:function(){k=!0},enable:function(){k=!1}};t.dateModule=C},function(e,t,n){"use strict";function i(e){return"string"==typeof e?new Date(e.replace(/\-/g,"/")):e}function a(e,t){for(t=t||2,e=parseInt(e)+"";e.length<t;)e="0"+e;return e}function o(e){return e.getFullYear()+"-"+a(e.getMonth()+1)+"-"+a(e.getDate())}function r(e,t){var n=new Date(e,t,1),i=n.getDay();return 0!==i?n.setDate(1-i):n.setDate(-6),o(n)}function s(e,t,n){var a=new Date(e,t+1,0),r=a.getDay();return 6!==r&&a.setDate(a.getDate()+6-r),function(e,t){return"string"==typeof e&&(e=i(e)),"string"==typeof t&&(t=i(t)),Math.floor((t-e)/864e5)}(n,a)<41&&a.setDate(a.getDate()+7),o(a)}function c(){return o(new Date)}function l(){this.init()}function d(e,t){var n,a=i(t.current||new Date);this.config={},this.set($.extend({},p,t)),this.__fullDate=o(a),this.__year=a.getFullYear(),this.__month=a.getMonth(),this.__date=a.getDate(),t.dateList&&$.isArray(t.dateList)&&(n={},$.each(t.dateList,function(e,t){n[t]=!0}),this.__dateList=n),this.set("min",t.min||o(new Date)),this.set("max",t.max),this.__panel=m(),this.__target=$(e),this.init()}function u(e,t){return new d(e,t||{})}Object.defineProperty(t,"__esModule",{value:!0});var f='<div class="dp-box"><div class="dp-month">{month}</div><div class="dp-days"><div class="dp-weeks"><div class="dp-week dp-weekend"></div><div class="dp-week"></div><div class="dp-week"></div><div class="dp-week"></div><div class="dp-week"></div><div class="dp-week"></div><div class="dp-week dp-weekend"></div></div><div class="dp-cale">{cale}</div></div></div>',h={type:1,year:2015,month:6};l.prototype={init:function(){var e=this,t=$('<div class="dp-panel"><span class="dp-arrow"><i></i></span><div class="dp-btns"><div class="dp-btn dp-prev">&lt;</div><div class="dp-btn dp-next">&gt;</div></div><div class="dp-wrap"></div></div>');this.hovered=!1,this.prevBtn=t.find(".dp-prev"),this.nextBtn=t.find(".dp-next"),this.monthTit=t.find(".dp-month"),this.caleWrap=t.find(".dp-wrap"),this.wrap=t,this.config={type:1,year:2015,month:6},t.on("click",".dp-date-item",function(t){e.select($(t.currentTarget).data("date")),e.hovered=!1,e.wrap.hide()}),t.on("mousedown",function(e){e.stopPropagation(),e.preventDefault()}).hover(function(){e.hovered=!0},function(){e.hovered=!1}),this.nextBtn.click(function(){e.nextMonth()}),this.prevBtn.click(function(){e.prevMonth()}),t.appendTo("body")},open:function(e,t){this.set(e),this.render(),this.show(t)},show:function(e){var t=0;this.wrap.css({left:e.left,top:e.top}).show(),this.wrap.find(".dp-arrow").css({left:e.arrowLeft}),this.caleWrap.find(".dp-box").each(function(e){t+=$(this).width()}),this.caleWrap.width(t)},position:function(e){e&&this.wrap.css({left:e.left,top:e.top})},close:function(){this.hovered||this.wrap.hide()},select:function(e){var t,n,a,o;n=(t=i(e)).getMonth(),a=this.get("month"),o=this.get("onChange"),this.set("current",e),o&&function(e){return"function"==typeof e}(o)&&o(e),n<a||n>a+this.get("type")-1?this.goMonth(t.getFullYear(),t.getMonth()):this.updateView()},goMonth:function(e,t){this.set("year",e),this.set("month",t),this.render()},prevMonth:function(){var e=new Date(this.get("year"),this.get("month")-this.get("type"),1);this.goMonth(e.getFullYear(),e.getMonth())},nextMonth:function(){var e=new Date(this.get("year"),this.get("month")+this.get("type"),1);this.goMonth(e.getFullYear(),e.getMonth())},set:function(e,t){"string"==typeof e&&void 0!==t?this.config[e]=t:this.config=$.extend({},h,e)},get:function(e){return this.config[e]},render:function(){switch(this.get("type")){case 1:this.renderSingleBox();break;default:this.renderMultiBox()}},getMonthTit:function(e,t){return(e||this.get("year"))+""+((void 0===t?this.get("month"):t)+1)+""},renderSingleBox:function(){var e=this.get("year"),t=this.get("month"),n=r(e,t),i=s(e,t,n),a=this.buildSingleView(n,i);this.caleWrap.removeClass("dp-multi").html(a)},buildSingleView:function(e,t){var n=i(e),a=c(),r=e,s=this.get("min"),l=this.get("max"),d=this.get("current"),u=this.get("dateList"),h=[],p=1,m=f;for(h.push('<div class="dp-dates">');r<=t;)h.push('<div class="dp-date '),r===a&&h.push(" dp-now"),r===d&&h.push(" dp-selected"),h.push('">'),r<s||t&&r>t||l&&r>l||u&&!u[r]?h.push('<span class="dp-date-disabled"><i>'+(r==a?"":n.getDate())+"</i></span>"):h.push('<a class="dp-date-item" data-date="'+r+'" href="javascript:;"><i>'+(r==a?"":n.getDate())+"</i></a>"),h.push("</div>"),n.setDate(n.getDate()+1),r=o(n),p++;return h.push("</div>"),m.replace(/\{month\}/,this.getMonthTit()).replace(/\{cale\}/,h.join(""))},renderMultiBox:function(){var e=this.get("type");this.caleWrap.empty();for(var t=0;t<e;t++)this.caleWrap.append(this.buildMultiSingleView(this.get("year"),this.get("month")+t));this.caleWrap.addClass("dp-multi").children().first().addClass("dp-box-l").end().last().addClass("dp-box-r")},buildMultiSingleView:function(e,t){var n,a,l=r(e,t),d=s(e,t,l),u=function(e,t){return o(new Date(e,t,1))}(e,t),h=function(e,t){return o(new Date(e,t+1,0))}(e,t),p=i(u),m=p.getFullYear(),v=p.getMonth(),g=this.get("current"),y=this.get("min"),b=this.get("max"),_=this.get("dateList"),k=i(l),C=c(),T=l,w=[],N=1,I=f;for(w.push('<div class="dp-dates">');T<=d;)n=T<y||d&&T>d||b&&T>b||_&&!_[T],a=T>=u&&T<=h,w.push('<div class="dp-date'),T===C&&w.push(" dp-now"),T===g&&T>=u&&T<=h&&w.push(" dp-selected"),n?w.push(" dp-disabled"):w.push(" dp-enabled"),a||w.push(" dp-other"),w.push('">'),a?n?w.push('<span class="dp-date-disabled"><i>'+(T==C?"":k.getDate())+"</i></span>"):w.push('<a class="dp-date-item" data-date="'+T+'" href="javascript:;"><i>'+(T==C?"":k.getDate())+"</i></a>"):w.push('<span class="dp-date-disabled"></span>'),w.push("</div>"),k.setDate(k.getDate()+1),T=o(k),N++;return w.push("</div>"),I.replace(/\{month\}/,this.getMonthTit(m,v)).replace(/\{cale\}/,w.join(""))},updateView:function(){this.caleWrap.find(".dp-selected").removeClass("dp-selected").end().find("[data-date="+this.get("current")+"]").parent().addClass("dp-selected")}};var p={type:2};d.prototype={init:function(){var e=this;this.__target.on("focus",function(){e.open()}).on("blur",function(){e.close()}).on("change",function(){e.__fullDate=this.value}).prop({readonly:!0})},open:function(){var e=this,t=this.__target.offset(),n=(this.get("onChange"),this.get("min")),i=this.get("max");t.top=t.top+this.__target.outerHeight(),this.getSelected(),this.__panel.open({type:this.config.type,year:this.__year,month:this.__month,current:this.__fullDate,dateList:this.__dateList,min:$.isFunction(n)?n():n,max:$.isFunction(i)?i():i,onChange:function(t){e.select(t)}},t)},close:function(){this.__panel.close()},getSelected:function(){var e=this.__target.val()||this.__fullDate,t=i(e);this.__fullDate=e,this.__year=t.getFullYear(),this.__month=t.getMonth(),this.__date=t.getDate()},select:function(e){var t=i(e),n=this.get("onChange")||function(){};t!==this.__fullDate&&(this.__fullDate=e,this.__year=t.getFullYear(),this.__month=t.getMonth(),this.__date=t.getDate(),this.__target.val(e).trigger("change"),n(e)),this.__target.blur(),this.close()},set:function(e,t){"string"==typeof e?t&&(this.config[e]=t):this.config=$.extend({},p,e)},get:function(e){return this.config[e]}};var m=function(e){var t,n=!1;return function(){return n?t:(n=!0,t=e.apply(this,arguments),e=null,t)}}(function(){return new l});$.fn.datePicker=function(){var e=arguments;return this.each(function(){var t,n=e[0];"string"==typeof n?(t=$(this).data("datePicker"))&&$.isFunction(t[n])&&t[n].apply(t,Array.prototype.slice.call(e,1)):$(this).data("datePicker",u($(this),n))})},t.createDatePicker=u,t.createDatePanel=m},function(e,t,n){"use strict";function i(e){var t="",n=m.getState("proMode");switch(e){case"child":t=6==n?(t=(t=m.getState("childrenPriceTip")||"11.2-1.5 2").replace(/\s/g,"")).replace(/<br>/g,""):m.getState("childrenPriceTip");break;case"freeChild":t=6==n?(t=(t=m.getState("freeChildPriceTip")||"1.19").replace(/\s/g,"")).replace(/<br>/g,""):m.getState("freeChildPriceTip")}return t}function a(e){return"adult"===e?1:0}function o(e){if("freeChild"==e){return m.getState("adult")}return 50}function r(){return 6==m.getState("proMode")||17==m.getState("proMode")&&3===m.getState("mixedTrafficType")}Object.defineProperty(t,"__esModule",{value:!0}),t.touristModule=void 0;var s=n(1),c=n(14),l=n(10),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(57)),u=n(488),f=n(115),h=n(489),p=n(490),m=void 0,v=void 0,g=void 0,y=void 0,b=c.template.compile(h.touristChildTipTemplate),_=c.template.compile(p.touristTipTemplate),k=!1,C={init:function(){(m=(0,s.getStore)()).subscribe(function(){this.initSelect()}.bind(this),"change:calendar"),m.subscribe(function(){this.initSelect()}.bind(this),"change:departDate"),m.subscribe(function(){this.initFreeChild()}.bind(this),"change:mixedTrafficType"),m.subscribe(function(){v&&v.set(m.getState("adult")),this.updateRelation()}.bind(this),"change:adult"),m.subscribe(function(){g&&g.set(m.getState("child")),this.updateRelation()}.bind(this),"change:child"),m.subscribe(function(){y&&y.set(m.getState("freeChild")),this.updateRelation()}.bind(this),"change:freeChild"),m.getState("calendar")&&this.initSelect()},initSelect:function(){this.initAdult(),this.initChild(),17!==m.getState("proMode")&&this.initFreeChild()},initAdult:function(){if(!v){var e=$("#J_ResourceAdult");v=(0,u.createNumberSelect)(e.find(".number-select"),{min:a("adult"),max:o("adult"),autoSet:!1,defaultValue:m.getState("adult"),drop:{enable:!0},onchange:this.changeAdult.bind(this)})}},initChild:function(){if(!g){var e=$("#J_ResourceChild");g=(0,u.createNumberSelect)(e.find(".number-select"),{min:a("child"),max:o("child"),autoSet:!1,defaultValue:m.getState("child"),drop:{enable:!0},onchange:this.changeChild.bind(this)});var t=i("child"),n=m.getState("proMode");if(t){var r=void 0,s=$(_({type:"child",tip:t,proMode:n}));e.find(".number-select").after(s),s.hover(function(){r=l.layer.open({type:4,skin:"layui-layer-rim",area:["200px","auto"],content:[b({content:s.data("tip")}),s],tips:3,shade:!1,fix:!1,closeBtn:!1,tipsOffset:[10,-27]})},function(){l.layer.close(r)})}}},initFreeChild:function(){if(r()&&!y){var e=$("#J_ResourceFreeChild"),t=$("#J_SubmitResource span"),n=$("#J_product");y=(0,u.createNumberSelect)(e.find(".number-select"),{min:a("freeChild"),max:o("freeChild"),autoSet:!1,defaultValue:m.getState("freeChild"),drop:{enable:!0},onchange:this.changeFreeChild.bind(this)}),e.parent().show(),t.hide(),n.addClass("has-train");var s=m.getState("proMode"),c=i("freeChild");if(c){var d=void 0,f=$(_({type:"freeChild",tip:c,proMode:s}));e.find(".number-select").after(f),f.hover(function(){d=l.layer.open({type:4,skin:"layui-layer-rim",area:["200px","auto"],content:[b({content:f.data("tip")}),f],tips:3,shade:!1,fix:!1,closeBtn:!1,tipsOffset:[10,-27]})},function(){l.layer.close(d)})}}},changeAdult:function(e){m.dispatch({type:d.CHANGE_ADULT,data:e}),1===m.getState("supportTrafficType")&&(m.dispatch({type:d.CHANGE_TRAIN_ADULT_TICKET,data:e}),m.dispatch({type:d.CHANGE_TRAIN_CHILD_TICKET,data:m.getState("child")}),m.dispatch({type:d.CHANGE_ADULT_TICKET,data:e}),m.dispatch({type:d.CHANGE_CHILD_TICKET,data:m.getState("child")})),(0,f.record)("__//__")},changeChild:function(e){m.dispatch({type:d.CHANGE_CHILD,data:e}),1===m.getState("supportTrafficType")&&(m.dispatch({type:d.CHANGE_TRAIN_ADULT_TICKET,data:m.getState("adult")}),m.dispatch({type:d.CHANGE_TRAIN_CHILD_TICKET,data:e}),m.dispatch({type:d.CHANGE_ADULT_TICKET,data:m.getState("adult")}),m.dispatch({type:d.CHANGE_CHILD_TICKET,data:e})),(0,f.record)("__//__")},changeFreeChild:function(e){m.dispatch({type:d.CHANGE_FREE_CHILD,data:e}),(0,f.record)("__//__")},updateRelation:function(){11==m.getState("tagType")&&(v&&v.config({min:a("adult")}),g&&g.config({min:a("child")})),r()&&(g&&g.config({max:o("child")}),y&&y.config({max:o("freeChild")}))},disable:function(){k=!0,v&&v.disable(),g&&g.disable(),y&&y.disable()},enable:function(){k=!1,v&&v.enable(),g&&g.enable(),y&&y.enable()}};t.touristModule=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a={min:-1/0,max:1/0,minus:!0,plus:!0,defaultValue:1,autoSet:!0,selectors:{minus:".number-select-minus",plus:".number-select-plus"},drop:{enable:!1}},o=[],r=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$container=$(t),this.options=Object.assign({},a,n),this.value=this.options.defaultValue,this.minusDisabled=!1,this.plusDisabled=!1,this.disabled=!1,this.init(),this.bind(),this.update(),this.updateView()}return i(e,[{key:"init",value:function(){this.initDrop()}},{key:"initDrop",value:function(){this.isDropEnabled()&&this.$container.append('<div class="number-select-drop"></div>')}},{key:"isDropEnabled",value:function(){return!0===(this.options.drop||{}).enable}},{key:"showDrop",value:function(){var e=this.$container.find(".number-select-drop");e.show(),e.scrollTop(0);var t=e.find(".active").position();t&&e.scrollTop(t.top)}},{key:"hideDrop",value:function(){this.$container.find(".number-select-drop").hide()}},{key:"bind",value:function(){var e=this;this.$container.on("click",this.options.selectors.minus,this.minus.bind(this)).on("click",this.options.selectors.plus,this.plus.bind(this)).on("change","input",function(e){this.change(e.target.value)}.bind(this)),this.isDropEnabled()&&($(document).click(function(){e.hideDrop()}),this.$container.on("focus","input",function(){e.disabled||function(e){o.forEach(function(t){t===e?t.showDrop():t.hideDrop()})}(e)}).on("click","input",function(e){e.stopPropagation()}),this.$container.on("click",".number-select-drop-item",function(t){t.stopPropagation(),e.change(parseInt($(this).data("value"))),e.hideDrop()}))}},{key:"set",value:function(e){this.value=e,this.update(),this.updateView()}},{key:"excuteCallback",value:function(e){try{this.options.onchange&&this.options.onchange(e)}catch(e){}}},{key:"changeNumber",value:function(e){this.excuteCallback(e),this.options.autoSet&&this.set(e)}},{key:"config",value:function(e,t){var n={};t?n[e]=t:n=e,this.options=Object.assign({},this.options,n),this.update(),this.updateView()}},{key:"plus",value:function(){this.disabled||this.plusDisabled||this.changeNumber(this.value+1)}},{key:"minus",value:function(){this.disabled||this.minusDisabled||this.changeNumber(this.value-1)}},{key:"change",value:function(e){this.disabled||(e=parseInt(e,10),!isNaN(e)&&e!==this.value&&e>=this.options.min&&e<=this.options.max?this.changeNumber(e):this.updateView())}},{key:"update",value:function(){var e=!1;this.minusDisabled=this.value<=this.options.min,this.plusDisabled=this.value>=this.options.max,this.value<this.options.min&&(this.value=this.options.min,e=!0),this.value>this.options.max&&(this.value=this.options.max,e=!0),e&&this.excuteCallback(this.value)}},{key:"updateView",value:function(){var e=this.disabled,t=e||this.minusDisabled,n=e||this.plusDisabled;this.buildDrop(),this.$container.find(this.options.selectors.minus)[t?"addClass":"removeClass"]("disabled").end().find(this.options.selectors.plus)[n?"addClass":"removeClass"]("disabled").end().find("input").prop("disabled",!!e).val(this.value)}},{key:"buildDrop",value:function(){if(this.isDropEnabled()){var e=this.options.max,t=this.value,n=void 0,i=[];for(n=this.options.min;n<=e;n++)i.push('<div class="number-select-drop-item',t==n?" active":"",'" data-value="',n,'">',n,"</div>");this.$container.find(".number-select-drop").html(i.join(""))}}},{key:"remove",value:function(){this.$container&&(this.$container.remove(),this.$container=null),this.options=null}},{key:"disable",value:function(){this.disabled=!0,this.updateView()}},{key:"enable",value:function(){this.disabled=!1,this.updateView()}}]),e}();t.NumberSelect=r,t.createNumberSelect=function(e,t){var n=new r(e,t);return o.push(n),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.touristChildTipTemplate='\n<div class="resource-tourist-child-tip">\n    <%= content %>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.touristTipTemplate='\n<% if (type === \'child\' && proMode == 6) { %>\n    <i class="J_ResourceChildTip icon icon-tip icon-question" data-tip= <%= tip %>></i>\n<% } else if (type === \'child\' && tip && proMode != 6) {%>\n\t<i class="J_ResourceChildTip icon icon-tip icon-question" data-tip="212"></i>\n<% } %>\n<% if (type === \'freeChild\' &&  proMode == 6) { %>\n    <i class="J_ResourceFreeChildTip icon icon-tip icon-question" data-tip= <%= tip %>></i>\n<% } else if (type === \'freeChild\' && tip && proMode != 6) {%>\n    <i class="J_ResourceFreeChildTip icon icon-tip icon-question" data-tip="11.21.2-1.51.5"></i>\n<% } %>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.feeModule=void 0;var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(1),o=n(117),r=n(492),s=window.location.hash,c=i.compile(r.feeTemplate,{client:!0,compileDebug:!1}),l=void 0,d=$("#J_feeOuter"),u=$("#J_fee"),f=u.find(".J_feeBody"),h=!1,p={flight:"",train:"",bus:"",hotel:"",ticket:"",pack:"",mandatory:"",timeLimitFree:"",requireAddition:""},m=t.feeModule={init:function(){l=(0,a.getStore)();var e=$("#J_ResourceContent"),t=($("#J_product"),$("#J_toolbar"));(0,o.createFixer)(d,{offset:{left:0,top:t.height()+5},range:{bottom:e,right:d}})},load:function(e){h?m.showLoading():m.loadDetail(e)},showLoading:function(){f.html(""),$(".J_totalFee").html("<strong>...</strong>")},loadDetail:function(e){var t=function(e){var t=0,n=[],i=l.getState("adult"),a=l.getState("child"),o=(l.getState("freeChild"),1===l.getState("supportTrafficType")),r={};e.children.forEach(function(e){var s={title:"",price:0,list:[]},c={title:"",price:0,list:[]};if("recommend"==e.type){var d=0;e.children.forEach(function(t){t.children.forEach(function(t){t.children.forEach(function(t){var n=t.data||[];if(e.journeyDay,void 0===n.isIcon&&(n.selectedNum||n.selectedChildNum)&&1===n.selected){var i=void 0,a=void 0;if(!n.selectedNum&&!n.selectedChildNum)return;i=n.useDate.filter(function(e){return e.departDate==n.selectedDate})[0]||n.useDate[0],a=1==n.sellRule?n.selectedNum*i.adultPrice*n.journeyDay:i.adultPrice*n.selectedNum+i.childPrice*n.selectedChildNum,d+=a,s.list.push({name:n.resourceName,price:a}),s.price+=a}})})}),t+=d}else if("locale"==e.type){var u=0;e.children.forEach(function(t){""===t.data.title?(r.timeLimitFree=r.timeLimitFree||[],r.timeLimitFree.push(0)):t.children.forEach(function(t){(t.children||[]).forEach(function(t){var n=t.data,i=e.data.journeyDay;if(void 0===n.isIcon&&(n.selectedNum||n.selectedChildNum)&&1===n.selected){var a=void 0,o=void 0;if(!n.selectedNum&&!n.selectedChildNum)return;a=n.useDate.filter(function(e){return e.departDate==n.selectedDate})[0]||n.useDate[0],o=1==n.sellRule?n.selectedNum*a.adultPrice*i:a.adultPrice*n.selectedNum+a.childPrice*n.selectedChildNum,u+=o,r.mandatory=r.mandatory||[],r.mandatory.push(o)}})})}),t+=u}else e.children.forEach(function(e){switch(e.type){case"pack":var n=e.children.filter(function(e){return e.data.selected})[0];n&&(t+=n.data.totalPrice,r.pack=r.pack||[],r.pack.push(n.data.totalPrice));break;case"bus":var s={childPrice:0,adultPrice:0},d=e.data&&e.data.list||[];d&&d[0]&&3==d[0].ticketType?(s.childPrice+=d[0].ticketPrice,s.adultPrice+=d[0].ticketPrice):(d||[]).forEach(function(e){s.childPrice+=e.ticketPrice,s.adultPrice+=e.ticketPrice});var u=s.childPrice*i+s.adultPrice*a;t+=u,r.bus=r.bus||[],r.bus.push(u);break;case"train":var f=e.data.list||[],h=0;o&&(i=l.getState("trainAdultTicket"),a=l.getState("trainChildTicket")),f.forEach(function(e){h+=Number(e.trainTicketInfo.prices[0].price)});var p=h*i+h*a;t+=p,r.train=r.train||[],r.train.push(p);break;case"flight":e.children.forEach(function(e){if(e&&e.data&&e.data.data){var n=e.data.data;Array.isArray(n)||(n=[n]),n.forEach(function(e){t+=e.price,r.flight=r.flight||[],r.flight.push(e.price)})}});break;case"combined":var m=e.data.list[0]||[],v=m.child||a,g=m.adult||i,y=0,b=0;m.selected&&(m.selected.forEach(function(e){y+=Number(e.trainTicketInfo.prices[0].price),c.list.push({name:1==e.journeySeq?"("+g+""+(0!=v?v+"":"")+")":"("+g+""+(0!=v?v+"":"")+")",price:e.trainTicketInfo.prices[0].price*Number(v+g)})}),b=y*v+y*g,c.price=b),t+=b;break;case"hotel":var _=void 0,k=(e.data.isStock,e.data.selectRoom);r.hotel=r.hotel||[],_=k.price*k.selectNum,t+=_,r.hotel.push(_);break;case"ticketlist":var C=0;r.ticket=r.ticket||[],(e.data.list||[]).forEach(function(e){(e.tickets||[]).forEach(function(e){if(e.selected){var t=e.selectedDate,n=void 0;(e.useDate||[]).forEach(function(e){e.departDate==t&&(n=e.adultPrice)}),C+=n*e.selectedNum,C=Number(C)}})}),t+=C,r.ticket.push(C)}});n.push(s),n.push(c)});var s=Object.keys(p).reduce(function(e,t){return r[t]&&(e.title.push(p[t]),e.sum+=r[t].reduce(function(e,t){return e+t},0)),e},{title:[],sum:0});return s.title=""+s.title.join("")+"",r.flight&&(s.title+=""),n=n.filter(function(e){return e&&e.list&&e.list.length}),{sum:t,detail:n,main:s,mainDetail:r}}(e);s&&"#fee"===s&&console.log("fee info: ",t),f.html(c({adult:l.getState("adult"),child:l.getState("child"),detail:t.detail,main:t.main})),$(".J_totalFee").html("&yen;<strong>"+t.sum+"</strong>"),d.height(u.height())},enableLoading:function(){h=!0},disableLoading:function(){h=!1},disable:function(){u.addClass("disabled")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.feeTemplate='\n<% if (main) { %>\n    <div class="section">\n        <div class="title">\n            <div class="name"></div>\n            <div class="price">\n                <div><strong><%= main.sum %></strong></div>\n            </div>\n        </div>\n        <div class="list">\n            <div class="item"><%= main.title %></div>\n        </div>\n    </div>\n<% } %>\n\n<% for(var index = 0, length = detail.length, section; index < length, section = detail[index]; index++ ) { %>\n    <div class="section">\n        <div class="title">\n            <div class="name"><%= section.title %></div>\n            <div class="price">\n                <div><strong><%= section.price == 0? \'\': \'\' + section.price %></strong></div>\n            </div>\n        </div>\n        <div class="list">\n            <% for(var resIndex = 0, resLength = section.list.length, res; resIndex < resLength, res = section.list[resIndex]; resIndex++ ) { %>\n                <div class="item">\n                    <div class="detail" title="<%= res.name %>"><%= res.name %></div>\n                    <div class="price">\n                        <div><strong><%= res.price == 0? \'\': \'\' + res.price %></strong></div>\n                    </div>\n                </div>\n            <% } %>\n        </div>\n    </div>\n<% } %>\n'},function(e,t,n){"use strict";function i(e){return e.some(function(e){return"flight"===e.type||!!e.children.length&&i(e.children)})}function a(e,t){return t=t||{},e.forEach(function(e){var n=t[e.type]||0;t[e.type]=n+1,e.children.length&&a(e.children,t)}),t}Object.defineProperty(t,"__esModule",{value:!0}),t.resource=function(e){return new s.Component({type:"resource",el:e.el,data:e.data,children:e.children,methods:{checkFlight:function(){return!p.status.need.flight()||i(this.get().children)},checkFlightLack:function(e){var t=(0,o.getStore)().getState("mixedTrafficType"),n=(!e.pkgTicketBySeq||e.pkgTicketBySeq.length<1)&&(!e.singleTicketList||e.singleTicketList.length<1);1==e.supportTrafficType&&0==e.lackResFlag&&n&&(2==t?(0,o.getStore)().dispatch({type:r.SET_MIXED_TYPE,data:1}):(0,o.getStore)().dispatch({type:r.SET_MIXED_TYPE,data:3}))},check:function(){if(this.get("status")!==m.resourceStatus.loading){var e=a(this.get().children),t=!0;this.get("lack")&&(t=!1),1==this.get("lackResFlag")&&(t=!1),1==this.get("lackTrainFlag")&&(t=!1);var n=(0,o.getStore)().getState("supportTrafficType"),i=(0,o.getStore)().getState("mixedTrafficType");(2==n&&!e.flight||1==i)&&(t=!1),p.status.need.bus()&&!e.bus&&(t=!1),function(e){var t=!1;return e.forEach(function(e){"traffic"==e.type&&e.children.forEach(function(e){"bus"==e.type&&1==e.data.list[0].thirdTime&&(t=!0)})}),t}(this.get().children)&&(t=!1),t?this.set("status",m.resourceStatus.normal):this.set("status",m.resourceStatus.saleout)}},changeResStatus:function(e,t){this.resStatusObj=this.resStatusObj||{},this.resStatusObj[e]=t,this.methods.setMixedStatus()},setMixedStatus:function(){var e=m.resourceStatus.loading,t=m.resourceStatus.saleout,n=m.resourceStatus.normal,i=this.resStatusObj;i&&(n=Object.keys(i).reduce(function(n,a){return n===e||i[a]===e?e:n===t||i[a]===t?t:n},m.resourceStatus.normal)),this.set("status",n)}},callback:{render:function(e){},mount:function(e,t){t.forEach(function(t){return e.append(t.getDOM())})},bind:function(){}},lifecycle:{beforeInitialize:function(){this.resStatusObj=null,this.set("status",m.resourceStatus.loading)},afterInitialize:function(){var e=this,t=++b;this.methods.checkFlight()?(this.set("status",m.resourceStatus.loaded),this.methods.check()):(0,o.getStore)().getState("isSingleTeamMixed")?v.flight.fetchDefaultFlightP().then(function(n){t===b&&(n&&1==n.lackResFlag?e.set("status",m.resourceStatus.saleout):(n&&(e.methods.checkFlightLack(n),e.request("load:flight",g.flight.formatFlightData(n))),e.set("status",m.resourceStatus.loaded),e.methods.check(),(0,y['default'])(n,e)))})['catch'](function(e){}):v.flight.getFlightIsInternationalP().then(function(n){n&&n.ifInternational?((0,o.getStore)().dispatch({type:r.SET_FLIGHT_INTERNATIONAL_NORMAL,data:!0}),v.flight.fetchProductDefaultFlightP().then(function(n){t==b&&(n&&1==n.lackFlag?e.set("status",m.resourceStatus.saleout):(n&&(e.methods.checkFlightLack(n),e.request("load:flight",g.flight.formatProductFlightData(n))),e.set("status",m.resourceStatus.loaded),e.methods.check()))})['catch'](function(e){})):v.flight.fetchDefaultFlightP().then(function(n){t===b&&(n&&1==n.lackResFlag?e.set("status",m.resourceStatus.saleout):(n&&(e.methods.checkFlightLack(n),e.request("load:flight",g.flight.formatFlightData(n))),e.set("status",m.resourceStatus.loaded),e.methods.check(),(0,y['default'])(n,e)))})['catch'](function(e){})})}},events:{"change:busStatus":function(e){this.methods.check()},"change:trainStatus":function(e){this.methods.changeResStatus("train",e.data.after)},"change:flightStatus":function(e){this.methods.changeResStatus("flight",e.data.after)},"change:selectFlight":function(e){(0,o.getStore)().dispatch({type:r.CHECK_FLIGHT_RES_FAIL,data:-1}),(0,y['default'])(e.data.value,this)},"change:innerFlightReload":function(e){var t=(0,o.getStore)();t.dispatch({type:r.CHECK_FLIGHT_RES_FAIL,data:-1}),(0,y['default'])(e.data.value,this,{adultNum:t.getState("adultTicket"),childNum:t.getState("childTicket")})}},factory:{traffic:c.traffic,category:l.category,ticket:d.ticket,locale:u.locale,recommend:f.recommend,other:h.other}})};var o=n(1),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(58)),s=n(23),c=n(392),l=n(510),d=n(519),u=n(523),f=n(530),h=n(531),p=n(394),m=n(160),v=n(166),g=n(167),y=function(e){return e&&e.__esModule?e:{default:e}}(n(396)),b=0},function(e,t,n){"use strict";function i(e){return(s.call(e)||[]).reduce(function(e,t){switch(void 0===t?"undefined":r(t)){case"string":e.eventTypes=e.eventTypes.concat(t.split(/\s+/g));break;case"function":e.handlers.push(t);break;case"object":Object.assign(e.data,t)}return e},{eventTypes:[],handlers:[],data:{}})}function a(e,t){var n;for(n in e)!e.hasOwnProperty(n)||t&&t!==n||(!function(e){Array.isArray(e)&&(e.length=0)}(e[n]),delete e[n])}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=Array.prototype.slice;t.Emitter=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._events={}}return o(e,[{key:"indexOf",value:function(e,t){if("string"!=typeof e)return-1;var n=this._events[e];return n?n.indexOf(t):-1}},{key:"_on",value:function(e,t){var n=this;e.forEach(function(e){var i=n._events[e];i||(i=n._events[e]=[]),t.forEach(function(t){~n.indexOf(e,t)||i.push(t)})})}},{key:"_off",value:function(e,t){var n=this;e||handlers||a(this._events),e.forEach(function(e){var i=n._events[e];i&&(t?t.forEach(function(t){var a=n.indexOf(e,t);~a&&i.splice(a,1)}):a(n._events,e))})}},{key:"_dispatch",value:function(e,t,n){var i=this;e=e.filter(function(e){return"_all_"!==e});var a=this._events._all_||[];e.forEach(function(e){var o=i._events[e],r=Object.assign({},{type:e,originTarget:i,currentTarget:i,data:t},n);o&&o.forEach(function(e){e.call(i,r)}),a.forEach(function(e){e.call(i,r)})})}},{key:"on",value:function(){var e=i(arguments),t=e.eventTypes,n=e.handlers;t.length||(t=["_all_"]),n&&n.length&&this._on(t,n)}},{key:"off",value:function(){var e=i(arguments),t=e.eventTypes,n=e.handlers;t.length||(t=["_all_"]),this._off(t,n.length?n:null)}},{key:"dispatch",value:function(e,t,n){var i=void 0;"string"==typeof e||Array.isArray(e)?"string"==typeof e&&(i=[e]):(i=["_all_"],n=t,t=e),this._dispatch(i,t,n)}}]),e}()},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}function a(e){return!(!e||2!==e.length||3!==(e[0]||{}).ticketType)}Object.defineProperty(t,"__esModule",{value:!0}),t.bus=function(e){return new s.Component({type:"bus",el:e.el,data:e.data,children:e.children,callback:{render:function(e){return f(e)},mount:function(){},bind:function(){var e=this,t=(0,r.getStore)();this.$(".J_changeBus").click(function(){var n=app_url("package/"+t.getState("productId")+"/busList");l.dialog.open({title:"",url:n,area:["1020px","95%"],callback:function(t){(function(e){return new Promise(function(t,n){$.ajax({type:"post",url:c.config.url.checkBusTicket(),timeout:2e4,data:{list:JSON.stringify(function(e){var t=(0,r.getStore)(),n=t.getState("adult")+t.getState("child");return e=e||[],((e=a(e)?[e[0]]:e)||[]).map(function(e){return{productId:t.getState("productId"),scheduleId:e.scheduleCode,departDate:e.dptDate,ticketPrice:e.ticketPrice,departCityName:e.dptRegionName,arrivalCityName:e.dstRegionName,ticketNum:n||0,vendorIdList:(e.vendorIdList||[]).map(function(e){return parseInt(e,10)})}})}(e))},success:function(i){i.success&&i.data&&null!=i.data&&i.data.length?t(function(e,t){return e.map(function(e){return(t||[]).some(function(t){if(e.scheduleCode==t.scheduleId)return e.resId=t.resId,e.ticketPrice=t.price,!0}),e})}(e,i.data)):n(u)},error:function(e){n(u)}})})})(t.list).then(function(){t.list.forEach(function(e){e.thirdTime=!1}),e.set("busStatus",3)})['catch'](function(n){t.list.forEach(function(e){e.thirdTime=!0}),e.set("busStatus",2),$(".J_busTips").text("").show()}),e.load({data:t})},data:{baseInfo:{productId:t.getState("productId"),bookCityCode:t.getState("bookCityCode"),departCityCode:t.getState("departCityCode"),backCityCode:t.getState("backCityCode"),departDate:t.getState("departDate"),journeyId:t.getState("journeyId")||""},data:e.data.list}})})}},lifecycle:{beforeInitialize:function(){this.set("busStatus",1),this.set("title",function(e){var t="";return a(e)?t=e[0].dptRegionName+"-"+e[0].dstRegionName+"":e.reduce(function(e,n){return n.dptRegionName==e?t+="-"+n.dstRegionName:(t&&(t+=","),t+=n.dptRegionName+"-"+n.dstRegionName),n.dstRegionName},null),t}(this.data.list))},afterInitialize:function(){},beforeRender:function(){},afterRender:function(){this.data.list.forEach(function(e){e.thirdTime=!1})},beforeMount:function(){},afterMount:function(){},beforeBind:function(){},afterBind:function(){}},events:{},factory:{}})};var o=i(n(11)),r=n(1),s=(i(n(57)),n(23)),c=n(19),l=n(53),d=n(496),u=(n(10),3),f=o.compile(d.busTemplate,{client:!0,compileDebug:!1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.busTemplate='\n<div class="res-label J_busBox">\n<p class="res-title">\n   <span class="res-icon res-icon-bus"></span>\n   <span class="res-name"><%= title %></span>\n   <span class="J_busTips res-tips"><%if(list[0].thirdTime){%><%}%></span>\n</p>\n<div class="res-content res-bus">\n   <div class="res-content-left">\n       <ul>\n           <%for(var k = 0; k < list.length; k++){%>\n           <%var listData = list[k];%>\n           <li class="res-row">\n               <div class="res-list-title">\n               </div>\n               <div class="res-list-content">\n                   <p class="res-cell res-detail">\n                       <span><%= listData.dptDate %></span>\n                   </p>\n                   <p class="res-cell res-desc">\n                       <b><%= listData.dptTime.substring(0,5) %></b>\n                       <a class="res-bus-light"></a>\n                   </p>\n                   <p class="res-cell res-depart">\n                       <span class="res-bus-bold"><%= listData.dptRegionName %></span>\n                       <span class="res-bus-light"><%= listData.dptStation %></span>\n                   </p>\n                   <div class="res-cell res-midway">\n                   </div>\n                   <p class="res-cell res-stop">\n                       <span class="res-bus-bold"><%= listData.dstRegionName %></span>\n                       <span class="res-bus-light"><%= listData.dstStation %></span>\n                   </p>\n               </div>\n           </li>\n           <% } %>\n       </ul>\n   </div>\n   <div class="res-content-right">\n       <span class="J_changeBus res-content-change" data-num="0">\n       \n       </span>\n   </div>\n   <div class="clear">\n   </div>\n</div>\n</div>\n'},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.train=function(e){return new r.Component({type:"train",el:e.el,data:e.data,children:e.children,callback:{render:function(e){return window.trainData=this.data.list,f(e)},mount:function(){},bind:function(){var e=this,t=(0,o.getStore)();this.$(".J_more").click(function(){var n=app_url("package/"+t.getState("productId")+"/trainList?bookCityCode="+t.getState("bookCityCode")+"&departCityCode="+t.getState("departCityCode")+"&backCityCode="+t.getState("backCityCode")+"&departDate="+t.getState("departDate")+"&callback="+e.iframeCallback);d.dialog.open({title:"",url:n,area:["1020px","95%"],callback:function(t){e.load({data:t})}})}),1===t.getState("supportTrafficType")&&0===t.getState("mixedTrafficType")&&t.getState("child")>0&&(new u.SelectBox(e.$("#J_trainSelectBox"),{adultNumber:t.getState("trainAdultTicket"),childNumber:t.getState("trainChildTicket"),originalAdultNumber:t.getState("adult"),originalChildNumber:t.getState("child")},{preventDefaultToast:!0,toastMsg:h,childInfo:["11.2","1.2-1.5","1.5",""],change:function(n,i){var a=[];h=i||"",t.dispatch({type:s.CHANGE_TRAIN_ADULT_TICKET,data:n.adultNumber}),t.dispatch({type:s.CHANGE_TRAIN_CHILD_TICKET,data:n.childNumber}),e.$element.addClass("loading"),e.set("trainStatus",p.loading),l.fetcher.defaultResource.fetchDefaultResourceP({adultNum:t.getState("trainAdultTicket"),childNum:t.getState("trainChildTicket")}).then(function(t){a=t.wholeJourney&&!t.wholeJourney.lackTrainFlag&&t.wholeJourney.trainTicket||[],Array.isArray(a)&&a.length?e.set("trainStatus",p.normal):e.set("trainStatus",p.saleout)})['catch'](function(){e.set("trainStatus",p.saleout)}).then(function(){e.$element.removeClass("loading"),e.load({data:{list:a}})})}}),h="")}},lifecycle:{beforeInitialize:function(){},afterInitialize:function(){},beforeRender:function(){},afterRender:function(){},beforeMount:function(){},afterMount:function(){},beforeBind:function(){},afterBind:function(){}},events:{},factory:{}})};var a=i(n(11)),o=n(1),r=n(23),s=i(n(57)),c=n(498),l=n(393),d=n(53),u=n(395),f=a.compile(c.trainTemplate,{client:!0,compileDebug:!1}),h="",p={loading:1,loaded:4,saleout:2,normal:3}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.trainTemplate='\n<%\n    var timePare = function () {\n        var time = new Date();\n        return time.getHours();\n    }\n%>\n<div class="train-box">\n<div class="row-head">\n    <span class="resource-icon resource-train-icon"></span>\n    <%var len = list.length;%>   \n    <strong class="title"></strong>\n    <div class="select-box" id="J_trainSelectBox"></div>\n    <%if(timePare() > 22 || timePare() < 6){%>\n        <span class="buy-tip">* 23-612306</span>\n    <%}%>    \n</div>\n<div class="train-resource-content">\n    <% if (len > 0) { %>\n\n        <table>\n            <% for (var i = 0;i < len; i++){\n               var item = list[i]; %>\n            <tr class="J_train_list">\n                <td class="train-city-fuck">\n                    <div>\n                        <% var departDate = item.departDate.split("-");%> \n\n                        <%= departDate[1]%><%= departDate[2]%>\n                    </div>\n                    <div class="J_second"><%= item.departureCityName %><%= item.arrivalCityName %></div>\n                </td>\n                <td class="train-main-num"><%= item.trainTicketInfo.trainNum %></td>\n                <td class="train-departure-date">\n                    <div class="train-departure-time"><%= item.trainTicketInfo.departDepartTime %></div>\n                    <div class="J_second"><%= item.trainTicketInfo.departStationName %></div>\n                </td>\n                <td class="train-duration">\n                    <div></div>   \n                    <%if(item.trainTicketInfo.durationStr){\n                        var duration = item.trainTicketInfo.durationStr;\n                    }else{\n                        var hour = parseInt(item.trainTicketInfo.duration / 60);\n                        var minute = item.trainTicketInfo.duration % 60;\n                        var duration = hour + \'\' + minute + \'\';\n                    } %>\n                    <%= duration%>\n                </td>\n                \n                <td class="train-arrival-date">\n                    <div class="train-departure-time"><%= item.trainTicketInfo.destArriveTime %></div>\n                    <div class="J_second"><%= item.trainTicketInfo.destStationName %></div>\n                </td>\n                \n                <td class="train-seat-type"><%= item.trainTicketInfo.prices[0].seatName %></td>\n            </tr>\n            <% } %>\n        </table>\n        <button class="J_more"></button>\n\n    <% } else { %>\n        <div class="saleout"></div>\n    <% } %>\n</div>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.defaultResource=void 0;var i=n(1),a=n(19);t.defaultResource={fetchDefaultResourceP:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,i.getStore)(),n={productId:t.getState("productId"),adultNum:null!=e.adultNum?e.adultNum:t.getState("adult"),childNum:null!=e.childNum?e.childNum:t.getState("child"),freeChildNum:t.getState("freeChild"),departDate:t.getState("departDate"),bookCityCode:t.getState("bookCityCode"),departCityCode:t.getState("departCityCode"),backCityCode:t.getState("backCityCode"),journeyId:t.getState("journeyId")||"",ifNewStockHotel:!0,ifSupportDealCidHotel:!0};return new Promise(function(e,t){$.ajax({type:"get",url:a.config.url.defaultResource(),data:{d:JSON.stringify(n)},dataType:"json",success:function(n){n&&n.success&&n.data?e(n.data):t()},error:function(){t()}})})}}},function(e,t,n){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=function(){var e=(0,a.getStore)();return{productId:e.getState("productId"),bookCityCode:e.getState("bookCityCode"),departCityCode:e.getState("departCityCode"),backCityCode:e.getState("backCityCode"),departDate:e.getState("departDate"),journeyId:e.getState("journeyId")||""}}();return t.refreshCache=1===e?0:1,new Promise(function(e,n){$.ajax({url:o.config.url.busTicket(),data:t,success:function(t){t&&t.success&&t.data?e(function(e){return(e||{}).tripInfo||[]}(t.data)):n(null)},error:function(t){e(null)}})}).then(function(e){return function(e){return new Promise(function(t,n){$.ajax({type:"post",url:o.config.url.checkBusTicket(),timeout:2e4,data:{list:JSON.stringify(function(e){var t=(0,a.getStore)(),n=t.getState("adult")+t.getState("child");return e=e||[],((e=function(e){return!(!e||2!==e.length||3!==(e[0]||{}).ticketType)}(e)?[e[0]]:e)||[]).map(function(e){return{productId:t.getState("productId"),scheduleId:e.scheduleCode,departDate:e.dptDate,ticketPrice:e.ticketPrice,departCityName:e.dptRegionName,arrivalCityName:e.dstRegionName,ticketNum:n||0,vendorIdList:(e.vendorIdList||[]).map(function(e){return parseInt(e,10)})}})}(e))},success:function(i){i.success&&i.data&&null!=i.data&&i.data.length?t(function(e,t){return e.map(function(e){return(t||[]).some(function(t){if(e.scheduleCode==t.scheduleId)return e.resId=t.resId,e.ticketPrice=t.price,!0}),e})}(e,i.data)):n(e)},error:function(n){t(e)}})})}(e)})['catch'](function(t){return e<s?i(++e):(t.forEach(function(e){e.thirdTime=!0}),Promise.resolve(t))})}Object.defineProperty(t,"__esModule",{value:!0}),t.bus=void 0;var a=n(1),o=n(19),r=n(394),s=3;t.bus={fetchDefaultBusP:function(){return r.status.need.bus()?i():null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combination=void 0;var i=n(1),a=n(19);t.combination={fetchCombinedDataP:function(e){var t=(0,i.getStore)(),n=t.getState("homeBookCityCode"),o=t.getState("departCityCode"),r=t.getState("productTypeName");return new Promise(function(t,s){n!=o&&"drive"!=r?$.ajax({url:a.config.url.combinedTspCity(),data:{d:JSON.stringify(function(e){var t=(0,i.getStore)();return{productId:t.getState("productId"),bookCityCode:t.getState("homeBookCityCode"),departCityCode:t.getState("departCityCode"),departDate:t.getState("departDate"),duration:e}}(e))},success:function(e){t(e&&e.success&&e.data&&e.data.cityList&&e.data.cityList.length?e.data:null)},error:function(e){t(null)}}):t(null)})}}},function(e,t,n){"use strict";function i(e){return new Promise(function(t,n){$.ajax({url:o.config.url.addItem(),data:{d:JSON.stringify(function(e){var t=(0,a.getStore)();return{productId:t.getState("productId"),journeyId:e,groupType:3,itemType:0,adultNum:t.getState("adult"),childNum:t.getState("child"),freeChildNum:t.getState("freeChild"),departDate:t.getState("departDate"),bookCityCode:t.getState("bookCityCode"),departCityCode:t.getState("departCityCode"),backCityCode:t.getState("backCityCode")}}(e))},success:function(n){t(n&&n.success&&n.data&&n.data.list&&n.data.list.length?{journeyId:e,data:function(e){var t=(0,a.getStore)(),n={};(e.list||[]).forEach(function(e){n[e.attachType]||(n[e.attachType]=[]),n[e.attachType].push(e)}),(e.attachTypes||[]).forEach(function(e){e.dataList=n[e.typeId],e.typeId&&300===e.typeId&&e.dataList.forEach(function(e){e.attachId&&s.push(e.attachId)})}),s.length&&s.length>0&&t.dispatch({type:r.INIT_VISA_FLAG,data:s});return e}(n.data)}:null)},error:function(e){t(null)}})})}Object.defineProperty(t,"__esModule",{value:!0}),t.addition=void 0;var a=n(1),o=n(19),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(58)),s=[];t.addition={fetchAllAddItemP:function(e){var t=[];return e.wholeJourney&&t.push(i(e.wholeJourney)),e.journeys.forEach(function(e){return t.push(i(e))}),Promise.all(t)},fetchNewAddItemListP:function(e){return new Promise(function(t,n){$.ajax({type:"GET",url:o.config.url.newAddItemList(),data:{d:JSON.stringify(e)},success:function(e){t(e&&e.success&&e.data?e.data:null)},error:function(e){t(null)}})})},hasVisa:function(){return s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.selectBoxTemplate='\n    <div class="select-area" data-key="adult">\n        <div class="J_adult select-display">\n            <span class="J_select-number"><%= adultNumber %></span>\n            <span class="select-icon" isshow="false">\n                \n                <i class="upicon"></i>\n                <i class="downicon"></i>\n            </span> \n        </div>\n        <ul class="select-option-box">\n            <% for (var i = adult.start; i <= adult.end; i++) { %>\n                \n                <li class="adult select-option\n                    <% if (i == adultNumber) { %> selected<% } %>" \n\n                    data-value="<%= i %>"><%= i %></li>\n\n            <% } %>\n        </ul>\n    </div>\n    <div class="select-area" data-key="child">\n        <div class="J_child select-display">\n            <span class="J_select-number"><%= childNumber %></span>\n            <span class="select-icon" isshow="false">\n                \n                <i class="upicon"></i>\n                <i class="downicon"></i>\n            </span>\n        </div>\n        <ul class="select-option-box">\n            <% for (var i = child.start; i <= child.end; i++) { %>\n                \n                <li class="child select-option\n                    <% if (i == childNumber) { %> selected<% } %>" \n\n                    data-value="<%= i %>"><%= i %></li>\n\n            <% } %>\n        </ul>\n    </div>\n    <% if (childInfo.length > 0) { %>\n        <span class="childinfo">\n            <i>i</i>\n        </span>\n        <script class="J_childinfodetail" type="text/template">\n            <div class="childinfodetail">\n                <p><%- childInfo.join(\'</p><p>\'); %></p>\n            </div>\n        <\/script>\n    <% } %>\n    <span class="message-info" style="display:none;"></span>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combined=function(e){return new o.Component({type:"combined",el:e.el,data:e.data,children:e.child,callback:{render:function(e){return c(e)},mount:function(){},bind:function(){var e=this,t=(0,a.getStore)();e.$root=e.$(".J_CTBook"),this.$(".J_ctchange").click(function(){$(this).hasClass("ct-active")||($(this).siblings().removeClass("ct-active"),$(this).addClass("ct-active"),e.$root.find(".ct-item").addClass("hide"),e.$root.find(".ct-item").eq($(this).index()).removeClass("hide"))}),this.$(".J_ct_select").click(function(){e.$root.find(".book-name").html($(this).data("name")),e.$root.find(".book-name").attr("data-name",$(this).data("name")),e.$root.find(".book-name").attr("data-code",$(this).data("code"))}),this.$(".J_CTBook").on({mouseenter:function(){$(this).addClass("ct-show"),$(this).find(".J_CTHover").show()},mouseleave:function(){$(this).removeClass("ct-show"),$(this).find(".J_CTHover").hide()}}),this.$(".J_CTSelect").click(function(){window.combinedData=e.data,window.combinedData.list[0].combinedCityName=e.$root.find(".book-name").attr("data-name"),window.combinedData.list[0].combinedCityCode=e.$root.find(".book-name").attr("data-code"),window.combinedData.list[0].productId=t.getState("productId");var n=app_url("package/"+t.getState("productId")+"/combinedList?departCityCode="+t.getState("departCityCode")+"&departCityName="+encodeURIComponent(t.getState("departCityName"))+"&adult="+t.getState("adult")+"&child="+t.getState("child")+"&callback="+e.iframeCallback);s.dialog.open({title:"",url:n,area:["1020px","95%"],callback:function(t){e.load({data:t})}})}),this.$(".J_more").click(function(){window.combinedData=e.data;var n=app_url("package/"+t.getState("productId")+"/combinedList?departCityCode="+t.getState("departCityCode")+"&departCityName="+encodeURIComponent(t.getState("departCityName"))+"&adult="+t.getState("adult")+"&child="+t.getState("child")+"&callback="+e.iframeCallback);s.dialog.open({title:"",url:n,area:["1020px","95%"],callback:function(t){e.load({data:t})}})}),this.$(".J_delete_combined").click(function(){e.data.list[0].selected=null,e.data.list[0].goTime=null,e.data.list[0].backTime=null,e.load({data:e.data})})}},lifecycle:{beforeInitialize:function(){},afterInitialize:function(){},beforeRender:function(){},afterRender:function(){},beforeMount:function(){},afterMount:function(){},beforeBind:function(){},afterBind:function(){}},events:{},requests:{changeCombinedCheck:function(e){this.set("pareTime",e.data)},loadPareTime:function(e){this.load({data:this.get().data})}},factory:{}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(1),o=n(23),r=n(505),s=n(53),c=i.compile(r.combinedTemplate,{client:!0,compileDebug:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.combinedTemplate='\n<div class="combined-content">\n<%var data = list[0];\n if(!data.selected) {%>\n<div class="combined-transport" id="combinedTransport">\n    \n    \n    <div class="ct-book J_CTBook">\n        <span class="book-name" data-name="<%= window.pageData.bookCityName%>" data-code="<%= window.pageData.bookCityCode%>"><%= window.pageData.bookCityName%></span>\n        <span class="book-arrow"></span>\n        <div class="book-city J_CTHover hide">\n        <%  var cities = data.cityList;\n                var len = cities.length;\n                var listNum = parseInt(len / 5);\n                if(len%5 != 0){\n                    listNum = listNum + 1;\n                };\n                var countCity = [];\n                for(var i = 0; i < listNum;i++){\n                    var arr = [];\n                    for (var m = 0;m < 5;m++){\n                        var cityIndex = i *5 + m;\n                        if(cities[cityIndex]){\n                            arr.push(cities[cityIndex]);  \n                        }  \n                    }\n                    countCity.push(arr);\n                }\n            %>\n\n            <div class="ct-top-border">\n                <span class="ct-left"></span>\n                <span class="ct-right"></span>\n            </div>\n\n            <div class="ct-list">\n                <ul class="ct-city-menu">\n                    <%for(var n=0;n<countCity.length;n++){\n                        var firstLetter=\'\';\n                           for (var ll=0;ll<countCity[n].length;ll++){\n                            \n                                firstLetter+=countCity[n][ll].firstLetter;\n                           } \n                        %>\n                    <li class="J_ctchange <%if(n==0){%>ct-active<%}%>">\n                        <a href="javascript:;"><%=firstLetter%></a>\n                    </li>\n                    <%}%>        \n                </ul>\n\n                <div class="city-wrap">\n\n                    <%for(var j=0;j<countCity.length;j++){%>\n                    <div class="ct-item <%if(j!=0){%>hide<%}%>">\n                        <%for(var h=0;h<countCity[j].length;h++){%>\n                        <%var citySub = countCity[j][h];%>\n                        <div class="city-sub clearfix">\n                            <div class="title"><%=citySub.firstLetter%></div>\n                            <ul class="ct-sub-ul clearfix">\n                             <%for(var m=0;m<citySub.cities.length;m++){%>\n                                <li class="J_ct_select " data-code="<%=citySub.cities[m].cityCode%>" data-name="<%=citySub.cities[m].cityName%>">\n                                    <a href="javascript:;"><%=citySub.cities[m].cityName%></a>\n                                </li>\n                                <%}%>\n                            </ul>\n                        </div>  \n                        <%}%>\n                    </div>\n                    <%}%>\n                </div>\n             </div>\n        </div>\n    </div>\n    \n    <div class="ct-depart"><%= window.pageData.departCityName%></div>\n    \n    <div class="ct-book-btn J_CTSelect"></div>\n</div>\n<%}%>\n<%\n    var timePare = function () {\n        var time = new Date();\n        return time.getHours();\n    }\n%>\n<% if(data.selected) {\n    var selectData = data.selected;\n    %>\n<div class="train-box">\n<div class="row-head">\n    <span class="resource-icon resource-train-icon"></span>\n    <% var len = selectData.length;%> \n            \n        \n    <strong class="title"><%= selectData[0].departureCityName %> - <%=selectData[0].arrivalCityName %></strong>\n    <%if(timePare() > 22 || timePare() < 6){%>\n        <span class="buy-tip">* 23-612306</span>\n    <%}%>    \n</div>\n<div class="train-resource-content">\n    <table>\n        <% for (var i = 0;i < len; i++){\n           var item = selectData[i]; %>\n        <tr class="J_train_list">\n            <td class="train-city-fuck">\n                <div>\n                    <% var departDate = item.departDate.split("-");%> \n\n                    <%= departDate[1]%><%= departDate[2]%>\n                </div>\n                <div class="J_second"><%= item.departureCityName %><%= item.arrivalCityName %></div>\n            </td>\n            <td class="train-main-num"><%= item.trainTicketInfo.trainNum %></td>\n            <td class="train-departure-date">\n                <div class="train-departure-time"><%= item.trainTicketInfo.departDepartTime %></div>\n                <div class="J_second"><%= item.trainTicketInfo.departStationName %></div>\n            </td>\n            <td class="train-duration">\n                <div></div>\n                <% if(item.trainTicketInfo.durationStr){\n                    var duration = item.trainTicketInfo.durationStr;\n                }else{\n                    var hour = parseInt(item.trainTicketInfo.duration / 60);\n                    var minute = item.trainTicketInfo.duration % 60;\n                    var duration = hour + \'\' + minute + \'\';\n                } %>\n                <%= duration%>\n            </td>\n            <td class="train-arrival-date">\n                <div class="train-departure-time"><%= item.trainTicketInfo.destArriveTime %></div>\n                <div class="J_second"><%= item.trainTicketInfo.destStationName %></div>\n            </td>\n            \n            <td class="train-seat-type"><%= item.trainTicketInfo.prices[0].seatName %></td>\n        </tr>\n        <% } %>\n    </table>\n    <button class="J_more"></button>\n    <button class="J_delete_combined"></button>\n</div>\n</div>\n<%}%>\n<% if(list[0].goTime&&list[0].backTime&&typeof pareTime != \'undefined\'){\n    var goTransitNeed = list[0].groupList[0].departHourAfterPreviousTrip || 52;\n    var backTransitNeed = list[0].groupList[1].arriveHourBeforeNextTrip || 51;\n    var goDiffTime = Math.round((new Date(pareTime.goTime1).getTime() - new Date(list[0].goTime).getTime())/1000/3600);\n    var backDiffTime = Math.round((new Date(list[0].backTime).getTime() - new Date(pareTime.backTime1).getTime())/1000/3600);\n    var tip = \'\';\n    if(goDiffTime < 0 ){\n        tip += \' ;\'\n    }else if(goDiffTime> 0 && goDiffTime < goTransitNeed){\n        tip +=\' \'+goTransitNeed+\';\'\n    }\n\n    if(backDiffTime < 0 ){\n        tip += \' ;\'\n    }else if(backDiffTime> 0 && backDiffTime < backTransitNeed){\n        tip +=\' \'+backTransitNeed+\';\'\n     } %>\n    \n    <div class="combined-tips"><%= tip %></div>\n<%}%>    \n</div>\n'},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.flight=function(e){return new r.Component({type:"flight",el:e.el,data:e.data,children:e.children,methods:{showCheckTip:function(e,t){var n=this.$(".J_check-flight");n.html(e),t&&setTimeout(function(){n.html("")},t)},clearCheckTip:function(){this.$(".J_check-flight").html("")},getPeopleNumber:function(){var e=(0,s.getStore)();return{adultNumber:e.getState("adultTicket"),childNumber:e.getState("childTicket"),originalAdultNumber:e.getState("adult"),originalChildNumber:e.getState("child")}},getFlightAfterPeopleNumberChange:function(e){var t=this,n=(0,s.getStore)();this.$(".J_flightList"),this.methods.clearCheckTip(),c.flight.fetchDefaultFlightP({adultNum:n.getState("adultTicket"),childNum:n.getState("childTicket")}).then(function(n){var i=(!n.pkgTicketBySeq||n.pkgTicketBySeq.length<1)&&(!n.singleTicketList||n.singleTicketList.length<1);if(!n||n.lackResFlag||i)e&&e.call(t);else{var a=l.flight.formatFlightData(n),o=a.children[0];e&&e.call(t,[o.data],a),t.set("innerFlightReload",n)}})['catch'](function(e){})},renderList:function(){var e=this.$(".J_flightList");this.children.forEach(function(t){e.append(t.getDOM())})}},callback:{render:function(){var e=this.methods.getPeopleNumber();return h({data:e})},mount:function(){this.methods.renderList.call(this)},bind:function(){var e=this,t=e.$(".J_flightList"),n=(0,s.getStore)(),i=this.methods.getPeopleNumber(),a=e.$("#J_flightSelectBox");1===n.getState("supportTrafficType")&&0===n.getState("mixedTrafficType")&&n.getState("child")>0&&new f.SelectBox(a,i,{childInfo:["12","2"],change:function(i,a){n.dispatch({type:o.CHANGE_ADULT_TICKET,data:i.adultNumber}),n.dispatch({type:o.CHANGE_CHILD_TICKET,data:i.childNumber}),t.addClass("loading").removeClass("saleout").empty(),e.set("flightStatus",p.loading),e.methods.getFlightAfterPeopleNumberChange.call(e,function(n,i){n?(e.destroyChildren(),e.addChildren("flightTicket",n),e.methods.renderList.call(this),e.dispatch("load:flight",i),e.set("flightStatus",p.normal)):(t.addClass("saleout").html(""),e.set("flightStatus",p.saleout)),t.removeClass("loading")})}})}},lifecycle:{beforeInitialize:function(){},afterInitialize:function(){},beforeRender:function(){},afterRender:function(){},beforeMount:function(){},afterMount:function(){},beforeBind:function(){},afterBind:function(){}},events:{"change:selectFlight":function(){this.methods.clearCheckTip()}},requests:{"check:flightFail":function(e){this.methods.showCheckTip(e.data.tips)},"change:flightPrice":function(e){this.methods.showCheckTip(e.data.tips,3e3)}},factory:{flightTicket:u.flightTicket}})};var a=i(n(11)),o=i(n(57)),r=n(23),s=n(1),c=(n(19),n(107),n(160),n(166)),l=(n(392),n(167)),d=n(507),u=n(508),f=n(395),h=(function(e){e&&e.__esModule}(n(396)),a.compile(d.flightTemplate)),p={loading:1,loaded:4,saleout:2,normal:3}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.flightTemplate='\n<div class="row flight">\n    <div class="row-head">\n        <i class="icon icon-flight"></i>\n        <strong class="J_flightTitle title"></strong>\n        <div class="select-box" id="J_flightSelectBox">\n        </div>\n        <span class="J_check-flight"></span>\n    </div>\n    <div class="J_flightList row-body "></div>\n</div>\n'},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.flightTicket=function(e){return new o.Component({type:"flightTicket",el:e.el,data:e.data,children:e.children,methods:{buildRenderData:function(){var e=(this.data||{}).data;return Array.isArray(e)||(e=[e]),e.map(function(e){return{group:function(e){if(!e)return[];var t=e.reduce(function(e,t){var n=t.journeyNum;return e[n]=e[n]||[],e[n].push(t),e},{});return Object.keys(t).sort().reduce(function(e,n){return[].concat(t[n]).reverse().reduce(function(e,t){return t&&(t.trainsitTime||(t.trainsitTime=function(e,t){if(e&&t){var n=e.flightDate+" "+e.departTime,i=t.arriveDate+" "+t.arriveTime,a=(0,s.getDeltaDate)(n,i);return[a.day?a.day+"":"",a.hour?a.hour+"":"",a.minute?a.minute+"":""].join("")}return""}(e,t))),t}),e.push(t[n]),e},[])}(e.flightTicketInfo)}})},changeFlightPrice:function(e){function t(e,t){e.seqNum==t.seqNum&&(t.price=e.price,t.adultPrice=e.adultPrice,t.childPrice=e.childPrice,t.resId=e.resId)}var n=void 0,i=this.get("data");(n=1==this.get("selectedTicketList")?e&&e.pkgRes||[]:e&&e.singleRes||[]).length||store.dispatch({type:u.CHECK_FLIGHT_RES_FAIL,data:1}),n.forEach(function(e){Array.isArray(i)?i.forEach(function(n){t(e,n)}):t(e,i)}),this.set("data",i),i=null}},callback:{render:function(){return h({journeys:this.methods.buildRenderData()})},mount:function(){},bind:function(){var e=this,t=(0,r.getStore)();e.$(".J_flightDetail").each(function(){var e=$(this),t=e.siblings(".J_flightDetail").html();e.hover(function(){(0,l.showPopup)(e,{content:t})},function(){(0,l.hidePopup)()})}),e.$(".share-flight").each(function(){var e=$(this),t=e.siblings(".J_share-flight").html(),n=void 0;e.hover(function(){n=layer.open({type:4,skin:"layui-layer-rim",area:["auto"],content:[t,e],tips:3,shade:!1,fix:!1,closeBtn:!1,tipsOffset:[10,-27]})},function(){layer.close(n)})}),e.$(".J_flightSeatTip").each(function(){var e=$(this),t=e.siblings(".J_flightBuyDetail").html();e.hover(function(){(0,l.showPopup)(e,{content:t})},function(){(0,l.hidePopup)()})}),e.$(".J_flightStop").each(function(){var e=$(this),t='<div class="global-tip-box">'+e.data("content")+"</div>",n=void 0;e.hover(function(){n=layer.open({type:4,skin:"layui-layer-rim",area:["auto"],content:[t,e],tips:3,shade:!1,fix:!1,closeBtn:!1,tipsOffset:[10,-27]})},function(){layer.close(n)})}),e.$(".J_flightOtherDay").each(function(){var e=$(this),t=e.siblings(".J_flightOtherDaydetail").html(),n=void 0;e.hover(function(){n=layer.open({type:4,skin:"layui-layer-rim",area:["auto"],content:[t,e],tips:3,shade:!1,fix:!1,closeBtn:!1,tipsOffset:[10,-27]})},function(){layer.close(n)})}),e.$(".J_changeButton").click(function(){t.getState("flightInternationalNormal")?c.dialog.open({title:"",url:app_url("tour/flightList"),area:["1080px","95%"],callback:function(t){t=f.flight.getFlightList(t),e.load({data:Object.assign({},e.get().data,{data:t[0]})})},data:{baseInfo:{productId:t.getState("productId"),bookCityCode:t.getState("bookCityCode"),departCityCode:t.getState("departCityCode"),backCityCode:t.getState("backCityCode"),adult:t.getState("adult"),child:t.getState("child"),departDate:t.getState("departDate"),freeChild:t.getState("freeChild"),journeyId:t.getState("journeyId")},flightData:t.getState("flightToListData")}}):c.dialog.open({title:"",url:app_url("package/"+t.getState("productId")+"/flightList"),area:["1020px","95%"],callback:function(t){e.load({data:Object.assign({},e.get().data,t)}),e.set("selectFlight",Object.assign({},e.get().data,t))},data:{baseInfo:{productId:t.getState("productId"),bookCityCode:t.getState("bookCityCode"),departCityCode:t.getState("departCityCode"),backCityCode:t.getState("backCityCode"),adult:t.getState("adult"),child:t.getState("child"),departDate:t.getState("departDate"),freeChild:t.getState("freeChild"),journeyId:t.getState("journeyId")},flightData:e.get().data}})})}},lifecycle:{beforeInitialize:function(){},afterInitialize:function(){},beforeRender:function(){},afterRender:function(){},beforeMount:function(){},afterMount:function(){},beforeBind:function(){},afterBind:function(){}},events:{},requests:{"change:flightPrice":function(e){e.data&&e.data.list&&(this.methods.changeFlightPrice(e.data.list),this.set("flightPrice",+new Date))},"change:flightSuccess":function(e){e.data&&e.data.list&&this.methods.changeFlightPrice(e.data.list)}},factory:{}})};var a=i(n(11)),o=n(23),r=n(1),s=n(159),c=n(53),l=n(107),d=n(509),u=i(n(58)),f=n(167),h=a.compile(d.flightTicketTemplate)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.flightTicketTemplate='\n<div class="J_flightDetail detail">\n    <div class="flight-list"> \n        <% var visas = [] %>\n        <% journeys.forEach(function(journey) { %>\n            <div class="resource-row flight-row">\n                <% journey.group.forEach(function(group) { %>\n                    <div class="flight-group">\n                        <% var ticketLength = group.length; %>\n                        <% group.forEach(function(ticket, ticketIndex) { %>\n                            <div class="flight-ticket resource-inner">\n                                <div class="resource-col flight-base">\n                                    <div class="resource-cell flight-date"><%= ticket.flightDate %></div>\n                                    <div class="resource-cell flight-location"><%= ticket.departureCityName %>  <%= ticket.destinationCityName %></div>\n                                </div>\n                                <div class="resource-col flight-company">\n                                    <div class="resource-cell flight-company-name"><%= ticket.airlineName %>\n                                        <a class="J_flightDetail" href="javascript:;"></a>\n                                        <script class="J_flightDetail" type="text/template">\n                                            <% var ticketLength = group.length; %>\n                                            <% group.forEach(function(ticket, ticketIndex) { %>\n                                                <div class="flight-detail">\n                                                    <div class="flight-detail-header">\n                                                        <span class="flight-detail-header-data"><%= ticket.flightDate %></span>\n                                                        <span class="flight-detail-header-company"><%= ticket.airlineName %></span>\n                                                        <span class="flight-detail-header-flightnumber">\n                                                            <%= ticket.flightNo %>\n                                                            <% if(ticket.shareAirlineName) { %>\n                                                                <i class="flight-detail-header-facttflight">(<%= ticket.shareAirlineName %><%= ticket.shareFlightNo %>)</i>\n                                                            <% } %>\n                                                        </span> \n                                                        <% if(ticket.airplaneTypeName) { %>\n                                                        <span class="flight-detail-header-planestyle"><%= ticket.airplaneTypeName %></span>\n                                                        <% } %>\n                                                        <% if(ticket.hasMeal) { %>\n                                                            <span class="flight-detail-header-food"></span>\n                                                        <% }else { %>\n                                                            <span class="flight-detail-header-food"></span>\n                                                        <% } %>\n                                                    </div>\n                                                    <div class="flight-detail-content clearfix">\n                                                        <div class="flight-detail-content-companylogo"></div>\n                                                        <div class="flight-detail-content-flightdetail">\n                                                            <div class="go clearfix">\n                                                                <span class="go-time"><%= ticket.departTime %></span>\n                                                                <div class="goinfo">\n                                                                    <span class="go-city"><%= ticket.departureCityName %></span>\n                                                                    <span class="go-airport"><%= ticket.departureAirportName %><%= ticket.dTerminal%></span>\n                                                                </div>\n                                                            </div>\n                                                            <% if (ticketIndex < ticketLength - 1 && ticketIndex == 0) { %>\n                                                                <i class="flight flight-start"></i>\n                                                            <% }else if(ticketIndex < ticketLength - 1 && ticketIndex + 2 <= ticketLength ) { %>\n                                                                <i class="flight flight-middle"></i>\n                                                            <% } else if (ticketIndex <= ticketLength - 1 && ticketIndex + 1 == ticketLength && ticketIndex !== 0) { %>\n                                                                <i class="flight flight-end"></i>\n                                                            <% } else if (ticketIndex == ticketLength - 1 && ticketIndex == 0) { %>\n                                                                <i class="flight flight-nostop"></i>\n                                                            <% } %>\n                                                            <% if(ticket.stopNum && ticket.stopPointList && ticket.stopPointList !== 0) { %>\n                                                                <% ticket.stopPointList.forEach(function(stopPoint, index) { %>  \n                                                                    <div class="stop">\n                                                                        <span class="stop-info"></span>\n                                                                        <span class="stop-city"><%= stopPoint.stopCityName%></span>\n                                                                        <% if(stopPoint.stopTime) { %>\n                                                                        <span class="stop-time"><%= stopPoint.stopTime%></span>\n                                                                        <% } %>\n                                                                    </div>\n                                                                <% }) %>\n                                                            <% } else { %>\n                                                                    <div class="stop">\n                                                                        <span class="stop-info"></span>\n                                                                        <span class="stop-city"></span>\n                                                                        <span class="stop-time"></span>\n                                                                    </div>\n                                                            <% } %>\n                                                            <div class="back clearfix">\n                                                                <% if(ticket.arriveDay) { %>\n                                                                    <span class="back-timeadd"><%= ticket.arriveTime %></span>\n                                                                <% } else { %>\n                                                                    <span class="back-time"><%= ticket.arriveTime %></span>\n                                                                <% } %>\n                                                                <div class="backinfo">\n                                                                    <span class="back-city"><%= ticket.destinationCityName %></span>\n                                                                    <span class="back-airport"><%= ticket.destinationAirportName %><%= ticket.aTerminal %></span>\n                                                                </div>\n                                                            </div>\n                                                        </div>\n                                                        <div class="flight-detail-content-flighttime">\n                                                            <div class="flighttime">\n                                                                <div><%= ticket.duration %></div>\n                                                            <% if(ticket.onTimeRate) { %>\n                                                                <div class="ontimenumber"><%= ticket.onTimeRate %>%</div>\n                                                            <% } %>\n                                                            </div>\n                                                        </div>\n                                                    </div>\n                                                    <% if (ticketIndex < ticketLength - 1) { %>\n                                                        <div class="flight-detail-transferdetail">\n                                                            <div class="transferdetail-title">\n                                                                <span class="transferdetail-city"><%= ticket.destinationCityName %></span>\n                                                                <% if (ticket.trainsitTime) { %>\n                                                                    <span class="transferdetail-time"><%= ticket.trainsitTime %></span>\n                                                                <% } %>\n                                                            </div>\n                                                            <% if (ticket.transferTips) { %>\n                                                                <ul class="transferdetail-content">\n                                                                    <li class="transferdetail-info">\n                                                                        <span class="info"><%= ticket.transferTips %></span>\n                                                                    </li>\n                                                                </ul>\n                                                            <% } %>\n                                                        </div>\n                                                    <% } %>\n                                                </div>\n                                            <% }) %>\n                                        <\/script>\n                                    </div>\n                                    <div class="resource-cell flight-line">\n                                        <span class="flightnumber">\n                                            <span class="flight-number"><%= ticket.flightNo %></span>\n                                            <% if (ticket.shareAirlineName) { %>\n                                            <span class="share-flight">()</span>\n                                            <% } %>\n                                            <script class="J_share-flight" type="text/template">\n                                            <ul class="share-flight-info">\n                                                <% if (ticket.shareAirlineName) { %>\n                                                    <li><%= ticket.airlineName %><%= ticket.flightNo %> <%= ticket.shareAirlineName %><%= ticket.shareFlightNo %></li>\n                                                <%  } %>\n                                            </ul>\n                                            <\/script>\n                                            <% if (ticket.airplaneTypeName) { %>\n                                            <span class="flight-type">| <%= ticket.airplaneTypeName %></span>\n                                        <% } %>\n                                        </span>\n                                    </div>\n                                </div>\n                                <div class="resource-col flight-depart">\n                                    <div class="resource-cell flight-time"><%= ticket.departTime %></div>\n                                    <div class="resource-cell flight-port"><%= ticket.departureAirportName %><%= ticket.dTerminal %></div>\n                                </div>\n                                <div class="resource-col flight-process">\n                                    <% if (ticket.stopNum && ticket.stopPointList) { %>\n                                        <div class="J_flightStop resource-cell flight-tip" data-content="<%= (ticket.stopPointList || []).map(function(point) {\n                                            var stoptimeinfo;\n                                            stoptimeinfo = point.stopTime ? \'\' : "";\n                                            return \':\' + point.stopCityName + stoptimeinfo + point.stopTime}).join(\'<br>\') %>"></div>\n                                    <% } else { %>\n                                        <div class="resource-cell flight-tip">&nbsp;</div>\n                                    <% } %>\n                                    <i class="resource-cell flight-durationarrow"></i>\n                                    <div class="resource-cell flight-duration"><%= ticket.duration %></div>\n                                </div>\n                                <div class="resource-col flight-dest">\n                                    <div class="resource-cell flight-time"><%= ticket.arriveTime %>\n                                        <% if (ticket.arriveDay > 0) { %>\n                                            <i class="J_flightOtherDay flight-tip icon icon-plus-one">+<%= ticket.arriveDay %></i>\n                                            <script class="J_flightOtherDaydetail" type="text/template">\n                                                <div class="flightday">\n                                                    &nbsp<%= ticket.arriveDate %>&nbsp\n                                                </div>\n                                            <\/script>\n                                        <% } %>\n                                    </div>\n                                    <div class="resource-cell flight-port"><%= ticket.destinationAirportName %><%= ticket.aTerminal %></div>\n                                </div>\n                                <% if (ticket.additionals && ticket.additionals.length) { %>\n                                    <div class="resource-col flight-seat with-tip">\n                                        <div class="resource-cell flight-seat-name"><%= ticket.seatType %></div>\n                                        <div class="resource-cell seat-tip">\n                                            <a class="J_flightSeatTip" href="javascript:;"></a>\n                                            <script class="J_flightBuyDetail" type="text/template">\n                                                <div class="flight-buydetail">\n                                                    <div class="flight-buydetail-title"> </div>\n                                                    <table class="flight-buydetail-body">\n                                                        <% ticket.additionals.forEach(function(additional) { %>\n                                                            <tr>\n                                                                <td class="label"><%= additional.title %></td>\n                                                                <td class="content"><%= additional.description %></td>\n                                                            </tr>\n                                                        <% }) %>\n                                                    </table>\n                                                    <div class="flight-buydetail-foot">*</div>\n                                                </div>\n                                            <\/script>\n                                        </div>\n                                    </div>\n                                <% } else { %>\n                                    <div class="resource-col flight-seat no-tip">\n                                        <div class="resource-cell flight-seat-name"><%= ticket.seatType %></div>\n                                    </div>\n                                <% } %>\n                            </div>\n                            <% if (ticketIndex < ticketLength - 1) { %>\n                                <div class="flight-separation">\n                                    <div class="flight-transition">\n                                        <%= ticket.destinationCityName %>\n                                        <% if (ticket.trainsitTime) { %>\n                                            &nbsp;: <%= ticket.trainsitTime %>\n                                        <% } %>\n                                    </div>\n                                </div>\n                            <% } %>\n                            <% if (ticket.visaTips) { %>\n                                <% visas.push(ticket.visaTips) %>\n                            <% } %>\n                        <% }) %>\n                    </div>\n                <% }) %>\n            </div>\n        <% })%>\n    </div>\n    <div class="flight-visas">\n        <% if(visas.length) { %> \n            <% Array.prototype.distinctVisas = function(){ %>\n            <% var res = []; %>\n            <% var json = {}; %>\n            <% for(var i = 0; i < this.length; i++){ %>\n                    <% if(!json[this[i]]) { %>\n                    <% res.push(this[i]); %>\n                    <% json[this[i]] = 1; %>\n                <% } %>\n                <% } %>\n                <% return res; %>\n            <% } %>\n            <% var res = visas.distinctVisas(); %>\n            <% res.forEach(function(visa) { %>\n                <div class="visa"><%= visa%></div>\n            <% }) %>\n        <% } %>\n    </div>\n    <div class="J_changeButton button"></div>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.category=function(e){return new a.Component({type:"category",el:e.el,data:e.data,children:e.children,callback:{render:function(e){return c(e)},mount:function(e,t){var n=this.$(".J_blockBody");t.forEach(function(e){return n.append(e.getDOM())})},bind:function(){}},events:{},factory:{pack:r.pack,hotel:s.hotel}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(23),o=n(106),r=n(511),s=n(515),c=i.compile(o.blockTemplate,{client:!0,compileDebug:!1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pack=function(e){return new a.Component({type:"pack",el:e.el,data:e.data,children:e.children,methods:{update:function(){var e=this,t=this.filterChild("selected",!0);if(t){var n=t.get("adultPrice"),i=t.get("resId");this.$(".J_packTitle").text(t.get("pkgTypeShowName")),this.$(".J_tab").each(function(){var t=$(this),a=t.data("id"),o=e.filterChild("resId",a);if(i==a?t.addClass("active"):t.removeClass("active"),o){var r=o.get("adultPrice"),s="";o.get("selected")||(s+=r>n?"+":"-",s+=Math.abs(n-r)),t.find(".J_tabPrice").text(s)}})}},updatePackTitle:function(){this.$(".J_packTitle").text(this.get("selectedPack").pkgTypeShowName)}},callback:{render:function(e){var t=this.get(),n=this.filterChild("selected",!0);return s({selectedPack:n?n.get().data:{},selectedPackId:n.id,list:t.children.map(function(e){return e.data})})},mount:function(){var e=this.$(".J_packDetail");this.children.forEach(function(t){e.append(t.getDOM())})},bind:function(){var e=this,t=this.$(".J_tabs");this.$(".J_tab").click(function(){var t=$(this).data("id"),n=e.filterChild("resId",t);n&&e.request("change:selectedPackId",{id:n.id})}),this.$(".J_more").click(function(){t.addClass("expand")}),this.$(".J_less").click(function(){t.removeClass("expand")})}},lifecycle:{afterInitialize:function(){var e=(this.getChildren()||[])[0];e&&this.request("change:selectedPackId",{id:e.id})}},events:{"change:selected":function(e){this.methods.update()}},factory:{item:o.item}})};n(1);var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(23),o=n(512),r=n(514),s=i.compile(r.packTemplate)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.item=function(e){return new a.Component({type:"item",el:e.el,data:e.data,children:e.children,methods:{initHotelDialog:function(e,t,n){var i=new o.HotelDetail({hotelId:t,nationType:1,hotelType:1,ifNewStockHotel:!0,openOnInit:!1,flag:n});return this.addPlugin(e,i),i},showHotelDialog:function(e,t){var n=function(e){return"hotelDialog-"+e}(e),i=this.methods.initHotelDialog(n,e,t);i&&i.show()},transferHotelDataForDetail:function(e){var t=(this.get("hotels")||[]).filter(function(t){return e==t.hotelId})[0]||{};return{isInternational:!1,chineseName:t.chineseName,englishName:t.englishName,address:t.address,longitude:t.longitude,latitude:t.latitude,pictures:((t.rooms||[])[0]||{}).roomBigPics}}},callback:{render:function(e){return c(Object.assign({cdn:window.cdnConfig||{},id:this.id,helper:s.helper},{data:e}))},mount:function(e,t){},bind:function(){var e=this;this.$(".J_descMore").click(function(){e.$(".J_packDesc").addClass("expand")}),this.$(".J_descLess").click(function(){e.$(".J_packDesc").removeClass("expand")}),this.$(".J_map").click(function(){e.methods.showHotelDialog($(this).data("id"),1)}),this.$(".J_hotel").click(function(){e.methods.showHotelDialog($(this).data("id"),0)})}},events:{"change:selected":function(e){this.$element&&(this.get("selected")?this.$element.addClass("active"):this.$element.removeClass("active"))}},requests:{"change:selectedPackId":function(e){this.set("selected",e.data.id==this.id)}}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(23),o=n(161),r=n(513),s=n(48),c=i.compile(r.itemTemplate,{client:!0,compileDebug:!1,context:{removeTag:function(e){return String(e).replace(/<\/?[a-zA-Z][^>]*>/g,"")}}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemTemplate='\n<div class="pack-item<%= data.selected ? \' active\' : \'\'%>">\n    <div class="J_packBase base">\n        <dl class="description-list">\n            <dt></dt>\n            <dd><%= data.pkgName %></dd>\n            <dt></dt>\n            <dd class="J_packDesc pack-desc">\n                <div class="full"><%- data.bookNotice %></div>\n                <div class="brief"><%- this.removeTag(data.bookNotice || \'\').substr(0, 80)%><% if(data.bookNotice.length > 80){%><% } %></div>\n                <% if(data.bookNotice.length > 80){ %>\n                    <div class="J_descMore more"><i class="icon"></i></div>\n                <% } %>\n                <div class="J_descLess less"><i class="icon"></i></div>\n            </dd>\n        </dl>\n    </div>\n\n    <% if (data.flightTickets && data.flightTickets.length) { %>\n        <div class="flight">\n            <% for (var index = 0, length = data.flightTickets.length, flight; index < length, flight = data.flightTickets[index]; index++) { %>\n                <div class="resource-row flight-row">\n                    <div class="resource-inner">\n                        <div class="resource-col flight-base">\n                            <div class="resource-cell flight-date"><%= flight.flightDate %></div>\n                            <div class="resource-cell flight-location"><%= flight.departureCityName %>  <%= flight.destinationCityName %></div>\n                        </div>\n                        <div class="resource-col flight-company">\n                            <div class="resource-cell flight-company-name"><%= flight.airlineName %></div>\n                            <div class="resource-cell flight-line">\n                                <span class="flight-number"><%= flight.flightNo%></span>\n                                <span class="flight-type"><%= flight.airplaneTypeName %></span>\n                            </div>\n                        </div>\n                        <div class="resource-col flight-depart">\n                            <div class="resource-cell flight-time"><%= flight.departTime %></div>\n                            <div class="resource-cell flight-port"><%= flight.departureAirportName %></div>\n                        </div>\n                        <div class="resource-col flight-process">\n                            <div class="resource-cell flight-tip">\n                                <% if (flight.stopNum) { %>\n                                    <i class="icon"></i>\n                                <% }%>\n                            </div>\n                            <div class="resource-cell flight-duration"><%= flight.totalDuration %></div>\n                        </div>\n                        <div class="resource-col flight-dest">\n                            <div class="resource-cell flight-time"><%= flight.arriveTime %>\n                                <% if (flight.arriveDay) { %>\n                                    <i class="flight-tip icon icon-plus-one">+<%= flight.arriveDay %></i>\n                                <% } %>\n                            </div>\n                            <div class="resource-cell flight-port"><%= flight.destinationAirportName %></div>\n                        </div>\n                        <div class="resource-col flight-seat">\n                            <div class="resource-cell flight-seat-name"><%= flight.seatType %></div>\n                        </div>\n                    </div>\n                </div>\n            <% } %>\n        </div>\n    <% } %>\n\n    <% if (data.hotels && data.hotels.length) { %>\n        <div class="hotel">\n            <% for (var index = 0, length = data.hotels.length, hotel; index < length, hotel = data.hotels[index]; index++) { %>\n                <div class="resource-row hotel-row">\n                    <div class="hotel-base"><%= hotel.startDate %> <%= hotel.endDate %>    <%= hotel.liveNight %> </div>\n                    <div class="hotel-detail">\n                        <div class="hotel-photo">\n                            <% if (hotel.hotelPic) { %>\n                                <img src="<%= helper.resizeImage(hotel.hotelPic, 180, 100, 1)%>">\n                            <% } else { %>\n                                <img src="<%= cdn.url %>/static/img/<%= cdn.version %>/modules/tour/assets/self-tour-pack-hotel.png">\n                            <% } %>\n                        </div>\n\n                        <div class="hotel-info">\n                            <div class="hotel-title">\n                                <strong class="hotel-name J_hotel" data-id="<%= hotel.hotelId %>"><%= hotel.chineseName %></strong>\n                                <span class="hotel-level"><%= hotel.star %></span>\n                            </div>\n\n                            <% if (hotel.commentScore) { %>\n                                <div class="hotel-statis">\n                                    <strong><%= hotel.commentScore%></strong><span>/5</span>\n                                    <% if (false) { %>\n                                        ( <%= hotel.remarkAmount %> )\n                                    <% } %>\n                                </div>\n                            <% } %>\n\n                            <div class="hotel-addr">\n                                <%= hotel.address %>\n                                <% if (hotel.latitude && hotel.longitude) { %>\n                                    <a class="J_map hotel-location" data-id="<%= hotel.hotelId %>" href="javascript:;"><i class="icon icon-location"></i></a>\n                                <% } %>\n                            </div>\n\n                            <% if (hotel.rooms && hotel.rooms.length) { %>\n                                <% for (var roomIndex = 0, roomLength = hotel.rooms.length, room; roomIndex < roomLength, room = hotel.rooms[roomIndex]; roomIndex++) { %>\n                                    <div class="hotel-room">\n                                        <strong class="hotel-room-name"><%= room.name + \' \' + room.hotelPackages[0].ratePlanName %></strong>\n                                        <span class="hotel-room-config"><%= room.hotelPackages[0].bedType %> / <%= room.hotelPackages[0].breakfast+"/" || "" %> <%= room.hotelPackages[0].network %></span>\n                                        <span class="hotel-room-number"><%= hotel.houseNum %></span>\n                                    </div>\n                                <% } %>\n                            <% } %>\n\n                        </div>\n\n                    </div>\n                </div>\n            <% } %>\n        </div>\n    <% } %>\n\n    <% if (data.tickets && data.tickets.length) { %>\n\n        <div class="ticket">\n        <div class="ticket-head">\n            <span class="name"></span>\n            <span class="date"></span>\n            <span class="count"></span>\n        </div>\n            <% for (var index = 0, length = data.tickets.length, ticket; index < length, ticket = data.tickets[index]; index++) { %>\n                <div class="resource-row ticket-row">\n                    <div class="ticket-name"><%= ticket.itemName %></div>\n                    <div class="ticket-date"><%= ticket.itemDate %></div>\n                    <div class="ticket-number"><%= data.pkgAvailNum %><%= ticket.unit || \'\' %></div>\n                </div>\n            <% } %>\n        </div>\n    <% } %>\n\n\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.packTemplate='\n<div class="row pack">\n\n    <div class="row-head">\n        <i class="icon icon-pack"></i>\n        <strong class="J_packTitle title"><%= selectedPack.pkgTypeShowName %></strong>\n    </div>\n\n    <div class="row-body">\n        <% if (list && list.length > 1) { %>\n            <div class="J_tabs tabs">\n                <% for (var index = 0, length = list.length, item; index < length, item = list[index]; index++) {%>\n                    <div class="J_tab tab<%= selectedPack && selectedPack.resId == item.resId ? \' active\' : \'\' %><%= (index > 4 && length != 6) ? \' overflow\' : \'\' %>"\n                         title="<%= item.pkgTypeShowName %>"\n                         data-id="<%= item.resId %>">\n                        <div class="box">\n                            <span>\n                                <div><%= index+1 %></div>\n                                <strong class="J_tabPrice price">\n                                    <% if (selectedPack.adultPrice != item.adultPrice) { %>\n                                        <%= selectedPack.adultPrice < item.adultPrice ? \'+\' : \'-\' %><%= Math.abs(selectedPack.adultPrice - item.adultPrice) %>\n                                    <% } %>\n                                </strong>\n                            </span>\n                        </div>\n                    </div>\n                <% } %>\n\n                <% if (length > 6) { %>\n                    <div class="J_more tab more">\n                        <div class="box">\n                            <span><i class="icon"></i></span>\n                        </div>\n                    </div>\n                    <div class="J_less tab less">\n                        <div class="box">\n                            <span><i class="icon"></i></span>\n                        </div>\n                    </div>\n                <% } %>\n\n            </div>\n        <% } %>\n\n        <div class="J_packDetail detail"></div>\n\n    </div>\n\n</div>\n'},function(e,t,n){"use strict";function i(e,t,n){var i=t,a=!1,r=0,s=e;return i.forEach(function(t){var n=t.hotelPackages,i=!1;Array.isArray(n)&&n.length&&n.forEach(function(n){n.select=!1,n.adultNum=t.adultNum,n.baseNum=t.baseNum>0?t.baseNum:0,n.childNum=t.childNum,n.roomName=t.name,(n.conditionRatePlanId&&n.conditionRatePlanId==e.conditionRatePlanId||n.ratePlanId&&n.ratePlanId==s.ratePlanId&&n.vendorId==s.vendorId)&&(a=!0,n.select=!0,i=!0,r=n.price)}),t.select=!!i}),i.forEach(function(e){e.selectNum=e.roomNum=Math.ceil((0,o.getStore)().getState("adult")/(e.adultNum||e.baseNum||2));var t=e.hotelPackages;Array.isArray(t)&&t.length&&t.forEach(function(t){t.diffPrice=Number(t.price-r),t.selectNum=t.roomNum=e.roomNum})}),a||(n.select=!0,n.beShow=!0,n.roomNum=s.roomNum,n.hotelPackages.length=0,s.select=!0,s.ratePlanId=s.roomId,r=s.price,n.hotelPackages.push(s),i=[n].concat(i)),i}Object.defineProperty(t,"__esModule",{value:!0}),t.hotel=function(e){return new r.Component({type:"hotel",el:e.el,data:e.data,children:e.children,methods:{updateSelectDOM:function(){this.get("isStock");var e=this.get("selectRoom"),t=e.roomName+" "+e.ratePlanName,n=(e.bedType||"--")+"/"+(e.breakfast||"--")+"/"+(e.network||"--");this.$(".select-room-name").html(t).attr({title:t}),this.$(".select-room-info").text(n).attr({title:n})},updateSelectNum:function(e){var t=this,n=0,i="",a=this.data;!function(){var i=t.get("selectRoom");i.selectNum=e,t.get("isStock")?n=i.roomNum=Math.ceil((0,o.getStore)().getState("adult")/(i.adultNum||(i.baseNum>0?i.baseNum:0)||2)):(i.selectNum=e,n=Math.ceil((0,o.getStore)().getState("adult")/(i.adultNum||(i.baseNum>0?i.baseNum:0)||2)))}(),a.childRoomNum>0&&t.get("isStock")&&2==t.get("nation")&&(a.selectRoom.childNum>0&&a.childRoomNum>a.selectRoom.selectNum*a.selectRoom.childNum&&(i=""+a.selectRoom.childNum+"                        "),this.$(".res-hotel-tip").html(i)),this.$(".select-plan .J_roomCount").html(p({roomNum:n,selectNum:e}))}},callback:{render:function(e){return m({hotel:e})},mount:function(){var e=this.getChildren(),t=$("<div />");e.forEach(function(e){t.append(e.getDOM())}),this.$(".res-rooms-main").append(t.children())},bind:function(){var e=this,t=(0,o.getStore)();this.$(".J_trigger-detail").click(function(){new c.HotelDetail({hotelId:e.get("hotelId"),nationType:e.get("nation"),hotelType:e.get("isConditionHotel")?3:e.get("isStock")?1:2,ifNewStockHotel:!0})}),this.$(".J_showMap").click(function(){new c.HotelDetail({hotelId:e.get("hotelId"),nationType:e.get("nation"),hotelType:e.get("isConditionHotel")?3:e.get("isStock")?1:2,flag:1,ifNewStockHotel:!0})}),this.$(".J_showAll-hotel").click(function(){$(this).hasClass("J_showAll-hotel")?($(this).find("span").html(""),$(this).removeClass("J_showAll-hotel").addClass("J_hideAll-hotel"),e.set("showAll",!0),e.$(".res-hotel-rooms").show(),e.$(".res-rooms-main").show()):($(this).find("span").html(""),$(this).removeClass("J_hideAll-hotel").addClass("J_showAll-hotel"),e.set("showAll",!1),e.$(".J_showAll-hotel").show(),e.$(".res-hotel-rooms").hide(),e.$(".res-rooms-main").hide())}),this.$(".J_hideAll-hotel").click(function(){e.set("showAll",!1),e.$(".J_showAll-hotel").show(),e.$(".res-hotel-rooms").hide(),e.$(".res-rooms-main").hide(),e.$(".open-plans").removeClass("J_hideAll-hotel").addClass("J_showAll-hotel").find("span").html("")}),this.$(".J_change-hotel").click(function(){var n=app_url("package/"+t.getState("productId")+"/hotelList/?productTypeName="+t.getState("productTypeName")+"&departsDate="+t.getState("departDate")+"&startDepartsDate="+e.get("journeyStartDate")+"&endDepartsDate="+e.get("journeyEndDate")+"&bookCityCode="+t.getState("bookCityCode")+"&journeyId="+e.get("journeyId")+"&roomNum="+e.get("roomNum")+"&adultNum="+t.getState("adult")+"&childNum="+t.getState("child")+"&destinationCityName="+e.get("destinationCityName")+"&liveNight="+e.get("liveNight")+"&isStock="+(e.get("isConditionHotel")?3:e.get("isStock")?1:0)+"&callback="+e.iframeCallback+"&isSupportCondition="+t.getState("isSupportCondition"));h.dialog.open({title:"",url:n,area:["1020px","95%"],callback:function(n){n.data.adultRoomNum=t.getState("adult"),n.data.childRoomNum=t.getState("child"),e.load({data:n.data,children:n.children})}}),window.currentHotel=e.get("selectRoom")}),this.$(".select-plan").on("change","select",function(){var t=$(this).data("resId"),n=$(this).val();e.request("change:selectNum",{id:t,selectNum:n})}),this.$(".J_prev").click(function(){var e=$(this);f.hotelConfig.showPrev(e)}),this.$(".J_next").click(function(){var e=$(this);f.hotelConfig.showNext(e)})}},lifecycle:{beforeInitialize:function(){},afterCreate:function(){var e=this,t=(this.getChildren()||[])[0],n=(this.get("isStock"),(0,o.getStore)());t&&(this.set("selectRoom",t.get().data.hotelPackages[0]),this.set("selectId",t.id)),function(e){return new Promise(function(t,n){$.ajax({type:"GET",url:s.config.url.hotelRooms(),data:{d:JSON.stringify(e)},dataType:"json",success:function(e){e&&e.success&&e.data?t(e.data):n("")},error:function(){n("")}})})}({departDate:n.getState("departDate"),startDepartsDate:e.get("journeyStartDate"),endDepartsDate:e.get("journeyEndDate"),productId:n.getState("productId"),journeyId:e.get("journeyId"),hotelId:e.get("hotelId"),hotelType:e.get("isConditionHotel")?3:e.get("isStock")?1:2,nationType:e.get("nation"),cityCode:e.get("destinationCityCode"),roomNum:e.get("roomNum"),adultNum:n.getState("adult"),childNum:n.getState("child"),ifNewStockHotel:!0,cids:e.get("cids")}).then(function(t){var n=e.get("selectRoom"),a=void 0,r=null;t.forEach(function(e,t){e.beShow=!0}),e.set("loading",!1),a=i(n,t,e.get("rooms")[0]).map(function(e){return{type:"plan",data:e,children:e.hotelPackages.map(function(t){return t.select&&(r=Object.assign({roomId:e.roomId},t)),{type:"item",data:t}})}}),e.set("selectRoom",r);var s=Math.ceil((0,o.getStore)().getState("adult")/(r.adultNum||r.baseNum||2));e.load({data:e.get().data,children:a}),e.methods.updateSelectNum(s)},function(t){e.set("loading",!1),e.$(".res-rooms-main").html(t)})['catch'](function(e){})},beforeRender:function(){},afterRender:function(){},beforeMount:function(){},afterMount:function(){},beforeBind:function(){},afterBind:function(){}},events:{"change:select":function(e){if(e.data.after){var t=e.originTarget,n=t.get().data,i=t.id,a=t.type;this.$(".J_hideAll-hotel").click(),this.set("selectId",i),"plan"==a?(n=t.filterChild("select",!0),this.set("selectRoom",t.filterChild("select",!0))):this.set("selectRoom",n),this.methods.updateSelectDOM(),this.methods.updateSelectNum(n.selectNum),this.request("change:select",{id:t.get("conditionRatePlanId")||t.get("ratePlanId")||t.get("roomId"),basePrice:t.get("roomPrice")||t.get("price"),vendorId:t.get("vendorId")||""})}},"change:selectNum":function(e){if(e.originTarget.get("select")){var t=e.originTarget,n=e.data.after;this.methods.updateSelectNum(n),this.request("change:selectNum",{id:t.get("ratePlanId")||t.get("roomId"),selectNum:n})}}},factory:{plan:u.plan,room:d.room}})};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),o=n(1),r=n(23),s=n(19),c=n(161),l=n(516),d=n(517),u=n(518),f=n(172),h=(n(10),n(53)),p=a.compile('\n    <select class="hotel_num" name="hotel_num" data-roomid="">\n        <% for(var i = roomNum; i <= 20; i++) {%>\n            <% if(i == selectNum) {%>\n            <option selected="selected"><%= i%></option>\n            <% } else { %>\n            <option><%= i%></option>\n            <% } %>\n        <%}%>\n    </select> \n',{client:!0,compileDebug:!1}),m=a.compile(l.hotelTemplate,{client:!0,compileDebug:!1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.hotelTemplate='\n\n    <%\n        var dateToMonth = function(v) {\n            var d = new Date(v.replace(/-/g, \'/\'));\n            return (d.getMonth() + 1) + \'\' + d.getDate() + \'\';\n        };\n\n    var formatBreakfast = function(i){\n        var arr = [\'\',\'\',\'\',\'\',\'\',\'\',\'\',\'\',\'\',\'\']\n        return arr[i];\n    }\n\n    %>\n\n    <div class="resource-hotel">\n        <div class="res-hotel-title"><i class="icons-hotel"></i><strong class="res-hotel-name"><%= hotel.destinationCityName%><%= hotel.liveNight%></strong><span class="res-hotel-date"><%= dateToMonth(hotel.journeyStartDate);%> <%= dateToMonth(hotel.journeyEndDate);%> </span></div>\n        <div class="res-hotel-block">\n            <div class="res-hotel-image"><img class="J_trigger-detail" src="<%= hotel.hotelPic ? hotel.hotelPic : \'http://img.tuniucdn.com/img/201602262050/boss3_driver/nohotel.jpg\'%>" alt="<%= hotel.chineseName%>" width=180 height=100></div>\n            <div class="res-hotel-instruction">\n                <h2><a href="javascript:;" class="J_trigger-detail" title="<%= hotel.chineseName%>"><%= hotel.chineseName%></a><span><%=hotel.star%></span></h2>\n                <p class="res-hotel-comment">\n                    <% if(hotel.commentScore && hotel.commentScore != 0){ %>\n                    <span> <em class="res-comment-active"><%=hotel.commentScore || \'0\'%></em><em class="res-comment-default">/<%=hotel.fullScore || \'5\'%></em></span>\n                    <% } %>\n                    <% if(hotel.remarkAmoun && hotel.remarkAmoun != 0){ %>\n                    <span>( <%= hotel.remarkAmount%> )</span>\n                    <% }%>\n                </p>\n\n                <p class="res-hote-address"><%= hotel.address%> <% if (hotel.nation == 1) {%><a class="J_showMap" href="javascript:void(0);"><i class="icons-local"></i></a><%}%></p>\n                <div class="select-plan">\n                <% if(hotel.isStock) { %>\n                    <div class="select-room-name" title="<%= hotel.selectRoom.roomName  + \' \' + hotel.selectRoom.ratePlanName%>"><%= hotel.selectRoom.roomName + \' \' + hotel.selectRoom.ratePlanName%></div>\n                    <div class="select-room-info" title="<%= hotel.selectRoom.bedType || \'--\'%>/<%= hotel.selectRoom.breakfast || \'--\'%>/<%= hotel.selectRoom.network || \'--\'%>"><%= hotel.selectRoom.bedType || \'--\'%>/<%= hotel.selectRoom.breakfast || \'--\'%>/<%= hotel.selectRoom.network || \'--\'%></div>\n                    <div class="select-room-count J_roomCount">\n                        <select class="hotel_num" name="hotel_num" data-resId="<%=hotel.selectRoom.ratePlanId%>">\n                <% } else { %>\n                    <div class="select-room-name" title="<%= hotel.selectRoom.roomName + \' \' + hotel.selectRoom.ratePlanName %>"><%= hotel.selectRoom.roomName + \' \' + hotel.selectRoom.ratePlanName%></div>\n                    <div class="select-room-info" title="<%= hotel.selectRoom.bedType || \'--\' %>/<%= hotel.selectRoom.breakfast || \'--\' %>/<%= hotel.selectRoom.network || \'--\' %>"><%= hotel.selectRoom.bedType || \'--\' %>/<%= hotel.selectRoom.breakfast || \'--\' %>/<%= hotel.selectRoom.network || \'--\' %></div>\n                    <div class="select-room-count J_roomCount">\n                        <select class="hotel_num" name="hotel_num" data-resId="<%=hotel.selectRoom.ratePlanId%>">\n                <% } %>\n                        <% for(var i = hotel.roomNum; i <= 20; i++) {%>\n                            <% if(i == hotel.selectNum) {%>\n                            <option selected="selected"><%= i%></option>\n                            <% } else { %>\n                            <option><%= i%></option>\n                            <% } %>\n                        <%}%>\n                        </select> \n                    </div>\n                    <div class="J_showAll-hotel open-plans" <% if(hotel.showAll) {%> style="display: none;"<%}%> ><span></span><i class="iconfont icon"></i></div>\n                </div>\n                <% if(!hotel.gotoHouseListDirectly) {%>\n                    <a class="J_change-hotel" href="javascript:;"></a>\n                <% } %>\n                <% if(hotel.childRoomNum > 0 && hotel.isStock && hotel.nation == 2){ %>\n                    <div class="res-hotel-tip">\n                        <% if(hotel.selectRoom.childNum > 0 && hotel.childRoomNum > hotel.selectRoom.selectNum * hotel.selectRoom.childNum) { %>\n                            <%= hotel.selectRoom.childNum  %>\n                        <% } %>\n                    </div>\n                <% } %>\n            </div>\n        </div>\n        <div class="res-hotel-rooms <% if(!hotel.showAll) {%> hide <%}%>">\n            <div class="res-rooms-head">\n                <span class="res-rooms-type"></span>\n                <span class="res-rooms-bed"></span>\n                <span class="res-rooms-breakfast"></span>\n                <span class="res-rooms-network"></span>\n                <span class="res-rooms-count"></span>\n                <span class="res-rooms-price"></span>\n                <span class="res-rooms-select"></span>\n            </div>\n            <% if(hotel.loading) {%>\n            <div class="loading"></div>\n            <% } %>\n            <div class="res-rooms-main <% if(!hotel.showAll || hotel.loading) {%> hide <%}%>"></div>\n            <div class="J_hideAll-hotel"><span></span><i class="iconfont icon"></i></div>\n        </div>\n    </div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.room=function(e){return new a.Component({type:"room",el:e.el,data:e.data,children:e.children,methods:{update:function(){var e=this.get().data,t=e.diffPrice>=0?"+"+e.diffPrice+"/":"-"+-1*e.diffPrice+"/";this.$(".res-rooms-select").html(d({select:e.select})),this.$(".res-rooms-count").html(l({select:e.select,roomNum:e.roomNum,selectNum:e.selectNum})),e.select?this.$(".res-rooms-price").html("--"):this.$(".res-rooms-price").html(t)}},callback:{render:function(e){return c(Object.assign({room:e},u))},mount:function(){},bind:function(){var e=this;this.$(".J_room-detail").click(function(){$(this).hasClass("show")?($(this).removeClass("show"),e.$(".res-rooms-detail").hide()):($(this).addClass("show"),e.$(".res-rooms-detail").show())}),this.$(".res-detail-close").click(function(){$(this).removeClass("show"),e.$(".res-rooms-detail").hide()}),this.$element.on("click",".J_rooms_choose",function(){$(this).index(),e.set("select",!0)}),this.$element.on("change","select",function(){var t=$(this).val();e.set("selectNum",t)})}},lifecycle:{beforeInitialize:function(){},afterInitialize:function(){},beforeRender:function(){},afterRender:function(){},beforeMount:function(){},afterMount:function(){},beforeBind:function(){},afterBind:function(){}},events:{},factory:{item:s.item},requests:{"change:select":function(e){var t=this.get("roomPrice")-e.data.basePrice;e.data.id!=this.get("roomId")&&this.set("select",!1),this.set("diffPrice",t),this.methods.update()},"change:selectNum":function(e){e.data.id!=this.get("roomId")&&(this.set("selectNum",e.data.selectNum),this.methods.update())}}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(23),o=n(169),r=n(48),s=n(397),c=i.compile(o.roomTemplate,{client:!0,compileDebug:!1}),l=i.compile('\n    <%if(select) {%>\n    <select class="hotel_num" name="hotel_num" data-roomid="">\n        <% for(var i = roomNum; i <= 20; i++) {%>\n            <% if(i == selectNum) {%>\n            <option selected="selected"><%= i%></option>\n            <% } else { %>\n            <option><%= i%></option>\n            <% } %>\n        <%}%>\n    </select> \n    <%}else{%>\n    --\n    <%}%>\n',{client:!0,compileDebug:!1}),d=i.compile('\n    <%if(select) {%>\n        <em class="res-label-selected"><i class="icon-selected"></i></em>\n    <%}else{%>\n        <a href="javascript:;" class="J_rooms_choose"></a>\n    <%}%>\n',{client:!0,compileDebug:!1}),u={helper:r.helper}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.plan=function(e){return new a.Component({type:"plan",el:e.el,data:e.data,children:e.children,methods:{update:function(e){var t=e.get().data,n=t.select?"--":t.diffPrice>=0?"+"+t.diffPrice+"/":"-"+-1*t.diffPrice+"/";this.$(".res-rooms-select").html(f({select:t.select})),this.$(".res-rooms-count").html(u({select:t.select,roomNum:t.roomNum,selectNum:t.selectNum})),this.$(".J_select-ratePlan .res-rooms-price").html(n)}},callback:{render:function(e){return l(Object.assign(e,d))},mount:function(){var e=this.getChildren(),t=$("<div />");e.forEach(function(e,n){n>2&&$(e.getDOM()).addClass("behind-plan").css({display:"none"}),t.append(e.getDOM())}),this.$(".hotel-ratePlan-list").append(t.children())},bind:function(){var e=this;this.$(".J_room-detail").click(function(){$(this).hasClass("show")?($(this).removeClass("show"),e.$(".res-rooms-detail").hide()):($(this).addClass("show"),e.$(".res-rooms-detail").show())}),this.$(".res-detail-close").click(function(){e.$(".res-rooms-detail").hide(),$(".J_room-detail").removeClass("show")}),this.$(".J_select-ratePlan").on("click",".J_rooms_choose",function(){var t=$(this).parents(".hotel-ratePlan").data("conditionRatePlanId"),n=$(this).parents(".hotel-ratePlan").data("rateplanid");(t?e.filterChild("conditionRatePlanId",t):e.filterChild("ratePlanId",n)).set("select",!0)}),this.$(".J_select-ratePlan").on("change","select",function(){var t=$(this).val(),n=$(this).parents(".hotel-ratePlan").data("rateplanid");e.filterChild("ratePlanId",n).set("selectNum",t)}),this.$(".J_showAll-plans").click(function(){$(this).hasClass("J_showAll-plans")?($(this).find(".off").removeClass("off").addClass("on"),$(this).removeClass("J_showAll-plans").addClass("J_closeAll-plans").find("span").html(""),$(this).siblings(".hotel-ratePlan-list").children(".res-rooms-ratePlan").css({display:"block"})):($(this).find(".on").removeClass("on").addClass("off"),$(this).removeClass("J_closeAll-plans").addClass("J_showAll-plans").find("span").html(""),$(this).siblings(".hotel-ratePlan-list").children(".behind-plan").css({display:"none"}))}),this.$(".res-rooms-bed").each(function(){var e=$(this),t=e.siblings(".bed-detail").html();e.hover(function(){(0,c.showPopup)(e,{content:t})},function(){(0,c.hidePopup)()})}),this.$(".res-rooms-breakfast").each(function(){var e=$(this),t=e.siblings(".breakfast-detail").html();e.hover(function(){(0,c.showPopup)(e,{content:t})},function(){(0,c.hidePopup)()})}),this.$(".res-rooms-network").each(function(){var e=$(this),t=e.siblings(".network-detail").html();e.hover(function(){(0,c.showPopup)(e,{content:t})},function(){(0,c.hidePopup)()})})}},lifecycle:{beforeInitialize:function(){},afterInitialize:function(){},beforeRender:function(){},afterRender:function(){},beforeMount:function(){},afterMount:function(){},beforeBind:function(){},afterBind:function(){}},events:{},factory:{item:s.item},requests:{"change:select":function(e){var t=this.filterChild("conditionRatePlanId",e.data.id)||this.filterChild("ratePlanId",e.data.id);t||(t=this.getChildren()[0]).set("select",!1);var n=t.get("price")-e.data.basePrice;t.set("diffPrice",n),this.methods.update(t)},"change:selectNum":function(e){var t=this.filterChild("ratePlanId",e.data.id);t||(t=this.getChildren()[0]),t.set("selectNum",e.data.selectNum,{silent:!0}),this.methods.update(t)}}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(23),o=n(171),r=n(48),s=n(397),c=n(107),l=i.compile(o.planTemplate,{client:!0,compileDebug:!1}),d={helper:r.helper},u=i.compile('\n    <%if(select) {%>\n    <select class="hotel_num" name="hotel_num" data-roomid="">\n        <% for(var i = roomNum; i <= 20; i++) {%>\n            <% if(i == selectNum) {%>\n            <option selected="selected"><%= i%></option>\n            <% } else { %>\n            <option><%= i%></option>\n            <% } %>\n        <%}%>\n    </select> \n    <%}else{%>\n    --\n    <%}%>\n',{client:!0,compileDebug:!1}),f=i.compile('\n    <%if(select) {%>\n        <em class="res-label-selected"><i class="icon-selected"></i></em>\n    <%}else{%>\n        <a href="javascript:;" class="J_rooms_choose"></a>\n    <%}%>\n',{client:!0,compileDebug:!1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ticket=function(e){var t=e.children;return new a.Component({type:"ticket",el:e.el,data:e.data,children:e.children,callback:{render:function(e){if(Array.isArray(t)&&t.length)return s(e)},mount:function(e,t){if(Array.isArray(t)&&t.length){var n=this.$(".J_blockBody");t.forEach(function(e){return n.append(e.getDOM())})}},bind:function(){}},events:{},factory:{ticketlist:r.ticketlist}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(23),o=n(106),r=n(520),s=i.compile(o.blockTemplate,{client:!0,compileDebug:!1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ticketlist=function(e){return new o.Component({type:"ticketlist",el:e.el,data:e.data,children:e.children,methods:{showTicketListDialog:function(e,t){var n=(0,a.getStore)(),i=n.getState("productTypeName");i="drive"==i?i:"package",c.dialog.open({title:"",url:app_url(i+"/"+n.getState("productId")+"/ticketList"),area:["1020px","95%"],callback:t,data:{baseInfo:{productId:n.getState("productId"),bookCityCode:n.getState("bookCityCode"),departCityCode:n.getState("departCityCode"),backCityCode:n.getState("backCityCode"),adult:n.getState("adult"),child:n.getState("child"),departDate:n.getState("departDate"),freeChild:n.getState("freeChild"),journeyId:n.getState("journeyId")},ticketData:e}})},toggleSelectTicket:function(e,t){this.methods.getTicketData.call(this,e).selected=t?1:0},eachTicket:function(e,t){(e||[]).forEach(function(e){(e.tickets||[]).forEach(function(n){t&&t(n,e)})})},isOnlyTicketSelected:function(e){var t=0;return this.methods.eachTicket(e,function(e){e.selected&&t++}),1===t},mergeTicketList:function(e){var t=this.get().data,n={};return this.methods.eachTicket(e.list,function(e,t){n[t.scenicId]||(n[t.scenicId]={scenic:t,ticketKV:{}}),n[t.scenicId].ticketKV[e.resourceId]=e}),(t.list||[]).forEach(function(e){(e.tickets||[]).forEach(function(t){n[e.scenicId]&&n[e.scenicId].ticketKV[t.resourceId]?(t.selected=1,t.selectedDate=n[e.scenicId].ticketKV[t.resourceId].selectedDate,t.selectedNum=n[e.scenicId].ticketKV[t.resourceId].selectedNum,t.selectedChildNum=n[e.scenicId].ticketKV[t.resourceId].selectedChildNum,delete n[e.scenicId].ticketKV[t.resourceId]):t.selected=0}),n[e.scenicId]&&n[e.scenicId].ticketKV&&(Object.keys(n[e.scenicId].ticketKV).forEach(function(t){e.tickets.push(n[e.scenicId].ticketKV[t])}),delete n[e.scenicId])}),Object.keys(n).forEach(function(e){t.list.push(n[e].scenic)}),n={},t},getTicketData:function(e){var t={};return this.methods.eachTicket(this.get().data.list,function(n){n.resourceId==e&&(t=n)}),t},showTicketDetail:function(e){s.layer.open({type:1,title:[e.resourceName,"font-weight:bold;font-size:16px;"],area:["900px","530px"],content:f({data:e,helper:l.helper})})}},callback:{render:function(e){var t=0;(e.list||[]).forEach(function(e){t+=(e.tickets||[]).length});var n={ticketlist:e.list,journeyId:e.journeyId||"",journeyName:e.journeyName||"",totalTicketNum:e.totalTicketNum||0,type:e.ticketType,isLastSelected:this.methods.isOnlyTicketSelected(e.list),isShowTicketMore:0!==e.totalTicketNum&&0!==t&&t<e.totalTicketNum};return u({ticketListData:n})},mount:function(){},bind:function(){var e=this;(0,a.getStore)(),e.$element.find(".J_ticketName").on("click",function(){var t=$(this).parents(".ticket-row").data("resid"),n=e.methods.getTicketData(t);e.methods.showTicketDetail(n)}),e.$element.find(".J_ticketDate").on("change",function(){var t=$(this),n=t.parents(".ticket-row");e.methods.getTicketData(n.data("resid")).selectedDate=t.val(),e.load({data:e.get().data})}),e.$element.find(".J_adultNum").on("change",function(){var t=$(this),n=t.parents(".ticket-row");e.methods.getTicketData(n.data("resid")).selectedNum=+t.val(),e.load({data:e.get().data})}),0!==e.get().data.ticketType&&(e.$element.find(".J_ticketCancel").on("click",function(){var t=$(this),n=t.parents(".ticket-row");e.methods.toggleSelectTicket.call(e,n.data("resid"),!t.hasClass("active")),e.load({data:e.get().data})}),e.$element.find(".J_ticketMore").on("click",function(){e.methods.showTicketListDialog.call(e,e.get().data,function(t){e.load({data:e.methods.mergeTicketList.call(e,t)})})}))}},lifecycle:{beforeInitialize:function(){},afterCreate:function(){},beforeRender:function(){},afterRender:function(){},beforeMount:function(){},afterMount:function(){},beforeBind:function(){},afterBind:function(){}},events:{},factory:{}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(1),o=n(23),r=(n(19),n(521)),s=n(10),c=n(53),l=n(48),d=n(522),u=(i.compile("\n",{client:!0,compileDebug:!1}),i.compile(r.ticketListTemplate,{client:!0,compileDebug:!1})),f=i.compile(d.ticketDetailTemplate,{client:!0,compileDebug:!1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ticketListTemplate='\n\n    <%\n        var type = ticketListData.type;\n        var ticketList = ticketListData.ticketlist;\n        if (Array.isArray(ticketList) && ticketList.length) {\n            var scenicConut = ticketList.length;\n            var isLastSelected = ticketListData.isLastSelected;\n    %>\n\n    <div class="row">\n        <div class="row-head">\n            <i class="icon icon-add"></i>\n            <strong class="title"><%= ticketListData.journeyName || \'\' %></strong>\n            <% if (type == 1) { %>\n                <span class="ticketinfo"></span>\n                <% if (ticketListData.isShowTicketMore) { %>\n                    <span class="J_ticketMore ticket-row-more"><%= ticketListData.totalTicketNum %> &gt;</span>\n                <% } %>\n            <% } %>\n        </div>\n        <div class="row-body">\n            <div class="ticket-content">\n                <div class="ticket-head clearfix">\n                    <span class="ticket-row-type"></span>\n                    <span class="ticket-row-date"></span>\n                    <span class="ticket-row-count"></span>\n                    <span class="ticket-row-group"></span>\n                    <span class="ticket-row-select"></span>\n                </div> \n                <% ticketList.forEach(function(ticket) { %>\n                    <div class="ticket-main">\n                        <div class="ticket-row-scenicname"><%= ticket.scenicName %></div>\n                        <% if(Array.isArray(ticket.tickets) && ticket.tickets.length) { %>\n                            <% ticket.tickets.forEach(function(item) { %>\n                                <div class="ticket-row clearfix" data-resid="<%= item.resourceId %>">\n                                    <span class="J_ticketName ticket-row-type ticket-row-left">\n                                        <%= item.resourceName %>\n                                    </span>\n                                    <div class="ticket-row-right">\n                                        <div class="ticket-row-list-content clearfix">\n                                            <div class="clearfix ticket-row-list">\n                                                <span class="ticket-row-date">\n                                                    <% if (1 === item.selected) { %>\n                                                        <select class="J_ticketDate">\n                                                        <% (item.useDate || []).forEach(function(date) { %>\n                                                            <option value="<%= date.departDate %>" <%= date.departDate === item.selectedDate ? \'selected\' : \'\' %> ><%= (date.departDate || \'\').substring(5) %></option>\n                                                        <% }) %>\n                                                        </select>\n                                                        \n                                                    <% } %>\n                                                </span>\n                                                <span class="ticket-row-count">\n                                                    <% if (1 === item.selected) { %>\n                                                        <select class="J_adultNum"> \n                                                            <% for(var i = item.adultMinNum; i <= item.adultMaxNum; i++) { %>\n                                                                <option value="<%= i %>" <%= +item.selectedNum === i ? \'selected\' : \'\' %> ><%= i %></option>\n                                                            <% } %>\n                                                        </select>\n                                                        \n                                                    <% } %>\n                                                </span>\n                                                <% if(type == 0) { %>\n                                                    <span class="ticket-row-group">\n                                                        \n                                                    </span>\n                                                <% } else { %>\n                                                    <span class="ticket-row-price">\n                                                        <%= item.adultPrice %>/<%= item.unit%>\n                                                    </span>\n                                                    <span class="ticket-row-select">\n                                                        <% if (!isLastSelected || item.selected !== 1) { %>\n                                                            <div class="ticket-row-btn J_ticketCancel <%= item.selected === 1 ? \'active\' : \'\'%>" data-selected="<%= item.selected%>"><%= item.selected === 1 ? \'\' : \'\'%></div>\n                                                        <% } %>\n                                                    </span>\n                                                <% } %>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n                            <% }) %>\n                        <% } %>\n                    </div>   \n                <% }) %>\n            </div>\n        </div>\n    </div>\n    <% } else { %>\n        <div class="empty"></div>\n    <% } %>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ticketDetailTemplate='\n<div class="ticket-detail">\n    <% if(data.itemIntro || data.bookNotice) { %>\n    <div class="ticket-detail-item">\n        <span><i></i></span>\n        <p><%- helper.nb2br(data.itemIntro) %></p>\n    </div>\n    <% } %>\n    <% if (data.bookNotice) { %>\n    <div class="ticket-detail-item">\n        <span><i></i></span>\n        <p><%- helper.nb2br(data.bookNotice) %></p>\n    </div>\n    <% } %>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.locale=function(e){return new a.Component({type:"locale",el:e.el,data:e.data,children:e.children||[],callback:{render:function(e){return s(e)},mount:function(e,t){var n=this.$(".J_blockBody");t.forEach(function(e){return n.append(e.getDOM())})},bind:function(){}},events:{},factory:{addition:r.addition}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(23),o=n(106),r=n(398),s=i.compile(o.blockTemplate,{client:!0,compileDebug:!1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addItem=function(e){return new o.Component({type:"addItem",el:e.el,data:e.data,children:e.children,methods:{showAdditionList:function(e){var t=this,n=(0,a.getStore)(),i=app_url("package/"+n.getState("productId")+"/addItemList?bookCityCode="+n.getState("bookCityCode")+"&departCityCode="+n.getState("departCityCode")+"&backCityCode="+n.getState("backCityCode")+"&departDate="+n.getState("departDate")+"&journeyDay="+n.getState("duration")+"&isLeastOne=true&itemType="+e+"&adultNum="+n.getState("adult")+"&childNum="+n.getState("child")+"&freeChildNum="+n.getState("freeChild")+"&productTypeName="+n.getState("productTypeName")+"&journeyId="+n.getState("journeyId")),o=[];t.getChildren().forEach(function(e){e.data&&o.push(e.data)}),l.dialog.open({title:[""],url:i,area:["1020px","95%"],callback:function(e){t.load({data:t.data,children:s.addition.getChildData(o,e,!0).map(function(e){return{type:"item",data:e}})})},data:o})}},callback:{render:function(e){return d(Object.assign(e,{childNum:(0,a.getStore)().getState("child")||0}))},mount:function(){var e=this.getChildren(),t=$("<div />");e.forEach(function(e){t.append(e.getDOM())}),this.$(".addition-row-list-content").append(t.children())},bind:function(){var e=this;e.$element.on("click",".J_additionMore",function(){e.methods.showAdditionList($(this).data("item"))})}},lifecycle:{beforeInitialize:function(){},afterInitialize:function(){},beforeRender:function(){},afterRender:function(){},beforeMount:function(){},afterMount:function(){},beforeBind:function(){},afterBind:function(){}},events:{"change:flag":function(e){var t=this,n=e.currentTarget;if(!n.get("isOpt")){var i=n.filterChildren("selected",1);1===i.length?this.request("change:isShow",{resourceId:i[0].get("resourceId"),isShow:!1}):i.forEach(function(e){e.get("isShow")||t.request("change:isShow",{resourceId:e.get("resourceId"),isShow:!0})})}}},factory:{item:r.item}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(1),o=n(23),r=(n(19),n(525)),s=n(399),c=n(528),l=(n(48),n(10),n(53)),d=i.compile(c.addItemTemplate,{client:!0,compileDebug:!1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.item=function(e){return new o.Component({type:"item",el:e.el,data:e.data,children:e.children,methods:{getItemData:function(e,t){var n=this.data,i={};return n.resourceId==t&&(i=n),i},showAdditionDetail:function(e){l.layer.open({type:1,title:[e.resourceName,"font-weight:bold;font-size:16px;"],area:["900px","530px"],shadeClose:!0,content:u({data:e,helper:c.helper})})}},callback:{render:function(e){return d(Object.assign({resources:e},{totalChildNum:((0,a.getStore)().getState("child")||0)+((0,a.getStore)().getState("freeChild")||0),journeyDay:e.journeyDay}))},mount:function(){},bind:function(){var e=this;e.$(".J_optionInfoItem").click(function(){e.methods.showAdditionList(3,$(this).data("id"))}),e.$element.on("click",".J_additionCancel",function(){var t=$(this).parents(".addition-row-list"),n=t.data("type"),i=e.methods.getItemData(n,t.data("resid"));i.selected=i.selected?0:1,e.set("flag",+!i.selected),e.load({data:e.data})}).on("click",".J_additionName",function(){var t=e.data;e.methods.showAdditionDetail(t)}).on("change",".J_additionDate",function(){var t=$(this).parents(".addition-row-list"),n=t.data("type");e.methods.getItemData(n,t.data("resid")).selectedDate=$(this).val(),e.load({data:e.data})}).on("change",".J_adultNum",function(){var t=$(this).parents(".addition-row-list"),n=t.data("type");e.methods.getItemData(n,t.data("resid")).selectedNum=$(this).val(),e.load({data:e.data})}).on("change",".J_childNum",function(){var t=$(this).parents(".addition-row-list"),n=t.data("type");e.methods.getItemData(n,t.data("resid")).selectedChildNum=$(this).val(),e.load({data:e.data})}).on("click",".J_additionMore",function(){e.methods.showAdditionList(2,$(this).data("item"))}),window.showAdditionDetail=e.methods.showAdditionDetail}},lifecycle:{beforeInitialize:function(){},afterInitialize:function(){},beforeRender:function(){},afterRender:function(){},beforeMount:function(){},afterMount:function(){},beforeBind:function(){},afterBind:function(){}},requests:{"change:isShow":function(e){this.get("resourceId")===e.data.resourceId&&(this.data.isShow=e.data.isShow,this.load({data:this.data}))}},factory:{}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(1),o=n(23),r=(n(19),n(526)),s=n(527),c=n(48),l=n(10),d=(n(53),i.compile(r.itemTemplate,{client:!0,compileDebug:!1})),u=i.compile(s.additionDetailTemplate,{client:!0,compileDebug:!1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.itemTemplate='\n<%\nvar childPrice, adultPrice;\n%>\n<% var item = resources %>\n\n<% if (!item.isIcon) {%>\n<div class="clearfix addition-row-list" data-resid="<%= item.resourceId %>" date-type="<%= item.itemType%>">\n    <span class="J_additionName addition-row-name">\n        <%= item.resourceName %>\n    </span>\n    <span class="addition-row-date">\n        <% if (\'undefined\' !== typeof item.selected && item.selected === 1) { %>\n            <% if(item.sellRule == 1) { %>\n               <%= item.journeyDay %> \n            <% } else { %>\n                <select class="J_additionDate">\n                    <% item.useDate.forEach(function(date, index) {\n                        var isSelected = false;\n                        if(!date || !date.departDate || typeof date.departDate != \'string\') return;\n                        if(item.selectedDate) {\n                            isSelected = item.selectedDate == date.departDate;\n                            isSelected ? (adultPrice = date.adultPrice,childPrice = date.childPrice) : \'\';\n                        } else {\n                            isSelected = index == 0;\n                            isSelected ? (adultPrice = date.adultPrice,childPrice = date.childPrice) : \'\';\n                        } %>\n                        <option value="<%= date.departDate %>"<%= isSelected? \' selected\': \'\' %> ><%= date.departDate.substring(5) %></option>\n                    <% }) %>\n                </select>\n                \n            <% } %>\n        <% } else { %>\n        &nbsp;\n        <% } %>\n    </span>\n    <span class="addition-row-count">\n        <% if (item.selected === 1) { %>\n            <% var selectMin = 0,\n                selectMax = 0,\n                selectChildMin = 0,\n                selectChildMax = 0,\n                selectedNum = item.selectedNum || 0,\n                selectedChildNum = item.selectedChildNum || 0,\n                showChild = false;\n            switch(item.unitType) {\n                case 1:\n                case 3:\n                case 4:\n                case 6:\n                case 7:\n                case 8:\n                case 9:\n                    selectMin = item.adultMinNum;\n                    selectMax = item.adultMaxNum;\n                    break;\n                case 2:\n                    if(item.excludeChildFlag == 0 && totalChildNum > 0) {\n                        selectChildMin = item.childMinNum;\n                        selectChildMax = item.childMaxNum;\n                        showChild = true;\n                    }\n                    selectMin = item.adultMinNum;\n                    selectMax = item.adultMaxNum;\n                    break;\n            } %>\n            <div class="">\n                <select class="J_adultNum">\n                    <% for(var aNo = selectMin; aNo <= selectMax; aNo++) {%>\n                    <option value="<%= aNo %>"<%= aNo == selectedNum? \' selected\':\'\' %>><%= aNo %></option>\n                    <% } %>\n                </select>\n                <%= item.unit %>\n            </div>\n            <% if (showChild) { %>\n            <div class="">\n                <select class="J_childNum">\n                    <% for(var cNo = selectChildMin; cNo <= selectChildMax; cNo++) { %>\n                    <option value="<%= cNo %>"<%= cNo == selectedChildNum? \' selected\':\'\' %>><%= cNo %></option>\n                    <% } %>\n                </select>\n                <%= item.childUnit %>\n            </div>\n            <% } %>\n        <% } else { %>\n        &nbsp;\n        <% } %>\n    </span>\n    <span class="addition-row-group">\n        <% if(item.modelType === 0) {%>\n        \n        <% } else if(item.modelType === 1) {%>\n        \n        <% } else if(item.modelType === 2) { %>\n            <% if(item.sellRule == 1) { %>\n                <div class="count J_adultPrice">\n                    <%= item.adultPrice%>/<%= item.unit %>\n                </div>\n            <% } else { %>\n                <%  var adultPriceL = item.adultPrice;\n                    var childPriceL = item.childPrice;\n                    item.useDate.forEach(function(date, index) {\n                        if(item.selectedDate == date.departDate) {\n                            adultPriceL = date.adultPrice;\n                            childPriceL = date.childPrice;\n                        }\n                    });\n                %>\n                <div class="count J_adultPrice">\n                    <%= adultPriceL %>/<%= item.unit %>\n                </div>\n                <% if (showChild) { %>\n                    <div class="count J_childPrice">\n                        <%= childPriceL %>/<%= item.childUnit %>\n                    </div>\n                <% } %>\n            <% } %>\n        <% } else { %>\n            &nbsp;\n        <% } %>\n    </span>\n    <span class="addition-row-select">\n        <% if(item.modelType === 2 && item.isShow) { %>\n            <div class="">\n                <div class="addition-row-btn J_additionCancel <%= item.selected === 1 ? \'active\' : \'\'%>"><%= item.selected ===1 ? \'\' : \'\'%></div>\n            </div>\n        <% } else { %>\n            &nbsp;\n        <% } %>\n    </span>\n</div>\n\n<% } %>\n\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.additionDetailTemplate='\n<div class="addition-detail">\n    <% if(data.itemIntro) { %>\n    <div class="addition-detail-item">\n        <span><i></i></span>\n        <p><%- helper.nb2br(data.itemIntro) %></p>\n    </div>\n    <% } %>\n    <% if (data.bookNotice) { %>\n    <div class="addition-detail-item">\n        <span><i></i></span>\n        <p><%- helper.nb2br(data.bookNotice) %></p>\n    </div>\n    <% } %>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.addItemTemplate='\n<div class="addition-row clearfix" date-type="<%= typeof itemType !== \'undefined\' ? itemType : \'\'%>">\n    <span class="addition-row-type addition-row-left">\n        <%= itemTypeName %>\n    </span>\n    <div class="addition-row-right">\n        <% if (itemTypeName !== \'\') { %>\n            <% if (\'undefined\' !== typeof showMore && showMore) { %>\n            <div class="addition-row-tip">\n                <span></span>\n                <span class="J_additionMore addition-row-more" data-item="<%= itemType%>"><%=  \'undefined\' !== typeof total && total ? total : \'\'%> &gt;</span>\n            </div>\n            <% } %>\n            <div class="addition-row-list-content clearfix">\n\n            </div>\n        <% } else { %>\n            <div class="addition-row-list-content clearfix">\n                <% if (resources && resources.length) {\n                    resources.forEach( function(item) { %>\n                        <div class="addition-rec-item J_optionInfoItem" data-id="<%= item.itemType %>">\n                            <i class="addition-rec-item-icon addition-icon-type-<%= item.itemType %>"></i>\n                            <div class="addition-rec-item-detail">\n                                <p class="addition-rec-item-name" title="">\n                                    <%= item.itemTypeName %>\n                                </p>\n                                <p class="addition-rec-item-count"">\n                                    <em><%= item.startPrice %></em> <%= item.total %>\n                                </p>\n                            </div>\n                        </div>\n                    <% }) %>\n                <% } %>        \n            </div>\n        <% } %>   \n    </div>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.additionTemplate='\n<div class="row">\n    <div class="row-head">\n        <i class="icon icon-add"></i>\n        <strong class="title"><%= title%></strong>\n    </div>\n    <div class="row-body">\n        <div class="addition-content">\n            <% if(hasList) { %>\n            <div class="addition-head clearfix">\n                <span class="addition-row-type"></span>\n                <span class="addition-row-name"></span>\n                <span class="addition-row-date"></span>\n                <span class="addition-row-count"></span>\n                <span class="addition-row-group"></span>\n                <span class="addition-row-select"></span>\n            </div>\n            <% } %>\n            <div class="addition-main">\n\n            </div>\n        </div>\n    </div>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recommend=function(e){return new a.Component({type:"recommend",el:e.el,data:e.data,children:e.children||[],callback:{render:function(e){return s(e)},mount:function(e,t){var n=this.$(".J_blockBody");t.forEach(function(e){return n.append(e.getDOM())})},bind:function(){}},events:{},factory:{addition:r.addition}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(23),o=n(106),r=n(398),s=i.compile(o.blockTemplate,{client:!0,compileDebug:!1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.other=function(e){return new a.Component({type:"other",el:e.el,data:e.data,children:e.children,methods:{},callback:{render:function(e){return s(e)},mount:function(e,t){var n=this.$(".J_blockBody");t.forEach(function(e){return n.append(e.getDOM())})},bind:function(){}},lifecycle:{afterInitialize:function(){}},events:{},factory:{addItem:r.addItem}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(23),o=n(106),r=n(532),s=i.compile(o.blockTemplate,{client:!0,compileDebug:!1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addItem=function(e){return new o.Component({type:"addItem",el:e.el,data:e.data,children:e.children,methods:{getItemData:function(e,t){var n={};return 2==e||1==e?this.data.addItem.forEach(function(e){e.itemList.forEach(function(e){e.itemId==t&&(n=e)})}):this.data.recommendAddItem.attachTypes.forEach(function(e){e.dataList.forEach(function(e){e.attachId==t&&(n=e)})}),n},showAdditionDetail:function(e,t){f.layer.open({type:1,title:[3==t?e.attachName:e.itemName,"font-weight:bold;font-size:16px;"],area:["900px","530px"],content:y({data:e,type:t,helper:u.helper})})},showAdditionList:function(e,t){var n=this,i=(0,a.getStore)(),o=app_url("package/"+i.getState("productId")+"/addItemList?bookCityCode="+i.getState("bookCityCode")+"&departCityCode="+i.getState("departCityCode")+"&backCityCode="+i.getState("backCityCode")+"&departDate="+i.getState("departDate")+"&callback="+this.iframeCallback);h.dialog.open({title:[""],url:o,area:["1020px","95%"],callback:function(e){n.load({data:e}),window.addItemCurrentData=null}}),window.addItemCurrentData=$.extend(!0,{},this.data,{groupType:e,itemType:t,adultNum:i.getState("adult"),childNum:i.getState("child")})}},callback:{render:function(e){return p(Object.assign(e,{childNum:(0,a.getStore)().getState("child")||0}),null,function(e,t){return"additionDisplay"==e?m(t):"recommendDisplay"==e?v(t):"recommendAddition"==e?g(t):void 0})},mount:function(){},bind:function(){var e=this;e.$(".J_optionInfoItem").click(function(){e.methods.showAdditionList(3,$(this).data("id"))}),e.$element.on("click",".J_additionCancel",function(){var t=$(this).parents(".addition-row-list"),n=t.data("type"),i=e.methods.getItemData(n,t.data("resid"));i.selectedNum=0,i.selectedChildNum=0,e.load({data:e.data})}).on("click",".J_additionName",function(){var t=$(this).parents(".addition-row-list"),n=t.data("type"),i=e.methods.getItemData(n,t.data("resid"));e.methods.showAdditionDetail(i,n)}).on("change",".J_additionDate",function(){var t=$(this).parents(".addition-row-list"),n=t.data("type");e.methods.getItemData(n,t.data("resid")).selectedDate=$(this).val(),e.load({data:e.data})}).on("change",".J_adultNum",function(){var t=$(this).parents(".addition-row-list"),n=t.data("type");e.methods.getItemData(n,t.data("resid")).selectedNum=$(this).val(),e.load({data:e.data})}).on("change",".J_childNum",function(){var t=$(this).parents(".addition-row-list"),n=t.data("type");e.methods.getItemData(n,t.data("resid")).selectedChildNum=$(this).val(),e.load({data:e.data})}).on("click",".J_additionMore",function(){e.methods.showAdditionList(2,$(this).data("item"))}),window.showAdditionDetail=e.methods.showAdditionDetail}},lifecycle:{beforeInitialize:function(){},afterInitialize:function(){},beforeRender:function(){},afterRender:function(){},beforeMount:function(){},afterMount:function(){},beforeBind:function(){},afterBind:function(){}},events:{"change:select":function(e){}},factory:{}})};var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),a=n(1),o=n(23),r=(n(19),n(533)),s=n(534),c=n(535),l=n(536),d=n(537),u=n(48),f=n(10),h=n(53),p=i.compile(r.additionTemplate,{client:!0,compileDebug:!1}),m=i.compile(s.additionDisplayTemplate,{client:!0,compileDebug:!1}),v=i.compile(c.recommendDisplayTemplate,{client:!0,compileDebug:!1}),g=i.compile(l.recommendAdditionTemplate,{client:!0,compileDebug:!1}),y=i.compile(d.additionDetailTemplate,{client:!0,compileDebug:!1})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.additionTemplate='\n<div class="row">\n    <% var recommendData = [];\n    if(recommendAddItem) {\n        recommendData = (recommendAddItem.attachTypes || []).filter(function(group) {\n            return (group.dataList || []).filter(function(item) {\n                return item.selectedNum || item.selectedChildNum;\n            }).length;\n        });\n    }\n    %>\n    <% if(!isWholeJourney && (addItem && addItem.length || recommendData.length)) { %>\n    <div class="row-head">\n        <i class="icon icon-add"></i>\n        <strong class="title"></strong>\n    </div>\n    <% } %>\n\n    <div class="row-body">\n        <% if(addItem && addItem.length || recommendData.length) { %>\n        <div class="addition-content">\n            <div class="addition-head clearfix">\n                <span class="addition-row-type"></span>\n                <span class="addition-row-name"></span>\n                <span class="addition-row-date"></span>\n                <span class="addition-row-count"></span>\n                <span class="addition-row-group"></span>\n                <span class="addition-row-select"></span>\n            </div>\n            <div class="addition-main">\n            <% if(addItem && addItem.length) { %>\n                <%- include(\'additionDisplay\', {\n                    addItem: addItem,\n                    journeyDay: journeyDay,\n                    childNum: childNum\n                }) %>\n            <% } %>\n            <% if(recommendData.length) { %>\n                <%- include(\'recommendDisplay\', {\n                    recommendData: recommendData,\n                    journeyDay: journeyDay,\n                    childNum: childNum\n                }) %>\n            <% } %>\n            </div>\n        </div>\n        <% } %>\n        <%- include(\'recommendAddition\', {\n            recommendAddItem: recommendAddItem,\n            name: destinationCityName\n        }) %>\n    </div>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.additionDisplayTemplate='\n<% for (var i = 0, len = addItem.length; i < len; i++) {\n    var itemGroup = addItem[i];\n    var count = (itemGroup && itemGroup.itemList || []).filter(function(item){\n        return item.selectedNum || item.selectedChildNum;\n    }).length;\n     %>\n    <% if (count) { %>\n    <div class="addition-row clearfix">\n        <span class="addition-row-type addition-row-left">\n            <%= itemGroup.itemTypeName %>\n        </span>\n        <div class="addition-row-right">\n        <% if (itemGroup.groupType == 2 && itemGroup.itemList.length > 1) { %>\n        <div class="addition-row-tip">\n            <span></span>\n            <span class="J_additionMore addition-row-more" data-item="<%= itemGroup.itemType %>"><%= itemGroup.itemList.length %> &gt;</span>\n        </div>\n        <% } %>\n        <% for (var j = 0, jLen = itemGroup.itemList.length; j < jLen; j++) {\n            var item = itemGroup.itemList[j];\n            if(item.selectedNum || item.selectedChildNum) { %>\n            <div class="addition-row-list" data-resid="<%= item.itemId %>" data-type="<%= itemGroup.groupType %>">\n                <span class="J_additionName addition-row-name">\n                    <%= item.itemName %>\n                </span>\n                <span class="addition-row-date">\n                    <% if(item.sellRule == 1) { %>\n                        <%= journeyDay %>\n                    <% } else { %>\n                        <select class="J_additionDate">\n                            <% item.isUseDate.forEach(function(date, index) {\n                                var isSelected = false;\n                                if(!date || !date.departDate || typeof date.departDate != \'string\') return;\n                                if(item.selectedDate) {\n                                    isSelected = item.selectedDate == date.departDate;\n                                } else {\n                                    isSelected = index == 0;\n                                } %>\n                                <option value="<%= date.departDate %>"<%= isSelected? \' selected\': \'\' %> ><%= date.departDate.substring(5) %></option>\n                            <% }) %>\n                        </select>\n                        \n                    <% } %>\n                </span>\n                <span class="addition-row-count">\n                    <% var selectMin = 0,\n                        selectMax = 0,\n                        selectChildMin = 0,\n                        selectChildMax = 0,\n                        selectedNum = item.selectedNum || 0,\n                        selectedChildNum = item.selectedChildNum || 0,\n                        showChild = false;\n                    switch(item.unitType) {\n                        case 1:\n                        case 3:\n                        case 4:\n                        case 6:\n                        case 7:\n                        case 8:\n                        case 9:\n                            selectMin = item.startNum;\n                            selectMax = item.startMax;\n                            break;\n                        case 2:\n                            if(item.excludeChildFlag == 0 && childNum > 0) {\n                                selectChildMin = item.childStartNum;\n                                selectChildMax = item.childStartMax;\n                                showChild = true;\n                            }\n                            selectMin = item.startNum;\n                            selectMax = item.startMax;\n                            break;\n                    } %>\n                    <div class="">\n                        <select class="J_adultNum">\n                            <% for(var aNo = selectMin; aNo <= selectMax; aNo++) {%>\n                            <option value="<%= aNo %>"<%= aNo == selectedNum? \' selected\':\'\' %>><%= aNo %></option>\n                            <% } %>\n                        </select>\n                        <%= item.unit %>\n                    </div>\n                    <% if (showChild) { %>\n                    <div class="">\n                        <select class="J_childNum">\n                            <% for(var cNo = selectChildMin; cNo <= selectChildMax; cNo++) { %>\n                            <option value="<%= cNo %>"<%= cNo == selectedChildNum? \' selected\':\'\' %>><%= cNo %></option>\n                            <% } %>\n                        </select>\n                        <%= item.childUnit %>\n                    </div>\n                    <% } %>\n                </span>\n                <span class="addition-row-group">\n                    <div class="">\n                        &nbsp;\n                    </div>\n                </span>\n                <span class="addition-row-select">\n                    <div class="">\n                        <% if(count > 1 && itemGroup.groupType == 2) { %>\n                        <div class="addition-row-btn J_additionCancel"></div>\n                        <% } %>\n                    </div>\n                </span>\n            </div>\n            <% } %>\n        <% } %>\n        </div>\n    </div>\n    <% } %>\n<% } %>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recommendDisplayTemplate='\n<% for (var i = 0, len = recommendData.length; i < len; i++) {\n    var itemGroup = recommendData[i];\n    var isShow = false;\n    (itemGroup && itemGroup.dataList || []).forEach(function(item){\n        if(item.selectedNum || item.selectedChildNum) {\n            isShow = true;\n        }\n    }) %>\n    <% if (isShow) { %>\n    <div class="addition-row clearfix">\n        <span class="addition-row-type addition-row-left">\n            <%= itemGroup.typeName %>\n        </span>\n        <div class="addition-row-right">\n        <% for (var j = 0, jLen = itemGroup.dataList.length; j < jLen; j++) {\n            var item = itemGroup.dataList[j];\n            if(item.selectedNum || item.selectedChildNum) { %>\n            <div class="addition-row-list" data-resid="<%= item.attachId %>" data-type="3">\n                <span class="J_additionName addition-row-name">\n                    <%= item.attachName %>\n                </span>\n                <span class="addition-row-date">\n                    <% if(item.sellRule == 1) { %>\n                        <%= journeyDay %>\n                    <% } else { %>\n                        <select class="J_additionDate">\n                            <% item.departsDates.forEach(function(date, index) {\n                                var isSelected = false;\n                                if(!date || !date.departsDate || typeof date.departsDate != \'string\') return;\n                                if(item.selectedDate) {\n                                    isSelected = item.selectedDate == date.departsDate;\n                                } else {\n                                    isSelected = index == 0;\n                                } %>\n                                <option value="<%= date.departsDate %>"<%= isSelected? \' selected\': \'\' %> ><%= date.departsDate.substring(5) %></option>\n                            <% }) %>\n                        </select>\n                        \n                    <% } %>\n                </span>\n                <span class="addition-row-count">\n                    <% var selectMin = 0,\n                        selectMax = 0,\n                        selectChildMin = 0,\n                        selectChildMax = 0,\n                        selectedNum = item.selectedNum || 0,\n                        selectedChildNum = item.selectedChildNum || 0,\n                        showChild = false;\n                    switch(item.countPriceType) {\n                        case 1:\n                        case 3:\n                        case 4:\n                        case 6:\n                        case 7:\n                        case 8:\n                        case 9:\n                            selectMin = item.limitMin;\n                            selectMax = item.limitMax;\n                            break;\n                        case 2:\n                            if(item.excludeChildFlag == 0 && childNum > 0) {\n                                selectChildMin = item.childLimitMin;\n                                selectChildMax = item.childLimitMax;\n                                showChild = true;\n                            }\n                            selectMin = item.limitMin;\n                            selectMax = item.limitMax;\n                            break;\n                    } %>\n                    <div class="">\n                        <select class="J_adultNum">\n                            <% for(var aNo = selectMin; aNo <= selectMax; aNo++) {%>\n                            <option value="<%= aNo %>"<%= aNo == selectedNum? \' selected\':\'\' %>><%= aNo %></option>\n                            <% } %>\n                        </select>\n                        <%= item.countPriceTypeName %>\n                    </div>\n                    <% if (showChild) { %>\n                    <div class="">\n                        <select class="J_childNum">\n                            <% for(var cNo = selectChildMin; cNo <= selectChildMax; cNo++) { %>\n                            <option value="<%= cNo %>"<%= cNo == selectedChildNum? \' selected\':\'\' %>><%= cNo %></option>\n                            <% } %>\n                        </select>\n                        <%= item.childCountPriceTypeName %>\n                    </div>\n                    <% } %>\n                </span>\n                <span class="addition-row-group">\n                    <div class="">\n                        &nbsp;\n                    </div>\n                </span>\n                <span class="addition-row-select">\n                    <div class="">\n                        <% if(selectedNum || selectedChildNum) { %>\n                        <div class="addition-row-btn J_additionCancel"></div>\n                        <% } %>\n                    </div>\n                </span>\n            </div>\n            <% } %>\n        <% } %>\n        </div>\n    </div>\n    <% } %>\n<% } %>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.recommendAdditionTemplate='<% if(recommendAddItem && recommendAddItem.attachTypes) { %>\n<div class="addition-rec">\n    <div class="addition-rec-title"><span><%= name%></span></div>\n    <div class="addition-rec-list clearfix">\n        <% recommendAddItem.attachTypes.forEach(function(item){ %>\n        <div class="addition-rec-item J_optionInfoItem" data-id="<%= item.typeId %>">\n            <i class="addition-rec-item-icon addition-icon-type-<%= item.typeId %>"></i>\n            <div class="addition-rec-item-detail">\n                <p class="addition-rec-item-name" title="">\n                    <%= item.typeName %>\n                </p>\n                <p class="addition-rec-item-count"">\n                    <em><%= item.dataList.reduce(function(m, c){\n                        if(!m) return c.price;\n                        return c.price < m? c.price: m;\n                     }, null) %></em> <%= item.dataList.length %></p>\n            </div>\n        </div>\n        <% }) %>\n    </div>\n</div>\n<% } %>'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.additionDetailTemplate='\n<div class="addition-detail">\n    <% if(data.itemIntro || data.attachDesc) { %>\n    <div class="addition-detail-item">\n        <span><i></i></span>\n        <p><%- helper.nb2br(type == 3? data.attachDesc: data.itemIntro) %></p>\n    </div>\n    <% } %>\n    <% if (data.bookNotice) { %>\n    <div class="addition-detail-item">\n        <span><i></i></span>\n        <p><%- helper.nb2br(data.bookNotice) %></p>\n    </div>\n    <% } %>\n</div>\n'},function(e,t,n){"use strict";function i(e){var t={type:"ticket",data:{title:""},children:[]};d=e.journeyDay||0;var n=e.addItemResource,i=n.mandatoryOfTicket,o=n.leastOneOfTicket;return Array.isArray(i)&&i.length?t.children.push({type:"ticketlist",data:{list:a(0,i),ticketType:0},children:[]}):Array.isArray(o)&&o.length&&o.forEach(function(e){t.children.push({type:"ticketlist",data:{journeyId:e.journeyId,journeyName:e.destinationName,totalTicketNum:e.totalTicketNum,list:a(1,e.journeyScenicWithTickets),ticketType:1},children:[]})}),t}function a(e,t){return t&&t.forEach(function(t){Array.isArray(t.tickets)&&t.tickets.forEach(function(t){void 0===t.selectedNum&&(t.selectedNum=t.adultDefaultNum),void 0===t.selectedChildNum&&(t.selectedChildNum=t.childDefaultNum),void 0===t.selectedDate&&(t.selectedDate=t.departDate),void 0===t.selected&&(t.selected=0),0===e&&(t.selected=1)})}),t}function o(e,t){var n={type:"addition",data:{title:{timeLimitFree:"",mandatory:"",optional:""}[t]}};return n.children="timeLimitFree"===t?function(e){return e.reduce(function(e,t){var n=!1;return e.forEach(function(e){e.itemType===t.itemType&&(e.resources.push(t),n=!0)}),n||e.push({itemType:t.itemType,itemTypeName:t.itemTypeName,resourceType:t.resourceType,resources:[t]}),e},[]).map(function(e){return{type:"addItem",data:Object.assign(e,{isMore:!1}),children:(e.resources||[]).map(function(e){return e.journeyDay=d,e.modelType=0,e.selected=1,e.selectedNum=e.adultDefaultNum,e.selectedChildNum=e.childDefaultNum,e.selectedDate=(e.useDate[0]||{}).departDate||"",{type:"item",data:e}})}})}(e):e.map(function(e){return{type:"addItem",data:Object.assign(e,{isMore:!1}),children:(e.resources||[]).map(function(n){return"mandatory"===t?(n.modelType=1,n.selected=1):(n.isShow=!!e.isOpt,n.modelType=2),n.journeyDay=d,n.selectedNum=n.adultDefaultNum,n.selectedChildNum=n.childDefaultNum,n.selectedDate=(n.useDate[0]||{}).departDate||"",{type:"item",data:n}})}}),n}Object.defineProperty(t,"__esModule",{value:!0}),t.formater=void 0;var r=n(48),s=n(1),c=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(58)),l=n(165),d=void 0,u=void 0;t.formater={formatResourceData:function(e){var t={data:{lack:e.lack,lackTrainFlag:0,lackTrainDesc:[],lackResFlag:0,lackResDesc:[],status:null},children:[]};return(0,s.getStore)().dispatch({type:c.SET_SUPPORT_CONDITION,data:e.isSupportCondition}),d=e.journeyDay||0,t.children=t.children.concat(function(e){var t={type:"traffic",data:{},children:[]};Array.isArray(e.bus)&&e.bus.length&&t.children.push({type:"bus",data:{list:e.bus}});var n=e.wholeJourney&&!e.wholeJourney.lackTrainFlag&&e.wholeJourney.trainTicket||"";return Array.isArray(n)&&n.length&&t.children.push({type:"train",data:{list:n}}),e.combined&&e.combined.cityList&&1==e.combined.isSupportConnection&&t.children.push({type:"combined",data:{list:[e.combined]}}),t}(e)),t.children=t.children.concat(function(t){var n={type:"category",data:{title:""},children:[]};return(e.journeys||[]).map(function(e){if(Array.isArray(e.packageResources)&&e.packageResources.length){var t={type:"pack",children:e.packageResources.map(function(e){return{type:"item",data:e}}),data:{}};e.lackResFlag||n.children.push(t)}if(e.hasHotels&&Array.isArray(e.hotels)&&e.hotels.length){var i=function(e){var t=e.hotels,n=["destinationCityCode","destinationCityName","roomNum","haveIndividualHotels","haveStockHotels","nation","journeyStartDate","journeyEndDate","journeyId"];if(!u)return t.forEach(function(t){n.reduce(function(t,n){return t[n]=e[n],t},t),t.hotelPic=r.helper.resizeImage(t.hotelPic,180,100,1),t.gotoHouseListDirectly=e.gotoHouseListDirectly,t.loading=!0,t.roomNum>20&&(t.roomNum=20),t.liveNight=l.Tool.getDeltaDays(t.journeyStartDate,t.journeyEndDate),t.adultRoomNum=(0,s.getStore)().getState("adult"),t.childRoomNum=(0,s.getStore)().getState("child")}),t[0]}(e);e.lackResFlag||n.children.push({type:"hotel",data:i,children:i.rooms.map(function(t){t.beShow=!1,i.roomNum=Math.ceil((0,s.getStore)().getState("adult")/(t.adultNum||(t.baseNum>0?t.baseNum:0)||2)),t.selectNum=t.roomNum=i.roomNum;var n=function(e){var t=e;return t.select=!0,t.hotelPackages&&t.hotelPackages.length&&t.hotelPackages.forEach(function(e,n){e.beShow=!1,e.roomId=t.roomId,e.roomName=t.name,e.bookNotice=t.bookNotice,e.adultNum=t.adultNum,e.childNum=t.childNum,e.baseNum=t.baseNum>0?t.baseNum:0,e.selectNum=e.roomNum=t.roomNum,0===n&&(e.select=!0)}),t}(t);return{type:e.hotels[0].isStock?"room":"plan",data:n}})})}}),[n].filter(function(e){return e.children.length})}()),t.children=t.children.concat(i(e)),t.children=t.children.concat(function(e){if(!e)return[];var t=void 0,n={type:"locale",data:{title:"",journeyDay:d},children:[]},i=[],a=null,r=e.showMoreOptional;return Object.keys(e).forEach(function(t){var s=void 0;switch(t){case"timeLimitFree":case"mandatory":(s=e[t])&&s.length&&n.children.push(o(s,t));break;case"leastOne":(s=e[t])&&s.length&&(s||[]).reduce(function(e,t){return e=e.concat(t.journeyResources)},[]).forEach(function(e){e.isOpt=!1,i.push(e)});break;case"optional":s=e[t],Array.isArray(s)&&s.forEach(function(e){e.isOpt=!0,i.push(e)});break;case"moreOptionals":(s=e[t])&&s.length&&r&&(s.forEach(function(e){e.isIcon=!0}),a={type:"addItem",data:{resources:s,itemTypeName:"",isMore:!0,isOpt:!1}})}}),t={type:"recommend",data:{title:"",journeyDay:d},children:function(){var e=o(i,"optional");return a&&(Array.isArray(e.children)?e.children.push(a):e.children=[a]),[e].filter(function(e){return e.children&&e.children.length})}()},[n,t].filter(function(e){return e.children&&e.children.length})}(e.addItemResource)),e.wholeJourney&&e.wholeJourney.lackTrainFlag&&(t.data.lackTrainFlag=e.wholeJourney.lackTrainFlag,t.data.lackTrainDesc.push(e.wholeJourney.lackTrainDesc)),[e.wholeJourney].concat(e.journeys).forEach(function(e){e&&e.lackResFlag&&(t.data.lackResFlag=e.lackResFlag,t.data.lackResDesc.push(e.lackResDesc))}),t.data.lackResDesc=t.data.lackResDesc.filter(function(e){return e}),t},formatTicketsData:i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatOrderData=void 0;var i=n(1),a=n(165),o=void 0;t.formatOrderData=function(e){if("drive"==(o=(0,i.getStore)()).getState("productTypeName"))return function(e){return{route_id:(o=(0,i.getStore)()).getState("productId"),begin_date:o.getState("departDate"),dep_city:o.getState("departCityCode"),backCity:o.getState("backCityCode"),user_num:o.getState("adult"),child_count:o.getState("child"),from_url:window.location.href,journeyId:o.getState("journeyId"),mainResParams:function(e){var t={selectTicket:[],selectHotel:[]};return o.dispatch({type:"SET_CANCEL_DESC",data:[]}),e.children.forEach(function(e){e.children.forEach(function(e){switch(e.type){case"hotel":t.selectHotel.push(function(e){var t=e.selectRoom,n=(t&&t.hotelPackages&&t.hotelPackages[0],o.getState("cancelDesc"));t.cancelDesc&&n.push(e.chineseName+","+t.cancelDesc),o.dispatch({type:"SET_CANCEL_DESC",data:n});var i={num:t.selectNum,limitMax:t.maxNum,limitMin:t.minNum,roomId:t.roomId,area:t.area,backDate:e.journeyEndDate,departDate:e.journeyStartDate,stockPurchase:t.stockPurchase,journeyId:e.journeyId,bedType:t.bedType,breakfastNum:t.breakfastNum,breakfast:t.breakfast,hotelId:e.hotelId,isExtraBed:"",maxAdultNum:t.adultNum>0?t.adultNum:t.baseNum>0?t.baseNum:2,maxChildNum:t.childNum,name:t.ratePlanName,network:t.network,price:t.price||t.roomPrice,priceList:{},resId:t.ratePlanId,roomType:"",isJiBao:t.isJiBao,ratePlanId:t.ratePlanId,ratePlanName:t.ratePlanName,vendorHotelId:t.vendorHotelId,businessType:t.businessType,cancelTime:t.cancelTime,vendorId:t.vendorId,gift:t.gift,cancelDesc:t.cancelDesc,vendorResId:t.vendorResId,isIndividualHotel:e.isIndividualHotel||e.haveIndividualHotels,hoteltype:t.conditionRatePlanId?2:e.isStock?0:1,cid:t.cid,resourceHotelRoom:{hotelChineseName:e.chineseName,hotelEnglishName:e.englishName,roomName:t.name,breakfastNum:t.ratePlanId?t.breakfastNum:t.departsDates[0].breakfastNum,starName:e.star,network:t.network,gift:t.gift}};return e.isStock||t.departsDates.forEach(function(e){i.priceList[e.departsDate]=t.ratePlanId?e.tuniuPrice:e.price}),i}(e.data));break;case"ticketlist":t.selectTicket=t.selectTicket.concat(function(e){var t=[];return e&&e.list&&e.list.length&&e.list.forEach(function(e){e.tickets&&e.tickets.length&&e.tickets.forEach(function(e){var n=[];e.useDate&&e.useDate.forEach(function(t){n.push({departDate:t.departDate,price:t.adultPrice,childPrice:t.childPrice,excludeChildFlag:e.excludeChildFlag})}),1===e.selected&&t.push({limitMax:e.adultMaxNum,limitMin:e.adultMinNum,name:e.resourceName,playTimeList:n,play_time:e.selectedDate,price:e.adultPrice,resId:e.resourceId,journeyId:e.journeyId,select:e.selected,selectNum:e.selectedNum,spotCode:e.spotCode,spotName:e.spotName,ticketName:e.resourceName,isLowest:"",isTouristName:"",isTouristPhone:"",bookNotice:"",needPsptId:""})})}),t}(e.data));break;case"addition":t.selectTicket=t.selectTicket.concat(function(e){var t=[];return e&&e.length&&e.forEach(function(e){e.children&&e.children.length&&e.children.forEach(function(e){var n=e.data;if(1===n.selected){var i=[];n.useDate&&n.useDate.forEach(function(e){i.push({departDate:e.departDate,price:e.adultPrice,childPrice:e.childPrice,excludeChildFlag:n.excludeChildFlag})}),t.push({limitMax:n.adultMaxNum,limitMin:n.adultMinNum,name:n.resourceName,playTimeList:i,play_time:n.selectedDate,price:n.adultPrice,resId:n.resourceId,journeyId:n.journeyId,select:n.selected,selectNum:n.selectedNum,spotCode:"",spotName:"",ticketName:n.resourceName,isLowest:"",isTouristName:"",isTouristPhone:"",bookNotice:n.bookNotice,needPsptId:""})}})}),t}(e.children))}})}),t}(e)}}(e);var t=new Date(o.getState("departDate").replace(/-/g,"/")),n=new Date(t.setDate(t.getDate()+o.getState("duration")-1)),r=n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate();return{route_id:o.getState("productId"),begin_date:o.getState("departDate"),dep_city:o.getState("departCityCode"),back_city:o.getState("backCityCode"),user_num:o.getState("adult"),child_count:o.getState("child"),freeChildNum:o.getState("freeChild"),journeyId:o.getState("journeyId"),bookCityCode_FromDetail:o.getState("bookCityCode"),from_url:window.location.href,flightInternationalNormal:o.getState("flightInternationalNormal"),mainResParams:Object.assign({productInfo:{productName:encodeURIComponent(o.getState("productName")),backDate:r},checkResFaild:0==o.getState("checkResFaild")?0:1,version:2},function(e){var t={selectTrain:[],selectHotel:[],selectAddService:[],selectAir:[],selectBus:[],selectMultiTransport:[],selectPackage:[]};return e.children.forEach(function(e){e.children.forEach(function(e){switch(e.type){case"pack":t.selectPackage.push(function(t){var n=void 0;return e.children.forEach(function(e){var t=e.data;t&&t.selected&&(n={packageType:2==t.pkgType,availableNumber:t.pkgAvailNum,resName:t.pkgName,resId:t.resId,childPrice:t.childPrice,adultPrice:t.adultPrice,subResource:[]},t.flightTickets&&t.flightTickets.length&&n.subResource.push({resType:7,resDetail:[{flightTicketFlight:t.flightTickets.map(function(e){return{resId:e.resId,airlineName:e.airlineName,flightNo:e.flightNo,departureCityName:e.departureCityName,destinationCityName:e.destinationCityName,departureAirportName:e.departureAirportName,destinationAirportName:e.destinationAirportName,departTime:e.departTime,arriveTime:e.arriveTime,departDate:e.flightDate,duration:e.duration,cabinTypeName:e.seatType}})}]}),t.hotels&&t.hotels.length&&t.hotels.forEach(function(e){n.subResource.push({resType:2,startDate:e.startDate,endDate:e.endDate,resDetail:[{chineseName:e.chineseName,address:e.address,hotelRoomInfo:{roomType:e.rooms[0].hotelPackages[0].ratePlanName,resId:e.rooms[0].hotelPackages[0].ratePlanId,bedType:e.rooms[0].hotelPackages[0].bedType,network:e.rooms[0].hotelPackages[0].network,breakfast:e.rooms[0].hotelPackages[0].breakfast,roomCount:e.houseNum,adultNum:e.rooms[0].adultNum,childNum:e.rooms[0].childNum}}]})}),t.tickets&&t.tickets.length&&t.tickets.forEach(function(e){n.subResource.push({resType:4,resDetail:[{tName:e.itemName,tCount:e.itemNum,useDate:e.itemDate,spotName:"",Address:"",saleTime:"",availableRange:"",enterType:""}]})}))}),n}());break;case"bus":t.selectBus=function(e){var t=e.list&&e.list.length;return(e.list||[]).map(function(e,n){return{resId:e.resId||0,scheduleCode:e.scheduleCode,routeType:function(e,t){var n="";return 2==e?n=["depart","back"][t]:3==e&&(n=["depart","section","back"][t]),n}(t,n),preSale:e.preSale?1:0,adultPrice:e.ticketPrice,childPrice:e.ticketPrice,departRegionName:e.dptRegionName,departStation:e.dptStation||"",departStationCode:e.dptStationCode||"",departDate:e.dptDate,departTime:e.dptTime,destRegionName:e.dstRegionName,destStation:e.dstStation||"",destStationCode:e.dstStationCode||"",destDate:e.dstDate,destTime:e.dstTime,takeTimes:e.takeTimes,takeTimeFormated:null,vendorIdList:e.vendorIdList,isIndividualBus:3==e.ticketType?0:1,ticketType:e.ticketType,departStopAddress:e.dptStationAddress||"",departStopName:e.dptStation||"",destStopAddress:e.dstStationAddress||"",destStopName:e.dstStation||"",departCityName:e.dptRegionName,destCityCode:e.dstRegionCode,destCityName:e.dstRegionName,isCheckFailed:e.thirdTime?1:0}})}(e.data);break;case"train":t.selectTrain=function(t){var n=[];return e.data.list.forEach(function(e){n.push(Object.assign(1===o.getState("supportTrafficType")?{adultCount:o.getState("trainAdultTicket"),childCount:o.getState("trainChildTicket")}:{},{resourceId:e.trainTicketInfo.prices[0].resId,trainNum:e.trainTicketInfo.trainNum,departCityName:e.departureCityName,destCityName:e.arrivalCityName,departStationName:e.trainTicketInfo.departStationName,destStationName:e.trainTicketInfo.destStationName,departDepartTime:e.trainTicketInfo.departDepartTime,destArriveTime:e.trainTicketInfo.destArriveTime,duration:e.trainTicketInfo.durationStr?e.trainTicketInfo.durationStr:parseInt(e.trainTicketInfo.duration/60)+""+e.trainTicketInfo.duration%60+"",seatType:e.trainTicketInfo.prices[0].seat,resourceDatePrices:[{departDate:e.departDate,adultPrice:e.trainTicketInfo.prices[0].price,normalChildPrice:e.trainTicketInfo.prices[0].price}]}))}),n}();break;case"combined":e.data.list&&e.data.list[0].selected&&e.data.list[0].selected.length&&(t.selectMultiTransport=function(t){var n=[];return e.data.list[0].selected.forEach(function(e){n.push({transportType:0,tripIndex:Number(e.journeySeq)-1,resDetail:{trainNum:e.trainTicketInfo.trainNum,departStationName:e.trainTicketInfo.departStationName,destStationName:e.trainTicketInfo.destStationName,departDepartTime:e.trainTicketInfo.departDepartTime,destArriveTime:e.trainTicketInfo.destArriveTime,duration:e.trainTicketInfo.duration,departureCityName:e.departureCityName,arrivalCityName:e.arrivalCityName,departDate:e.departDate,arrivalDate:a.Tool.getDeltaDateStr(e.departDate,Number(e.trainTicketInfo.durationDay)-1),resId:e.trainTicketInfo.prices[0].resId,normalChildPrice:e.trainTicketInfo.prices[0].price,adultPrice:e.trainTicketInfo.prices[0].price,seatName:e.trainTicketInfo.prices[0].seatName}})}),n}());break;case"hotel":t.selectHotel.push(function(e){var t=e.selectRoom,n={basePrice:t.price||t.roomPrice,roomCount:t.selectNum,hotel:{hotelType:e.isStock?0:1,journeyId:e.journeyId,departDate:e.journeyStartDate,backDate:e.journeyEndDate,hotelId:e.hotelId,chineseName:e.chineseName,englishName:e.englishName,isInter:e.nation,starName:e.star,roomList:[],stockPurchase:t.stockPurchase,isIndividualHotel:e.isIndividualHotel||e.haveIndividualHotels,cancelTime:""},adultNum:o.getState("adult"),childNum:o.getState("child"),resId:""},i={};if(e.isStock?(i={roomId:t.ratePlanId,name:t.ratePlanName,maxAdultNum:t.adultNum>0?t.adultNum:t.baseNum||2,maxChildNum:t.childNum,minRoomCount:Math.ceil(o.getState("adult")/(t.adultNum>0?t.adultNum:t.baseNum)),maxRoomCount:o.getState("adult"),ratePlans:[{ratePlanId:t.ratePlanId,ratePlanName:t.ratePlanName,bedType:t.bedType,breakfast:t.breakfast,breakfastNum:t.breakfastNum,network:t.network||"",priceList:{},isJiBao:t.isJiBao,vendorHotelId:t.vendorHotelId,vendorId:t.vendorId,vendorResId:t.vendorResId,businessType:t.businessType,booknotice:t.bookNotice||""}],priceList:{},network:t.network||"",breakfast:t.breakfast,booknotice:t.bookNotice||"",isJiBao:t.isJiBao},n.resId=t.ratePlanId):(i={roomId:t.roomId,name:t.roomName,maxAdultNum:t.adultNum>0?t.adultNum:t.baseNum>0?t.baseNum:2,maxChildNum:t.childNum,minRoomCount:Math.ceil(o.getState("adult")/(t.adultNum>0?t.adultNum:t.baseNum>0?t.baseNum:2)),maxRoomCount:o.getState("adult"),ratePlans:[{ratePlanId:t.ratePlanId,ratePlanName:t.ratePlanName,bedType:t.bedType,breakfast:t.breakfast,breakfastNum:t.breakfastNum,network:t.network||"",priceList:{},isJiBao:t.isJiBao,vendorHotelId:t.vendorHotelId,vendorId:t.vendorId,vendorResId:t.vendorResId,businessType:t.businessType,booknotice:t.bookNotice||""}],priceList:{},network:t.network||"",breakfast:t.breakfast,booknotice:t.bookNotice||"",isJiBao:t.isJiBao},n.resId=""),!e.isStock){var a={};t.departsDates.forEach(function(e){a[e.departsDate]=e.tuniuPrice}),i.priceList=a,i.ratePlans[0].priceList=a}return n.hotel.roomList.push(i),n}(e.data));break;case"addition":t.selectAddService=t.selectAddService.concat(function(e){var t=[],n={1:"",3:"",8:"",4:"",2:"",6:"",7:""};return e&&e.length&&e.forEach(function(e){e.children&&e.children.length&&e.children.forEach(function(e){var i=e.data;if(1===i.selected){var a=1;i.useDate.forEach(function(e,t){e.departDate==i.selectedDate&&(a=t+1),e.excludeChildFlag=i.excludeChildFlag}),t.push({resId:i.resourceId,resType:function(e){var t=void 0;switch(+i.itemType){case 200:t=4;break;case 300:t=14;break;default:t=18}return t}(),resName:i.resourceName,resourceDatePrices:i.useDate,resInfo:{subType:i.itemType,priceComputerType:n[i.unitType]||i.unit,limitMin:i.adultMinNum,limitMax:i.adultMaxNum,sellRule:i.sellRule,bookNotice:i.bookNotice,info:i.itemIntro},duration:i.journeyDay,selectDate:a,adultSelect:i.selectedNum>0,childSelect:i.selectedChildNum>0,minValue:i.adultMinNum,maxValue:i.adultMaxNum,adultResourceCount:i.selectedNum,childResourceCount:i.selectedChildNum})}})}),t}(e.children));break;case"flight":o.getState("flightInternationalNormal")?t.selectAir=o.getState("originalFlightData"):t.selectAir=function(t){var n=[];return e.children.forEach(function(e){1==e.data.selectedTicketList?e.data.journeyNums.forEach(function(t){var i=Object.assign({},e.data.data,{selectedTicketList:e.data.selectedTicketList});i.flightTicketInfo=e.data.data.flightTicketInfo.filter(function(e){return e.journeyNum==t}),n.push(i)}):n=n.concat(e.data.data.map(function(t){return Object.assign(t,{selectedTicketList:e.data.selectedTicketList})}))}),n.map(function(e,t){var i=JSON.parse(e.checkCabinAndPrice||"{}"),a=n.filter(function(t){return t.seqNum==e.seqNum}).length,r=e.flightTicketInfo.map(function(e,t){return{airlineName:e.airlineName,arriveTime:e.arriveTime,cabinType:e.seatType,arriveDay:e.arriveDay,departDate:e.flightDate,departTime:e.departTime,departureAirportName:e.departureAirportName,departureCityName:e.departureCityName,destinationAirportName:e.destinationAirportName,destinationCityName:e.destinationCityName,duration:e.duration,flightNo:e.flightNo,transfer:e.trainsitTime&&{city:e.destinationCityName,duration:e.trainsitTime}||""}}),s={airlineName:e.flightTicketInfo[0].airlineName,cabinType:e.flightTicketInfo[0].seatType,departureCityName:e.flightTicketInfo[0].departureCityName,destinationCityName:e.flightTicketInfo[e.flightTicketInfo.length-1].destinationCityName,departDate:e.flightTicketInfo[0].flightDate,flightNo:e.flightTicketInfo[0].flightNo,departTime:e.flightTicketInfo[0].departTime,arrivalDate:e.flightTicketInfo[0].arriveDate,arriveTime:e.flightTicketInfo[e.flightTicketInfo.length-1].arriveTime,departureAirportName:e.flightTicketInfo[0].departureAirportName,destinationAirportName:e.flightTicketInfo[e.flightTicketInfo.length-1].destinationAirportName,stopTip:e.flightTicketInfo[0].stopPointList&&{stopAirportName:e.flightTicketInfo[0].stopPointList[0].stopCityName,durationTime:e.flightTicketInfo[0].stopPointList[0].stopTime}||"",airType:7==e.resType?1:1==e.selectedTicketList?2:3,resType:e.resType,solutionId:e.solutionId,refundRuleKey:e.flightTicketInfo[0].refundRuleKey||"",baggages:e.flightTicketInfo.map(function(e){return{flightNo:e.flightNo,baggageInfo:(e.additionals.filter(function(e){return""==e.title})[0]||{}).description||""}}),priceJourneyCabinList:n.map(function(e){return{priceFlightCabinList:e.flightTicketInfo.map(function(e){return{baggageInfo:(e.additionals.filter(function(e){return""==e.title})[0]||{}).description||"",cabinClass:e.cabinClass,departureDate:e.flightDate,dstCityIataCode:e.aCityIataCode,flightNo:e.flightNo,orgCityIataCode:e.dCityIataCode,seatStatus:e.seatStatus,seatType:e.seatType,seatTypeCode:e.seatTypeCode,extraInfo:e.extraInfo}})}}),checkCabinAndPrice:e.checkCabinAndPrice,transferInfo:r,duration:(1==e.flightTicketInfo.length?e.flightTicketInfo[0].duration:e.flightTicketInfo[0].totalDuration)||"",transfer:r[0]&&r[0].transfer||null,price:1==e.selectedTicketList?e.adultPrice/a:e.adultPrice,childPrice:1==e.selectedTicketList?e.childPrice/a:e.childPrice,arriveDay:e.flightTicketInfo.reduce(function(e,t){return e+t.arriveDay},0),journeyId:e.journeyId,resId:e.resId,checkId:"",seatClass:e.flightTicketInfo[0].seatTypeCode||"",cityKey:e.flightTicketInfo[0].dCityIataCode+"-"+e.flightTicketInfo[0].aCityIataCode||"",saleLimit:e.flightTicketInfo[0].saleLimit||"",seatCode:e.flightTicketInfo[0].cabinClass||"",orgCityIataCode:e.flightTicketInfo[0].dCityIataCode,dstCityIataCode:e.flightTicketInfo[e.flightTicketInfo.length-1].aCityIataCode,isInternational:e.isInternational,policyId:null==i.policyId?"":i.policyId,saleControl:e.flightTicketInfo[0].saleControl,externalInfo:""};return 1===o.getState("supportTrafficType")&&Object.assign(s,{adultCount:o.getState("adultTicket"),childCount:o.getState("childTicket")}),s})}()}})}),t}(e))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.base64Encode=function(e){var t,n,i,a,o,r,s,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",d=0;for(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t+=String.fromCharCode(i):i>127&&i<2048?(t+=String.fromCharCode(i>>6|192),t+=String.fromCharCode(63&i|128)):(t+=String.fromCharCode(i>>12|224),t+=String.fromCharCode(i>>6&63|128),t+=String.fromCharCode(63&i|128))}return t}(e);d<e.length;)a=(t=e.charCodeAt(d++))>>2,o=(3&t)<<4|(n=e.charCodeAt(d++))>>4,r=(15&n)<<2|(i=e.charCodeAt(d++))>>6,s=63&i,isNaN(n)?r=s=64:isNaN(i)&&(s=64),l=l+c.charAt(a)+c.charAt(o)+c.charAt(r)+c.charAt(s);return l}},function(e,t,n){"use strict";function i(e,t){b=u.layer.open({type:1,title:!1,closeBtn:!1,content:T({dialogType:t}),area:["700px","auto"],btn:!1,success:e})}function a(){u.layer.close(b)}function o(e,t){function n(e){f.css("visibility","visible").find("strong").text(e.join(""))}function i(){f.css("visibility","hidden").find("strong").text("")}function o(){return{groupCode:l.filter(".active").toArray().map(function(e){return{id:$(e).data("id"),name:$(e).data("name")}}),email:d.val(),productId:_.getState("productId"),productName:C,resId:k}}function c(){if(h){var e=r(o(),t);!0===e?i():n(e)}}var l=e.find(".J_VisaPersonType"),d=e.find(".J_VisaEmail"),f=e.find(".J_DialogError"),h=!1;l.click(function(){var e=$(this);e.hasClass("active")?e.removeClass("active"):e.addClass("active"),c()}),d.on("change",c),e.on("click",".J_VisaCancel, .J_VisaClose",a).on("click",".J_VisaSend",function(){var e=o(),c=r(e,t);"send"===t?(h=!0,$(this).attr({href:"javascript:;"}).removeAttr("target"),!0===c?function(e){$.ajax({url:v.config.url.visaSend(),dataType:"json",data:{d:JSON.stringify(e)},type:"post",success:function(e){e.success?function(){var e=u.layer.open({type:1,title:!1,time:3e3,content:'<div class="dialog-success"><div class="dialog-close"></div><i class="icon"></i></div>',area:["400px","auto"],btn:!1,closeBtn:!1,success:function(t){t.on("click",".dialog-close",function(){u.layer.close(e)})},end:a})}():s(e&&e.message)},error:function(){s()}})}(e):n(c)):!0===c?(i(),$(this).attr({href:v.config.url.visaPrint(e),target:"_blank"})):n(c)})}function r(e,t){var n=[];return e.groupCode&&0!=e.groupCode.length||n.push(""),"send"===t&&(e.email?!1===(0,h.checkEmail)(e.email)&&n.push(""):n.push("")),0===n.length||n}function s(e){var t=u.layer.open({type:1,title:!1,content:'<div class="dialog-error"><div class="dialog-close"></div><i class="icon"></i>'+(e||"")+"</div>",area:["400px","auto"],btn:!1,closeBtn:!1,success:function(e){e.on("click",".dialog-close",function(){u.layer.close(t)})}})}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),l=n(1),d=n(14),u=n(10),f=n(162),h=n(159),p=n(542),m=n(543),v=n(19),g=1,y=$(window),b=void 0,_=void 0,k=void 0,C=void 0,T=d.template.compile(m.detailVisaDialogTemplate),w=window.openImageViewer||function(){},N=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.status=g,this.visaData=null,this.$el=t.$el,this.journeyList=t.journeyList||[],_=(0,l.getStore)()}return c(e,[{key:"load",value:function(e){this.visaData=e,this.status=4}},{key:"render",value:function(){var e=d.template.compile(p.detailVisaTemplate),t=(this.journeyList,this.visaData.filter(function(e){return e.visaInfo}));t.length>0?(this.$el.append(e({data:t,journeyId:void 0})).removeClass("section-loading"),this.status=5,this.bind()):this.remove()}},{key:"bind",value:function(){this.$el.find(".J_DetailVisaBlock").each(function(){var e=$(this);e.find(".J_VisaTab").each(function(){(0,f.createTaber)($(this),{ctx:e})}).end().find(".J_DetailVisaDeadline").each(function(){var e=$(this),t=e.parent(),n=t.find(".detail-visa-deadline");e.click(function(e){e.stopPropagation(),t.hasClass("expand")?t.removeClass("expand"):t.addClass("expand")}),n.click(function(e){e.stopPropagation()}),$(document).click(function(){t.removeClass("expand")})}).end().find(".J_DetailVisaSend").click(function(){k=$(this).data("id"),C=$(this).data("name"),i(function(e){o(e,"send")},"send")}).end().find(".J_DetailVisaPrint").click(function(){k=$(this).data("id"),C=$(this).data("name"),i(function(e){o(e,"print")},"print")})}),this.$el.find(".detail-visa-material-attachment").each(function(){var e=$(this).find("a"),t=[],n=[];e&&e.each(function(){var e=$(this).html(),i=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toLowerCase().split("."),t=e[e.length-1];return["png","jpg","jpeg","gif","bmp"].indexOf(t)>-1}(e),a=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toLowerCase().split("."),t=e[e.length-1];return["pdf"].indexOf(t)>-1}(e);i?(t.push($(this)),n.push({src:this.href,name:""}),$(this).removeAttr("href")):a&&this.setAttribute("target","_blank"),t.forEach(function(e,t){$(e).click(function(){w(n,{index:t})})})})})}},{key:"remove",value:function(){this.$el.remove(),y.trigger("resize")}},{key:"isLoaded",value:function(){return this.status>=4}},{key:"isRendered",value:function(){return this.status>=5}}]),e}();t['default']=N},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailVisaTemplate='\n<% var materialTypeMap = {0: \'\',1: \'\',2: \'\',3: \'\'} %>\n<% var deadline %>\n<div class="section-box detail-visa">\n    <div class="section-box-head">\n        <h2></h2>\n    </div>\n    <div class="section-box-body">\n\n        <% for (var i = 0; i < data.length; i++) { %>\n            <div class="J_DetailVisaBlock">\n                <% var visa = data[i]; %>\n                <% var visaInfo = visa.visaInfo; %>\n                <% var deadlines = (visa.deadline || {})[journeyId]; %>\n                <div class="section-box-title">\n                    <h3><%= visaInfo.name %></h3>\n                </div>\n\n                <div class="section-box-content">\n                    <div class="detail-visa-info">\n\n                        <% if (visaInfo.visaCityName) { %>\n                            <div class="detail-visa-info-item">\n                                <strong><%= visaInfo.visaCityName %></strong>\n                            </div>\n                        <% } %>\n                        <% if (visaInfo.enterCountryTimes) { %>\n                            <div class="detail-visa-info-item">\n                                <strong><%= visaInfo.enterCountryTimes %></strong>\n                            </div>\n                        <% } %>\n                        <% if (visaInfo.longestResidenceTime) { %>\n                            <div class="detail-visa-info-item">\n                                <strong><%= visaInfo.longestResidenceTime %></strong>\n                            </div>\n                        <% } %>\n                        <% if (visaInfo.handleTimeDuration) { %>\n                            <div class="detail-visa-info-item">\n                                <strong><% if (visaInfo.handleTimeDuration == 0) { %><% } else { %><%= visaInfo.handleTimeDuration %><% } %></strong>\n                            </div>\n                        <% } %>\n                        <% if (deadlines && deadlines.length && (deadline = deadlines[0])) { %>\n                            <div class="detail-visa-info-item single-row">\n                                <strong><%= deadline.visaEndDay ? \'\' + deadline.visaEndDay : \'\'%><%= deadline.visaEndOclock %></strong>\n                                <% if (deadlines.length > 1) { %>\n                                    <a class="J_DetailVisaDeadline detail-visa-time-more" href="javascript:;" mm="___"><i class="icon"></i></a>\n                                    <div class="detail-visa-deadline">\n                                        <i class="detail-visa-deadline-arrow"></i>\n                                        <div class="detail-visa-deadline-inner">\n                                            <div class="detail-visa-deadline-left">\n                                                <div class="thead">\n                                                    <table>\n                                                        <thead>\n                                                            <tr>\n                                                                <th class="col-1"></th>\n                                                                <th class="col-2"></th>\n                                                            </tr>\n                                                        </thead>\n                                                    </table>\n                                                </div>\n                                                <div class="tbody">\n                                                    <table>\n                                                        <tbody>\n                                                            <% for (var index = 0; index < deadlines.length; index++) { %>\n                                                                <% if (index % 2 === 0) { %>\n                                                                    <% deadline = deadlines[index] %>\n                                                                    <tr class="<%= index % 4 !== 0 ? \'even\' : \'\'%>">\n                                                                        <td class="col-1"><%= deadline.departsDate %></td>\n                                                                        <td class="col-2"><%= deadline.visaEndTime%>&nbsp;&nbsp;<%= deadline.visaEndOclock %></td>\n                                                                    </tr>\n                                                                <% } %>\n                                                            <% } %>\n                                                        </tbody>\n                                                    </table>\n                                                </div>\n                                            </div>\n                                            <div class="detail-visa-deadline-right">\n                                                <div class="thead">\n                                                    <table>\n                                                        <thead>\n                                                            <tr>\n                                                                <th class="col-1"></th>\n                                                                <th class="col-2"></th>\n                                                            </tr>\n                                                        </thead>\n                                                    </table>\n                                                </div>\n                                                <div class="tbody">\n                                                    <table>\n                                                        <tbody>\n                                                        <% for (var index = 0; index < deadlines.length; index++) { %>\n                                                            <% if (index % 2 === 1) { %>\n                                                                <% deadline = deadlines[index] %>\n                                                                <tr class="<%= (index - 1) % 4 !== 0 ? \'even\' : \'\'%>">\n                                                                    <td class="col-1"><%= deadline.departsDate %></td>\n                                                                    <td class="col-2"><%= deadline.visaEndTime%>&nbsp;&nbsp;<%= deadline.visaEndOclock %></td>\n                                                                </tr>\n                                                            <% } %>\n                                                        <% } %>\n                                                        </tbody>\n                                                    </table>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                <% } %>\n                            </div>\n                        <% } %>\n                        <% if (visaInfo.acceptanceScope) { %>\n                            <div class="detail-visa-info-item single-row">\n                                <strong><%= visaInfo.acceptanceScope %></strong>\n                            </div>\n                        <% } %>\n                    </div>\n                </div>\n\n                <div class="J_VisaTab section-box-toolbar">\n                    <ul class="section-box-tab">\n                        <% for (var h = 0; h < visaInfo.customerPropertyNames.length; h++) { %>\n                            <li<% if (h === 0) { %> class="active"<% } %> data-rel=".J_DetailVisa<%= visaInfo.customerPropertyNames[h].code %>">\n                                <a href="javascript:;"><%= visaInfo.customerPropertyNames[h].name %></a>\n                            </li>\n                        <% } %>\n                    </ul>\n\n                    <div class="detail-visa-button">\n                        <a class="J_DetailVisaSend detail-visa-button-mail" data-id="<%= visaInfo.id %>" data-name="<%= visaInfo.name %>" href="javascript:;" mm="___"><i class="icon"></i></a>\n                        <a class="J_DetailVisaPrint detail-visa-button-print" data-id="<%= visaInfo.id %>" data-name="<%= visaInfo.name %>" href="javascript:;" mm="___"><i class="icon"></i></a>\n                    </div>\n                </div>\n\n                <div class="section-box-content detail-visa-material">\n                    <% var visaMaterial = visa.visaMaterial %>\n                    <% for (var h = 0; h < visaInfo.customerPropertyNames.length; h++) { %>\n                        <% var personType = visaInfo.customerPropertyNames[h].code %>\n\n                        <div class="J_DetailVisa<%= personType %> detail-visa-block<%= h == 0 ? \' active\' : \'\' %>">\n                            <div class="detail-visa-material-head">\n                                <table>\n                                    <thead>\n                                        <tr>\n                                            <th class="col-1"></th>\n                                            <th class="col-2"></th>\n                                            <th class="col-3"></th>\n                                        </tr>\n                                    </thead>\n                                </table>\n                            </div>\n                            <div class="detail-visa-material-body">\n                                <table>\n                                    <tbody>\n                                    <% for (var materialIndex = 0; materialIndex < visaMaterial.length; materialIndex++) { %>\n                                        <% var material = visaMaterial[materialIndex] %>\n                                        <% if (material.personnenlType == personType) { %>\n                                            <tr>\n                                                <td class="col-1"><%= material.customName %></td>\n                                                <td class="col-2"><%= materialTypeMap[material.materialType] %></td>\n                                                <td class="col-3">\n                                                    <%=# material.materialDesc %>\n                                                    <% if (material.attachments && material.attachments.length) { %>\n                                                        <% for (var attachmentIndex = 0; attachmentIndex < material.attachments.length; attachmentIndex++) { %>\n                                                            <div class="detail-visa-material-attachment">\n                                                                <a href="<%= material.attachments[attachmentIndex].attachmentPath %>" mm="___"><%= material.attachments[attachmentIndex].attachmentName %></a>\n                                                            </div>\n                                                        <% } %>\n                                                    <% } %>\n                                                </td>\n                                            </tr>\n                                        <% } %>\n                                    <% } %>\n                                    </tbody>\n                                </table>\n                            </div>\n                        </div>\n                    <% } %>\n                </div>\n\n            </div>\n        <% } %>\n\n\n        <div class="section-box-title">\n            <h3></h3>\n        </div>\n\n        <div class="section-box-content">\n            <div class="item-with-title">\n                <span class="dot"></span>\n                <div class="item-title"><strong></strong></div>\n                <p>\n                    <br>\n                    6\n                </p>\n            </div>\n            <% for (var i = 0; i < data.length; i++) { %>\n                <% var visa = data[i]; %>\n                <% var visaInfo = visa.visaInfo; %>\n                <% if (visaInfo.bookNotice || visaInfo.importantNote) { %>\n                    <div class="item-with-title">\n                        <span class="dot"></span>\n                        <div class="item-title"><strong><%= visaInfo.customName %></strong></div>\n                        <% if(visaInfo.importantNote) { %>\n                            <span class="notice-dot"></span>\n                            <div class="notice"></div>\n                            <p class="notice"><%=# (visaInfo.importantNote || \'\').replace(/[\\n\\r]+/g, \'<br>\') %></p>\n                        <% } %>\n                        <% if(visaInfo.bookNotice) {%>\n                            <span class="notice-dot"></span>\n                            <div class="notice"></div>\n                            <p class="notice"><%=# (visaInfo.bookNotice || \'\').replace(/[\\n\\r]+/g, \'<br>\') %></p>\n                        <% } %>\n                    </div>\n                <% } %>\n            <% } %>\n        </div>\n\n\n        <div class="section-box-title">\n            <h3></h3>\n        </div>\n\n        <div class="section-box-content">\n\n            <div class="item-with-title">\n                <span class="dot"></span>\n                <div class="item-title"><strong></strong></div>\n            </div>\n            <div class="J_retailName retail-name item-with-title">\n                <span class="dot"></span>\n                <div class="item-title">\n                    <strong></strong>\n                    <a href="http://www.tuniu.com/corp/subCorp/search" target="_blank"></a>\n                </div>  \n            </div>\n        </div>\n\n    </div>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailVisaDialogTemplate='\n<div class="dialog dialog-visa">\n    <div class="J_VisaClose dialog-close"></div>\n    <% if (dialogType == \'send\') { %>\n        <div class="dialog-head"></div>\n    <% } else { %>\n        <div class="dialog-head"></div>\n    <% } %>\n    <div class="dialog-body">\n        <div class="dialog-row"></div>\n        <div class="dialog-row">\n            <div class="J_VisaPersonType dialog-checkbox" data-id="2" data-name=""><i class="icon"></i></div>\n            <div class="J_VisaPersonType dialog-checkbox" data-id="3" data-name=""><i class="icon"></i></div>\n            <div class="J_VisaPersonType dialog-checkbox" data-id="4" data-name=""><i class="icon"></i></div>\n            <div class="J_VisaPersonType dialog-checkbox" data-id="5" data-name=""><i class="icon"></i></div>\n            <div class="J_VisaPersonType dialog-checkbox" data-id="6" data-name=""><i class="icon"></i></div>\n            <div class="J_VisaPersonType dialog-checkbox" data-id="7" data-name=""><i class="icon"></i></div>\n        </div>\n        <% if (dialogType === \'send\') { %>\n            <div class="dialog-row dialog-row-input">\n                <div class="dialog-input">\n                    <div class="dialog-label"></div>\n                    <div class="dialog-input-ctrl">\n                        <input class="J_VisaEmail" type="text" name="email">\n                    </div>\n                </div>\n            </div>\n        <% } %>\n        <div class="J_DialogError dialog-row dialog-error-tip">\n            <i class="icon"></i>&nbsp;<strong></strong>\n        </div>\n        <div class="dialog-row dialog-buttons">\n            <a class="J_VisaCancel dialog-button dialog-cancel" href="javascript:;"></a>\n            <% if (dialogType == \'send\') { %>\n                <a class="J_VisaSend dialog-button dialog-send" href="javascript:;"></a>\n            <% } else { %>\n                <a class="J_VisaSend dialog-button dialog-send" href="javascript:;"></a>\n            <% } %>\n        </div>\n        \n    </div>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchRetail=t.fetchVisa=void 0;var i=n(1),a=n(19),o={visaData:null,visaLoaded:!1,fetch:function(e,t){var n=this;if(n.visaData)e(n.visaData);else if(n.visaLoaded)t&&t();else{var o=(0,i.getStore)();$.ajax({dataType:"json",url:a.config.url.visa({productId:o.getState("productId"),bookCityCode:o.getState("bookCityCode")||void 0,departCityCode:o.getState("departCityCode")||void 0})}).done(function(i){i&&i.success&&i.data?(e(i.data),n.visaData=i.data):t&&t()}).fail(function(){t&&t()}).always(function(){n.visaLoaded=!0})}}},r={retailData:{},bookCityCode:0,setBookCode:function(e){this.bookCityCode=e},fetch:function(e,t){var n=this;n.retailData[n.bookCityCode]?e(n.retailData[n.bookCityCode]):$.ajax({dataType:"json",url:a.config.url.retail({bookCode:n.bookCityCode}),success:function(i){i&&i.success&&i.data?(e(i.data),n.retailData[n.bookCityCode]=i.data):t&&t()},error:function(e,n){t&&t()}})}};t.fetchVisa=o,t.fetchRetail=r},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.detailModule=void 0;var a=n(1),o=n(117),r=n(173),s=i(n(108)),c=i(n(155)),l=n(546),d=(n(552),n(555)),u=n(558),f=n(19),h=$(window),p={init:function(){var e=$("#J_DetailTab"),t=e.height();(0,o.createFixer)(e,{range:{bottom:$("#J_Detail")}}),(0,r.createScrollTaber)(e,{offset:t}),this.initFavor(),this.initRoute(),this.initPolicy(),this.initVisa();var n=window.commentModule,i=(0,a.getStore)().getState("resTypeList")||[];n&&n.init({el:"#J_Comment",productId:(0,a.getStore)().getState("productId"),tab:{product:-1!=Array.indexOf(i,0),hotel:-1!=Array.indexOf(i,1),scenic:-1!=Array.indexOf(i,2)},type:function(e){return!(!e.length||-1!=Array.indexOf(i,0))&&(-1==Array.indexOf(i,1)?-1!=Array.indexOf(i,2)&&"CATEGORY_VIEWPORT":"CATEGORY_HOTEL")}(i)}),d.recommendModule.init({recommendUrl:f.config.url.recommend,mainHost:f.config.host}),this.bindEvent()},bindEvent:function(){$(".J_SubmitDetail").on("click",function(){var e=$("#J_product").offset().top;$("html,body").animate({scrollTop:e},300)})},initFavor:function(){$(".J_DetailFavorItem").each(function(){var e=$(this);e.on("click",".detail-favor-more",function(){e.addClass("expand")}).on("click",".detail-favor-less",function(){e.removeClass("expand")})}),$(".J_DetailFeature").find("img").each(function(){var e=$(this),t=e.data("src");s.on(e,function(){var n=new Image;n.onload=function(){e.prop("src",t).parent().addClass("loaded"),s.off(e),h.trigger("resize")},n.src=t,n.onerror=function(){e.parent().addClass("loaded"),s.off(e),h.trigger("resize")}})}),$(".J_DetailFeatureDeadline").each(function(){var e=$(this),t=e.parent(),n=t.find(".detail-feature-deadline"),i=t.find(".detail-feature-deadline-arrow");e.click(function(a){if(a.stopPropagation(),t.hasClass("expand"))t.removeClass("expand");else{var o=e.position()||{left:0,top:0};n.css({top:o.top+t.height()+7}),i.css({left:o.left+e.width()/2}),t.addClass("expand")}}),n.click(function(e){e.stopPropagation()}),$(document).click(function(){t.removeClass("expand")})})},initRoute:function(){l.routeModule.init({isNeedReception:c.isNeedReception})},initPolicy:function(){$(".J_DetailPolicy").find("[data-role=fold-box]").each(function(){(0,u.createAutoFold)($(this))})},initVisa:function(){$(".J_DetailVisa").hide(),$('.detail-tab-item[data-rel=".J_DetailVisa"]').each(function(){$(this).hide()})}};t.detailModule=p},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.routeModule=void 0;var a=n(1),o=(i(n(11)),i(n(391)),i(n(108))),r=(n(164),n(117)),s=n(162),c=n(173),l=n(547),d=$(window),u=($(document),void 0),f=void 0,h=void 0,p=void 0,m=void 0,v={init:function(e){f=e,u=(0,a.getStore)(),h=$("#J_DetailTab").height(),p=u.getState("journeyType"),m=u.getState("journeyData"),this.initSingle()},initSingle:function(){var e=$(".J_DetailRoute");e.data("id");if(3==p)l.journey4Module.init(e,m,{tabHeight:h}).init();else{var t=$(".J_DetailRoute"),n=$(".J_DetailJourney"),i=t.find(".J_JourneyNav"),a=t.find(".J_JourneyTab");(0,c.createScrollTaber)(i,{offset:h}),(0,s.createTaber)(a),(0,r.createFixer)(i,{range:{top:n,bottom:n,left:t,right:t},offset:{top:h+10},ctx:t});!function(e){e.find(".item-label-fixed").each(function(){var e=$(this),t=e.find(".item-label-inner"),n=e.height(),i=t.height();n<i&&(t.height(n),e.addClass("fold"),e.on("click",".item-label-more",function(){e.addClass("expand"),t.height(i),d.trigger("resize")}).on("click",".item-label-less",function(){e.removeClass("expand"),t.height(n),d.trigger("resize")}))}),d.trigger("resize")}($("#J_Detail")),function(e){e.find("img").each(function(){var e=$(this),t=e.data("src");o.on(e,function(){var n=new Image;n.onload=function(){e.prop("src",t).parent().addClass("loaded"),o.off(e),d.trigger("resize")},n.onerror=function(){e.parent().addClass("loaded"),o.off(e),d.trigger("resize")},n.src=t,e.src=t})})}(t)}}};t.routeModule=v},function(e,t,n){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}function a(e,t){return b?e&&e[0]?new p.Map(e[0]):void 0:(y.push({$element:e,callback:t}),b||(window.initializeMapModule=function(){if(b=!0,window.initializeMapModule=null,y.length)for(;y.length;){var e=y.pop();e.callback(a(e.$element))}if(y.length)for(;y.length;){var t=y.pop();t.callback(a(t.$element))}},$('<script src="http://maps.google.cn/maps/api/js?sensor=false&callback=initializeMapModule" defer sync><\/script>').appendTo("head")),null)}Object.defineProperty(t,"__esModule",{value:!0}),t.journey4Module=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=i(n(11)),c=n(10),l=n(73),d=i(n(108)),u=n(117),f=n(162),h=n(173),p=n(400),m=n(549),v=n(551),g=$(window),y=($(document),[]),b=!1,_=s.compile(v.spotDetailTemplate,{client:!0,compileDebug:!1}),k=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.valid=!(!n||"object"!==(void 0===n?"undefined":o(n))),this.$element=t,this.data=n||{},this.options=Object.assign({tabHeight:0},i),this.isResourceType=2==this.data.scheduleType,this.currentDayId=null,this.inited=!1,this.resList=null,this.navFixer=null}return r(e,[{key:"init",value:function(){if(this.valid){this.inited=!0,this.resList=(this.data.detail||[]).reduce(function(e,t){return e[t.cid]=t,(t.data||[]).forEach(function(t){e[t.cid]=t,(t.data||[]).forEach(function(t){e[t.cid]=t})}),e},{}),this.smallMapData=function(e){var t=[];return 1==e.scheduleType&&(e.detail||[]).reduce(function(e,t){var n=(t.data||[]).reduce(function(e,t){return 1==t.moduleTypeValue&&(t.data||[]).reduce(function(e,t){return t.latitude&&t.longitude&&e.push(t),e},e),e},[]);return e.push({day:t.day,cid:t.cid,list:n}),e},t),t.filter(function(e){return e.list.length})}(this.data);var e=this.$element.find(".J_JourneyNav"),t=this.$element.find(".J_DetailJourney");(0,h.createScrollTaber)(e,Object.assign({ctx:this.$element,offset:this.options.tabHeight},this.options.scrollTaber));if(!this.isResourceType)(0,h.createScrollTaber)(e,{ctx:this.$element,offset:this.options.tabHeight,attr:"data-sub-rel"});if(this.navFixer=(0,u.createFixer)(e,Object.assign({range:{top:t,bottom:t,left:this.$element,right:this.$element},offset:{top:this.options.tabHeight+32},ctx:this.$element},this.options.fixer)),!this.isResourceType){var n=this.$element.find(".J_Journey4RouteTab");n.length&&(0,f.createTaber)(n,{ctx:this.$element});var i=this.$element.find(".J_DetailRouteBrief"),o=i.find(".J_DetailRouteBriefBox"),r=i.find(".J_DetailRouteBriefInner"),s=o.height(),c=r.height();this.initDownToolbar(),s<c&&i.addClass("fold"),s>c&&o.height(c),this.briefMinHeight=s,this.briefMaxHeight=c,this.$brief=i,this.$briefBox=o,this.$briefInner=r,this.smallMapData&&this.smallMapData.length&&(this.$mapDay=this.$element.find(".J_DetailJourneyMapDay"),this.$mapSmall=this.$element.find(".J_DetailJourneyMapSmall"),this.$mapSmall.length&&this.setSmallMap(a(this.$mapSmall,this.setSmallMap.bind(this))))}this.$element.find("img").each(function(){var e=$(this),t=e.data("src");t&&d.on(e,function(){var n=new Image;n.onload=function(){e.prop("src",t).parent().addClass("loaded"),d.off(e),g.trigger("resize")},n.onerror=function(){e.parent().addClass("loaded"),d.off(e),g.trigger("resize")},n.src=t,e.src=t})}),this.bind()}}},{key:"bind",value:function(){var e=this;this.$element.on("click",".J_ViewMap",function(){}).on("click",".J_ViewDetail",function(t){var n=$(t.currentTarget).data("id");if(n){var i=e.getResDataByCid(n);i&&e.openDetailDialog(i)}}).on("click",".J_DetailRouteBriefMore",function(){e.$briefBox.height(e.briefMaxHeight),e.$brief.addClass("expand"),g.trigger("resize")}).on("click",".J_DetailRouteBriefLess",function(){e.$briefBox.height(e.briefMinHeight),e.$brief.removeClass("expand"),g.trigger("resize")}).on("click",".J_DetailJourneyMapPrev",function(){e.prevMapDay()}).on("click",".J_DetailJourneyMapNext",function(){e.nextMapDay()}).on("click",".J_DetailJourneyMapView",function(){b&&(0,m.openBigMap)(e.data,e.resList,e.currentDayId)})}},{key:"initDownToolbar",value:function(){var e=void 0,t=this.$element.find(".J_DetailRouteBrief"),n=this.$element.find(".J_SideDownload, .J_SidePrint");n.hide(),g.on("scroll",function(){clearTimeout(e),e=setTimeout(function(){var e=t.offset();e&&e.top<g.scrollTop()?n.show():n.hide()},10)})}},{key:"setSmallMap",value:function(e){e&&(this.$mapSmall.removeClass("loading"),this.map=e,this.loadMap())}},{key:"loadMap",value:function(e){if(e=e||this.getCurrentDay()){var t=this.getDayResForMap(e);this.currentDayId=e.cid,this.map.load(t),this.updateMapTab(e)}}},{key:"getResDataByCid",value:function(e){var t=null;return this.resList&&(t=this.resList[e]||null),t}},{key:"getDayResForMap",value:function(e){return e&&e.list?e.list.map(function(e){return{moduleType:"spot",title:e.title,latitude:e.latitude,longitude:e.longitude}}):[]}},{key:"getCurrentDay",value:function(e){return e=e||this.currentDayId,e?this.smallMapData.filter(function(t){return t.cid==e})[0]:this.smallMapData[0]}},{key:"getCurrentDayIndex",value:function(){var e=this,t=0;return this.currentDayId&&this.smallMapData.some(function(n,i){if(n.cid===e.currentDayId)return t=i,!0}),t}},{key:"getDayDataByIndex",value:function(e){return this.smallMapData[e||0]}},{key:"updateMapTab",value:function(e){e=e||this.getCurrentDay(),this.$mapDay.text(""+e.day+"")}},{key:"prevMapDay",value:function(){var e=this.getCurrentDayIndex();if(!(e<=0)){var t=this.getDayDataByIndex(e-1);t&&this.loadMap(t)}}},{key:"nextMapDay",value:function(){var e=this.getCurrentDayIndex();if(!(e>=this.smallMapData.length-1)){var t=this.getDayDataByIndex(e+1);t&&this.loadMap(t)}}},{key:"enable",value:function(){this.inited?this.isResourceType||this.map||this.setSmallMap(a(this.$mapSmall,this.setSmallMap.bind(this))):this.init(),this.navFixer&&this.navFixer.update(),this.navFixer&&this.navFixer.enable()}},{key:"disable",value:function(){this.isResourceType||this.map||function(e){for(var t=y.length-1;t>=0;t--)y[t]&&y[t].$element===e&&y.splice(t,1)}(this.$mapSmall),this.navFixer&&this.navFixer.disable()}},{key:"openDetailDialog",value:function(e){var t=c.layer.open({title:!1,type:1,content:_({data:e}),closeBtn:!1,btns:0,btn:!1,area:["830px","440px"],success:function(e){setTimeout(function(){new l.Gallery(e.find(".J_DialogGallery"),{autoChange:!0})},1),e.find(".J_DialogClose").click(function(){c.layer.close(t)})}})}}]),e}(),C={init:function(e,t,n){return new k(e,t,n)}};t.journey4Module=C},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();t.createMarker=function(e){return new(c||(c=function(e){function t(e){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.data=e,n.active=!!e.active,e.active=!1,n.element=null,n.typeClassName="jmap-spot-"+e.type,n.hightlightClassName="jmap-spot-"+e.type+"-hightlight",n.activeClassName="jmap-spot-"+n.data.type+"-active",n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,google.maps.OverlayView),i(t,[{key:"onAdd",value:function(){var e=this,t='<div class="jmap-spot '+this.typeClassName+'"><div class="jmap-win-box"><i class="jmap-win-arrow"></i><div class="jmap-win-content">'+this.data.name+'</div></div><div class="jmap-marker"></div></div>',n=this.getPanes(),i=$(t),a=i.clone().css({opacity:0,filter:"alpha(opacity=0)"});this.element=i,this.mask=a,a.find(".jmap-win-box, .jmap-marker").on("click",function(){google.maps.event.trigger(e,"click")}).on("mouseenter",function(){google.maps.event.trigger(e,"mouseenter")}).on("mouseleave",function(){google.maps.event.trigger(e,"mouseleave")}),this.active&&this.activateBySelf(),n.markerLayer.appendChild(i[0]),n.floatPane.appendChild(a[0])}},{key:"draw",value:function(){this.setPosition(this.data[r],this.data[s])}},{key:"onRemove",value:function(){this.element.remove(),this.mask.remove(),this.element=null,this.mask=null}},{key:"setZIndex",value:function(e){this.element&&(e=e||1,this.element.css("z-index",e),this.mask.css("z-index",e))}},{key:"moveToTop",value:function(){this.setZIndex(999)}},{key:"restoreZIndex",value:function(){this.setZIndex(1)}},{key:"setPosition",value:function(e,t){if(this.element){var n=this.getProjection().fromLatLngToDivPixel(new google.maps.LatLng(e,t)),i={top:n.y-o-28+"px",left:n.x-this.element.width()/2+a/2-1+"px"};this.element.css(i),this.mask.css(i)}}},{key:"activate",value:function(){this.active=!0,this.element&&this.element.addClass(this.activeClassName),this.moveToTop()}},{key:"activateBySelf",value:function(){this.activate(),$(window).trigger("mapMarkerActivated",this.data)}},{key:"deactivate",value:function(){this.active=!1,this.element&&this.element.removeClass(this.activeClassName),this.restoreZIndex()}},{key:"deactivateBySelf",value:function(){this.deactivate(),$(window).trigger("mapMarkerDeactivated",this.data)}},{key:"hightlight",value:function(){this.element&&this.element.addClass(this.hightlightClassName)}},{key:"removeHightlight",value:function(){this.element&&this.element.removeClass(this.hightlightClassName)}}]),t}()))(e)};var a=43,o=43,r="latitude",s="longitude",c=void 0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.openBigMap=function(e,t,n){c=e.detail,l=t,d=n,u=a.layer.open({type:1,title:!1,closeBtn:!1,content:s({data:c,scheduleType:e.scheduleType}),area:["1000px","600px"],btn:!1,success:function(e){function t(e,t){if(e){var i=function(e){var t;return c.some(function(n){if(n.cid==e||n.data&&n.data.some(function(t){return t.cid==e}))return t=n,!0}),t}(e);if(i){var a=function(e){return e?(e.data||[]).reduce(function(t,n){return(n.data||[]).forEach(function(n){n.latitude&&n.longitude&&t.push({moduleType:"spot",cid:n.cid,id:n.cid,dayId:e.cid,title:n.title,latitude:n.latitude,longitude:n.longitude})}),t},[]):[]}(i);if(a.length)return o.load(a),t||(t=a[0].cid),n(e,t),void o.activateMarkerById(t)}n(e,t)}}function n(e,t){f.find(".map-nav-active").removeClass("map-nav-active").end().find(".map-nav-sub").hide();var n=f.find(".map-main-item[data-nav-id="+e+"]").addClass("map-nav-active").siblings(".map-nav-sub").show();n.find(".map-sub-item").removeClass("map-nav-active").filter("[data-sub-id="+t+"]").addClass("map-nav-active"),n.end().closest(".map-nav-sub").show()}var o=new i.Map(e.find(".J_MapDetail")[0],{onMarkerActive:function(e){e&&e.cid&&e.dayId&&t(e.dayId,e.cid)}});f=e.find(".J_MapDetailJourney"),e.on("click",".map-nav-item",function(){t($(this).data("nav-id"))}).on("click",".map-sub-item",function(){t($(this).data("nav-id"),$(this).data("sub-id"))}).on("click",".J_MapDetailClose",function(){a.layer.close(u)}),d&&(f.find(".map-sub-item[data-nav-id="+d+"]").length||(d=null)),t(d||f.find(".map-sub-item").data("nav-id"))}})};var i=n(400),a=n(10),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(11)),r=n(550),s=o.compile(r.mapDialogTemplate,{client:!0,compileDebug:!1}),c=void 0,l=void 0,d=void 0,u=void 0,f=void 0},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mapDialogTemplate='\n<div class="map-detail">\n    <div class="J_MapDetailClose map-detail-close"></div>\n    <div class="J_MapDetail map-detail-map"></div>\n    <div class="map-detail-journey">\n    <div class="J_MapDetailJourney map-nav">\n      <ul class="map-nav-main">\n        <% if (scheduleType == 1) { %>\n          <% for (var journeyIndex = 0, list; journeyIndex < data.length; journeyIndex++) { %>\n            <% if (data[journeyIndex] && (list = data[journeyIndex][\'data\']) && list.length) { %>\n                <% for (var isBlank = true, moduleIndex = 0; moduleIndex < list.length; moduleIndex++) {\n                    var moduleData = list[moduleIndex];\n                    if (moduleData.data && moduleData.data.length) {\n                        isBlank = !moduleData.data.filter(function(resData) {\n                            return resData && resData.latitude && resData.longitude\n                        }).length;\n                        if (!isBlank) {\n                            break;\n                        }\n                    }\n                } %>\n                <% if (!isBlank) { %>\n                    <li>\n                        <div class="map-nav-item map-main-item" data-nav-id="<%= data[journeyIndex][\'cid\'] %>">\n                          <div class="map-nav-label" title="<%= data[journeyIndex][\'day\'] %>"><%= data[journeyIndex][\'day\'] %></div>\n                          <i class="map-nav-icon-serial"><span>D<%= data[journeyIndex][\'day\'] %></span></i>\n                        </div>\n                        <ul class="map-nav-sub">\n                          <% var itemIndex = 1;%>\n                          <% for (var moduleIndex = 0; moduleIndex < list.length; moduleIndex++) { %>\n                              <% var moduleData = list[moduleIndex] %>\n                              <% if (moduleData) { %>\n                                  <% if (moduleData.data && moduleData.data.length) { %>\n                                      <% for(var resIndex = 0; resIndex <  moduleData.data.length; resIndex++) { %>\n                                          <% var resData = moduleData.data[resIndex] %>\n                                          <% if (resData && resData.latitude && resData.longitude) { %>\n                                              <li>\n                                                <div class="map-nav-item map-sub-item" data-nav-id="<%= data[journeyIndex][\'cid\'] %>" data-sub-id="<%= resData[\'cid\'] %>">\n                                                  <div class="map-nav-label" title="<%= resData[\'title\'] %>"><%= resData[\'title\'] %></div>\n                                                  <i class="map-nav-icon-serial"><span><%= itemIndex++ %></span></i>\n                                                </div>\n                                              </li>\n                                          <% } %>\n                                      <% } %>\n                                  <% } %>\n                              <% } %>\n                          <% } %>\n                        </ul>\n                    </li>\n                <% } %>\n            <% } %>\n          <% } %>\n        <% } %>\n      </ul>\n    </div>\n    </div>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.spotDetailTemplate='\n<div class="detail-dialog">\n    \x3c!-- dialog head S --\x3e\n    <div class="detail-dialog-head">\n        <div class="detail-dialog-title"><%= data.title %></div>\n        <div class="J_DialogClose detail-dialog-close"></div>\n    </div>\n    \x3c!-- dialog head E --\x3e\n    <div class="detail-dialog-body">\n        <div class="detail-dialog-gallery">\n            <% if (data.picture && data.picture.length) { %>\n                <div class="J_DialogGallery gallery">\n                    <div class="gallery-display">\n                        <ul class="gallery-display-box">\n                            <% if (data.picture && data.picture.length) { %>\n                                <% for(var i = 0, len = data.picture.length, item; i < data.picture.length && (item = data.picture[i]); i++) { %>\n                                <li class="gallery-photo<% if (i === 0) { %> gallery-photo-active<% } %>" data-src="<%= item.url %>" data-thumb="<%= item.url %>">\n                                    <img src="<%= item.url %>" alt="<%= item.title %>">\n                                </li>\n                                <% } %>\n                            <% } %>\n                        </ul>\n                    </div>\n                    <div class="gallery-nav">\n                        <div class="gallery-prev"><i class="icon"></i></div>\n                        <div class="gallery-next"><i class="icon"></i></div>\n                        <div class="gallery-thumbs">\n                            <div class="gallery-mask"></div>\n                            <div class="gallery-nav-box">\n                                <ul class="gallery-nav-list">\n                                    <% if (data.picture && data.picture.length) { %>\n                                        <% for(var i = 0, len = data.picture.length, item; i < data.picture.length && (item = data.picture[i]); i++) { %>\n                                        <li class="gallery-thumb"><img src="<%= item.url %>" alt="<%= item.title %>"></li>\n                                        <% } %>\n                                    <% } %>\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            <% } %>\n        </div>\n\n        <div class="detail-dialog-info">\n            <div class="detail-dialog-info-box">\n                <div class="detail-dialog-info-title">\n                    <i class="icon detail-content-icon-note"></i>\n                </div>\n                <% if (data.beenCount && data.beenCount != 0) { %>\n                    <div class="detail-dialog-info-item">\n                        <i class="icon detail-content-icon-person"></i>\n                        <strong class="detail-dialog-info-strong"><%= data.beenCount %></strong>\n                    </div>\n                <% } %>\n                <% if (data.times != 0) { %>\n                    <div class="detail-dialog-info-item">\n                        <i class="icon detail-content-icon-clock"></i> :\n                        <%= data.times %>\n                    </div>\n                <% } %>\n                <% if (data.opened) { %>\n                    <div class="detail-dialog-info-item">\n                        <i class="icon detail-content-icon-calendar"></i> :\n                        <%= data.opened %>\n                    </div>\n                <% } %>\n                <% if (data.telephone) { %>\n                    <div class="detail-dialog-info-item">\n                        <i class="icon detail-content-icon-telphone"></i> :\n                        <%= data.telephone %>\n                    </div>\n                <% } %>\n                <% if (data.address) { %>\n                    <div class="detail-dialog-info-item">\n                        <i class="icon detail-content-icon-location"></i> :\n                        <%= data.address %>\n                    </div>\n                <% } %>\n                <% if (data.content) { %>\n                    <div class="detail-dialog-info-desc">\n                        <%- data.content %>\n                    </div>\n                <% } %>\n            </div>\n        </div>\n    </div>\n</div>\n'},function(e,t,n){"use strict";function i(){$.ajax({dataType:"json",url:v.commentUrl(),data:{productId:g.getState("productId"),page:P.page,selectedType:P.tagId},success:function(e){e&&e.success&&(y||(y=!0,function(e){b||(b=s.template.compile(h.commentLayoutTemplate)),C.html(b({data:e})),T=C.find(".comment-head"),w=C.find(".comment-tab"),N=C.find(".comment-tag"),I=C.find(".comment-list-outer"),D=C.find(".comment-list"),S=C.find(".pagination"),C.removeClass("section-loading"),function(){var e=w.find(".comment-tab-item");e.click(function(){var t=$(this);t.hasClass("active")||(e.removeClass("active"),t.addClass("active"),function(e){if(e===P.tabId)return;P.tabId=e,a()}(t.data("id")))});var t=N.find(".comment-tag-item");t.click(function(){var e=$(this);e.hasClass("active")||(t.removeClass("active"),e.addClass("active"),function(e){if(e===P.tagId)return;P.tagId=e,a()}(e.data("id")))})}(),k.trigger("resize")}(function(e){return e&&e.selectedTypeList&&e.selectedTypeList.length&&e.selectedTypeList.sort(function(e,t){return t.selectedAmount-e.selectedAmount}),e}(e.data))),function(e){!function(e){_||(_=s.template.compile(p.commentContentTemplate));D.html(_({data:e,helper:m.helper})),x?(x.reload({current:P.page,total:e.pageNum}),x.render()):x=(0,f.createPagination)(S,{current:P.page,total:e.pageNum,onchange:function(e){P.page=e,a(),(0,l.record)("___")}});k.trigger("resize"),D.find(".J_CommentPhoto").each(function(){var e=$(this);c.layer.photos({photos:e,shift:5,shade:.5}),function(e,t){function n(){++a===i&&t()}var i=e.length,a=0;e&&e.length?e.forEach(function(e){var t=new Image;t.onload=function(){n()},t.onerror=function(){n()},t.src=e.src}):t()}(e.find("img").toArray(),function(){(0,d.createGallery)(e)})})}(e)}(e.data))},error:function(e,t){}})}function a(){i()}Object.defineProperty(t,"__esModule",{value:!0}),t.commentModule=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),r=n(1),s=n(14),c=n(10),l=n(115),d=(n(159),n(401)),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(108)),f=n(174),h=n(553),p=n(554),m=n(48),v=void 0,g=void 0,y=!1,b=void 0,_=void 0,k=$(window),C=void 0,T=void 0,w=void 0,N=void 0,I=void 0,D=void 0,S=void 0,x=void 0,P={tabId:"",tagId:0,photo:0,page:1},M={init:function(e){v=e,g=(0,r.getStore)(),C=$("#J_Comment"),u.on(C,function(){u.off(C),i()})}};!function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timer=null,this.visible=!1,this.$element=null,this.$arrow=null,this.defaultWidth=500,this.defaultHeight=400,this.width=0,this.height=0,this.delay=150,this.createView()}o(e,[{key:"createView",value:function(){this.$element=$("<div />").addClass("float-layer").hide().appendTo("body"),this.$inner=$("<div />").addClass("float-layer-inner").appendTo(this.$element),this.$arrow=$("<div />").addClass("float-layer-arrow").appendTo(this.$element)}},{key:"bind",value:function(){}},{key:"show",value:function(e){this.nextImg=e,clearTimeout(this.timer),this.timer=setTimeout(this._show.bind(this),this.delay)}},{key:"getNextPosition",value:function(){var e=this.nextImg,t=void 0;return e&&(t=e.offset()),Object.assign({left:0,top:0,width:e.width(),height:e.height()},t)}},{key:"_show",value:function(){this.getNextPosition();this.$element.css({left:0}),this.visible}},{key:"_load",value:function(){}},{key:"hide",value:function(){clearTimeout(this.timer),this.timer=setTimeout(this._hide.bind(this),this.delay)}},{key:"_hide",value:function(){this.visible=!1,this.nextImg=null,this.width=0,this.height=0,this.$element.hide().css({left:0,top:0}),this.$inner.empty().width(this.width).height(this.height)}}])}();t.commentModule=M},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.commentLayoutTemplate='\n<% var gradeMap = {\n        stroke: \'\',\n        stay: \'\',\n        traffic: \'\',\n        guide: \'\',\n        book: \'\'\n    }; %>\n<div class="section-box comment">\n    <div class="section-box-head">\n        <h2></h2>\n    </div>\n    <div class="section-box-body">\n\n        <% if (data && data.summary && data.summary.totalNum) { %>\n\n            <div class="comment-head">\n                <div class="comment-satisfaction">\n                    <div></div>\n                    <div><strong><%= data.summary.satisfaction %>%</strong></div>\n                    <div><%= data.summary.totalNum %></div>\n                    <i class="icon"></i>\n                </div>\n\n                <div class="comment-head-right">\n                    <%  var lv1 =data.selectedTypeList.filter(function(item) { return item.selectedType == 20; })[0];\n                        var lv2 =data.selectedTypeList.filter(function(item) { return item.selectedType == 21; })[0];\n                        var lv3 =data.selectedTypeList.filter(function(item) { return item.selectedType == 22; })[0];\n                        %>\n                    <div class="comment-percent">\n                        <table>\n                            <tr>\n                                <td class="col-1">(<%= lv1.selectedAmount %>)</td>\n                                <td class="col-2">\n                                    <div class="comment-percent-value">\n                                        <i style="width: <%= (lv1.selectedAmount / data.count * 100).toFixed() %>%"></i>\n                                    </div>\n                                </td>\n                                <td class="col-3"><strong><%= (lv1.selectedAmount / data.count * 100).toFixed() %>%</strong></td>\n                            </tr>\n                            <tr>\n                                <td class="col-1">(<%= lv2.selectedAmount %>)</td>\n                                <td class="col-2">\n                                    <div class="comment-percent-value">\n                                        <i style="width: <%= (lv2.selectedAmount / data.count * 100).toFixed() %>%"></i>\n                                    </div>\n                                </td>\n                                <td class="col-3"><strong><%= (lv2.selectedAmount / data.count * 100).toFixed() %>%</strong></td>\n                            </tr>\n                            <tr>\n                                <td class="col-1">(<%= lv3.selectedAmount %>)</td>\n                                <td class="col-2">\n                                    <div class="comment-percent-value">\n                                        <i style="width: <%= (lv3.selectedAmount / data.count * 100).toFixed() %>%"></i>\n                                    </div>\n                                </td>\n                                <td class="col-3"><strong><%= (lv3.selectedAmount / data.count * 100).toFixed() %>%</strong></td>\n                            </tr>\n                        </table>\n                    </div>\n\n                \n\n                    <div class="comment-post">\n                        <div class="comment-post-desc">\n                            <br><strong><%= data.summary.money %></strong>\n                        </div>\n                        <div class="comment-post-button">\n                            <a href="https://i.tuniu.com/list" target="_blank" mm="___"></a>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div class="comment-tab">\n                <ul class="comment-tab-list">\n                    <li class="comment-tab-item active" mm="___">\n                        <span>(<%= data.summary.totalNum %>)</span>\n                    </li>\n                    <%if(false){%>\n                    <li class="comment-tab-item" data-id="3" mm="___">\n                        <span>(<%= data.statData.compGrade3Amount %>)</span>\n                    </li>\n                    <li class="comment-tab-item" data-id="2" mm="___">\n                        <span>(<%= data.statData.compGrade2Amount %>)</span>\n                    </li>\n                    <li class="comment-tab-item last" data-id="1" mm="___">\n                        <span>(<%= data.statData.compGrade1Amount %>)</span>\n                    </li>\n                    <%}%>\n                </ul>\n            </div>\n\n            <div class="comment-tag">\n                <% for (var tagIndex = 0; tagIndex < data.selectedTypeList.length; tagIndex++) { %>\n                    <span class="comment-tag-item<%= tagIndex == 0? \' active\': \'\'%>" data-id="<%= data.selectedTypeList[tagIndex].selectedType %>" mm="___"><%= data.selectedTypeList[tagIndex].selectedName %></span>\n                <% } %>\n            </div>\n\n            <div class="comment-list-outer">\n                <div class="comment-list">\n                </div>\n                <div class="comment-list-loading">\n                    <i class="comment-list-loading-bg"></i>\n                    <i class="comment-list-loading-img"></i>\n                </div>\n            </div>\n\n            <div class="pagination"></div>\n\n        <% } else { %>\n\n            <div class="comment-head">\n\n                <div class="comment-head-right empty">\n\n                    <div class="comment-empty-content">\n                        <br>\n                        \n                    </div>\n\n                    <div class="comment-post">\n                        <div class="comment-post-desc">\n                            \n                        </div>\n                        <div class="comment-post-button">\n                            <a href="https://i.tuniu.com/list" target="_blank" mm="___"></a>\n                        </div>\n                    </div>\n                </div>\n            </div>\n\n            <div class="comment-empty-list">\n                *\n            </div>\n\n        <% } %>\n    </div>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.commentContentTemplate='\n<% var platformMap = {4: \'app\', 1: \'pc\', 2: \'pc\'} %>\n<% for(var i = 0; i < data.list.length; i++) { %>\n    <% var comment = data.list[i] %>\n    <div class="comment-item">\n        <% if (comment.goodMark) { %>\n            <i class="icon comment-item-jinghua"></i>\n        <% } %>\n\n        <div class="comment-item-user">\n            <div class="comment-item-user-photo">\n                <img src="<%= helper.resizeImage(comment.userImage, 90, 90, 1) || \'http://img3.tuniucdn.com/img/20140811/usercenter_lxl/default.gif\' %>" alt="<%= comment.realName %>">\n            </div>\n            <div class="comment-item-user-name"><%= comment.realName %></div>\n            <div class="comment-item-user-product-type"><%= comment.travelTypeName %></div>\n        </div>\n\n        <% if (comment.moneyAmount || comment.couponAmount) { %>\n            <div class="comment-item-gift">\n                <div class="comment-item-gift-title"><i class="icon"></i></div>\n                <div class="comment-item-gift-list">\n                    <% if (comment.moneyAmount) { %>\n                        <div class="comment-item-gift-item">&ensp;&ensp;<strong>&yen;<%= comment.moneyAmount %></strong></div>\n                    <% } %>\n                    <% if (comment.couponAmount) { %>\n                        <div class="comment-item-gift-item"><strong>&yen;<%= comment.couponAmount %></strong></div>\n                    <% } %>\n                </div>\n            </div>\n        <% } %>\n\n        <%if(false){%>\n        <div class="comment-item-toolbar">\n            <% var isStatis = false; %>\n            <% for (var subIndex = 0; subIndex < comment.subGradeContents.length; subIndex++) { %>\n                <% if(comment.subGradeContents[subIndex].dataIvalue == 3) { isStatis = true; break; } %>\n            <% } %>\n            <% for (var subIndex = 0; subIndex < comment.subGradeContents.length; subIndex++) { %>\n                <% var sub = comment.subGradeContents[subIndex] %>\n                <div class="comment-item-toolbar-item">\n                    <% if(isStatis && subIndex === 0) { %><i class="icon"></i><% } %><%= sub.notes %><%= sub.showGradeValue %>\n                </div>\n            <% } %>\n\n        </div>\n        <% } %>\n\n        <div class="comment-item-content">\n            <%= comment.content || \'\' %>\n        </div>\n\n        <% for (var subIndex = 0; subIndex < comment.subRemark.length; subIndex++) { %>\n            <% var sub = comment.subRemark[subIndex] %>\n            <% if (sub.content) { %>\n                <div class="comment-item-detail">\n                    <div class="comment-item-detail-title"><%= sub.category %></div>\n                    <div class="comment-item-detail-content"><%= sub.content %></div>\n                </div>\n            <% } %>\n        <% } %>\n\n        <% var photoLength %>\n        <% if(comment.images && (photoLength = comment.images.length)) { %>\n            <div class="J_CommentPhoto comment-item-picture">\n                <div class="comment-item-picture-button comment-item-picture-prev" data-role="prev"><i class="icon"></i></div>\n                <div class="comment-item-picture-button comment-item-picture-next" data-role="next"><i class="icon"></i></div>\n                <div class="comment-item-picture-box">\n                    <ul data-role="list">\n                    <% for(var photoIndex = 0; photoIndex < photoLength; photoIndex++) { %>\n                        <li data-role="item" mm="___"><img layer-src="<%= comment.images[photoIndex].originalUrl %>" src="<%= comment.images[photoIndex].thumbUrl %>"></li>\n                    <% } %>\n                    </ul>\n                </div>\n            </div>\n        <% } %>\n\n\n        <div class="comment-item-foot">\n            <span class="comment-item-date"><%= comment.remarkTime %></span>\n            <%if(comment.remarkChannel){%>\n            <% if (comment.remarkChannel == 4) { %>\n                <a class="comment-item-platform" href="http://www.tuniu.com/static/mobile/" target="_blank"><i class="icon comment-item-platform-<%= platformMap[comment.remarkChannel] %>"></i><%= comment.remarkChannelName %></a>\n            <% } else { %>\n                <span class="comment-item-platform"><i class="icon comment-item-platform-<%= platformMap[comment.remarkChannel] %>"></i><%= comment.remarkChannelName %></span>\n            <% } %>\n            <% } %>\n        </div>\n\n    </div>\n<%} %>\n'},function(e,t,n){"use strict";function i(){h.off(y),h.off(_),$.ajax({dataType:"json",url:v.recommendUrl(),data:{productId:C.getState("productId"),productType:C.getState("productType"),bookCode:C.getState("bookCityCode")},success:function(e){e&&e.success&&e.data?((T=e.data.list||[]).forEach(function(e,t){e.showIndex=t+1}),function(e){var t=d.template.compile(p.detailRecommendTemplate);y.append(t({})).removeClass("section-loading"),k=_.find(".J_productList"),b=y.find(".J_productList"),e.list&&e.list.length?(a(),o(),_.removeClass("section-loading")):_.remove();g.trigger("resize"),function(){(0,u.createTaber)($("#J_localTab"),{ctx:$(".J_localContent"),onactive:function(e){var t=$(".J_proTypeName"),n=$(".J_proTypeLink");t.text(e.$tab.text()),n.attr("href",n.attr("href").replace(/\/\w+-0-0\/$/,"/"+e.$tab.data("type")+"-0-0/"))}}),y.find(".J_relativeGallery").each(function(){(0,f.createGallery)($(this))}),T.length>4&&y.find(".J_productMore").show().click(o);T.length>8&&_.find(".J_productMore").show().click(a)}()}(e.data)):c()},error:function(e,t){c()}})}function a(){T.length<=8?s(k,T):(s(k,r(w,8)),w=(w+8)%T.length)}function o(){T.length<=4?s(b,T):(s(b,r(N,4)),N=(N+4)%T.length)}function r(e,t){for(var n=T.length,i=[],a=e;a<e+t;a++)i.push(T[a%n]);return i}function s(e,t){e.html(I({data:t}))}function c(){y.remove(),_.remove(),g.trigger("resize")}Object.defineProperty(t,"__esModule",{value:!0}),t.recommendModule=void 0;var l=n(1),d=n(14),u=n(162),f=n(401),h=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t['default']=e,t}(n(108)),p=n(556),m=n(557),v=void 0,g=$(window),y=void 0,b=void 0,_=void 0,k=void 0,C=void 0,T=void 0,w=0,N=0,I=d.template.compile(m.detailProductTemplate),D={init:function(e){v=e,C=(0,l.getStore)(),y=$("#J_detailRelative"),_=$("#J_detailRecommend"),h.on(y,i),h.on(_,i)}};t.recommendModule=D},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailRecommendTemplate='\n<div class="section-box relative">\n    <div class="section-box-head">\n        <h2></h2>\n    </div>\n    <div class="section-box-body">\n        <div class="section-box-title">\n            <h3></h3>\n            <a class="J_productMore relative-pro-refresh" href="javascript:;" mm="___"> <i></i></a>\n        </div>\n        <div class="J_productList section-box-content relative-pro-list">\n        </div>\n    </div>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.detailProductTemplate='\n<ul class="product-list">\n    <% for (var index = 0; index < data.length; index++) { %>\n        <% var product = data[index] %>\n        <li class="product-item">\n            <a class="product-link" href="/package/<%= product.productId %>" target="_blank" m="___<%= product.showIndex %>_<%= product.productId %>">\n                <div class="product-picture">\n                    <img src="<%= product.largeImage %>" alt="<%= product.name %>" />\n                    <div class="product-name">\n                        <p><%= product.name %></p>\n                    </div>\n                </div>\n                <div class="product-info">\n                    <div class="product-price">\n                        <span><b><%= product.lowestPrice %></b></span> \n                    </div>\n                </div>\n            </a>\n        </li>\n    <% }%>\n</ul>\n'},function(e,t,n){"use strict";function i(e){return"expand"==e?$('<a class="button-more" href="javascript:;"><i class="icon"></i></a>'):$('<a class="button-less" href="javascript:;"><i class="icon"></i></a>')}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=[],r=$(window),s=0,c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.originHeight=0,this.expandHeight=0,this.buttonInited=!1,this.inited=!1,this.expanded=!1,this.$element=t,this.id="AUTOFOLD_"+ ++s,this.$inner=t.find("[data-role=fold-box-inner]"),this.$more=null,this.$less=null,this.update()}return a(e,[{key:"init",value:function(){this.originHeight=this.$inner.height(),this.inited=!0}},{key:"initButton",value:function(){this.$more=i("expand"),this.$less=i("fold"),this.bindButton(),this.buttonInited=!0}},{key:"bindButton",value:function(){this.$more.click(this.expand.bind(this)),this.$less.click(this.fold.bind(this))}},{key:"showButton",value:function(){this.buttonInited||this.initButton(),this.$more.appendTo(this.$element),this.$less.appendTo(this.$element),this.updateButton()}},{key:"hideButton",value:function(){this.buttonInited&&(this.$more.remove(),this.$less.remove())}},{key:"updateButton",value:function(){this.buttonInited&&(this.expanded?(this.$more.hide(),this.$less.show()):(this.$more.show(),this.$less.hide()))}},{key:"update",value:function(){this.$element.is(":visible")&&(this.inited||this.init(),this.expandHeight=this.$inner[0].scrollHeight,this.$inner.css("max-height","none"),this.expandHeight>this.originHeight?(this.showButton(),this.updateContent(),this.$element.addClass("fold")):(this.hideButton(),this.$inner.height(this.expandHeight),this.$element.removeClass("fold")),r.trigger("resize","autoFold"))}},{key:"updateContent",value:function(){this.expanded?this.$inner.height(this.expandHeight):this.$inner.height(this.originHeight)}},{key:"expand",value:function(){this.expanded=!0,this.updateContent(),this.updateButton(),$(window).resize()}},{key:"fold",value:function(){this.expanded=!1,this.updateContent(),this.updateButton(),$(window).resize()}}]),e}();r.on("resize",function(e,t){"autoFold"!==t&&o.forEach(function(e){return e.update()})}),t.createAutoFold=function(e,t){var n=new c(e,t);return o.push(n),n}},function(e,t){}]);